<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Exploring modeling with data and differential equations using R</h1>
<p class="author"><em>John M. Zobitz</em></p>
<p class="date"><em>2021-02-16</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#welcome"><span class="toc-section-number">1</span> Welcome</a></li>
<li><a href="#creating-this-from-bookdown-to-github"><span class="toc-section-number">2</span> Creating this from Bookdown to Github</a></li>
<li><a href="#part-models-with-differential-equations">(PART) Models with Differential Equations</a></li>
<li><a href="#models-of-rates-with-data"><span class="toc-section-number">3</span> Models of rates with data</a><ul>
<li><a href="#what-is-the-book-about"><span class="toc-section-number">3.1</span> What is the book about?</a></li>
<li><a href="#modeling-in-context-the-spread-of-a-disease"><span class="toc-section-number">3.2</span> Modeling in context: the spread of a disease</a></li>
<li><a href="#the-qualitative-nature-of-solution-curves"><span class="toc-section-number">3.3</span> The qualitative nature of solution curves</a></li>
<li><a href="#simulating-a-differential-equation"><span class="toc-section-number">3.4</span> Simulating a differential equation</a></li>
<li><a href="#which-model-is-best"><span class="toc-section-number">3.5</span> Which model is best?</a></li>
<li><a href="#exercises"><span class="toc-section-number">3.6</span> Exercises</a></li>
</ul></li>
<li><a href="#modeling-with-rates-of-change"><span class="toc-section-number">4</span> Modeling with rates of change</a><ul>
<li><a href="#lynx-and-hares"><span class="toc-section-number">4.1</span> Lynx and Hares</a></li>
<li><a href="#the-law-of-mass-action"><span class="toc-section-number">4.2</span> The Law of Mass Action</a></li>
<li><a href="#invasive-species"><span class="toc-section-number">4.3</span> Invasive species</a></li>
<li><a href="#other-types-of-functional-responses"><span class="toc-section-number">4.4</span> Other types of functional responses</a></li>
<li><a href="#exercises-1"><span class="toc-section-number">4.5</span> Exercises</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="welcome" class="section level1">
<h1><span class="header-section-number">1</span> Welcome</h1>
</div>
<div id="creating-this-from-bookdown-to-github" class="section level1">
<h1><span class="header-section-number">2</span> Creating this from Bookdown to Github</h1>
<p>I stumbled on how to do this by going to this <a href="https://jules32.github.io/bookdown-tutorial/">website</a> and built this out from here. I am glad that I will be able to work on this.</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="part-models-with-differential-equations" class="section level1 unnumbered">
<h1>(PART) Models with Differential Equations</h1>
</div>
<div id="models-of-rates-with-data" class="section level1">
<h1><span class="header-section-number">3</span> Models of rates with data</h1>
<div id="what-is-the-book-about" class="section level2">
<h2><span class="header-section-number">3.1</span> What is the book about?</h2>
<p>The focus of this textbook is understanding <em>rates of change</em> and how you can apply them to model real-world phenomena. In addition this textbook focuses on <em>using</em> equations with data, building both your competence and confidence to construct a mathematical model from data and a context.</p>
<p>I can imagine that your first sustained encounter of rates of change was in your calculus course, perhaps answering the following types of questions:</p>
<ul>
<li>If <span class="math inline">\(y = xe^{-x}\)</span>, determine the derivative function <span class="math inline">\(f&#39;(x)\)</span>.</li>
<li>Where is the graph of <span class="math inline">\(\sin(x)\)</span> increasing at an increasing rate?</li>
<li>If you release a ball from the top of a skyscraper 500 meters above the ground, what is its speed when it impacts the ground?</li>
</ul>
<p>Some of these mathematical questions derive from models from physical phenomena, such as the ball falling off a skyscraper which assumes that acceleration of the ball is constant. This assumption is typically a starting point to build a mathematical model. Using acceleration, the velocity (or the antiderivative of acceleration) can be found, from which the position function can be calculated through antidifferentiation.</p>
<p>However many times we observe data and <em>then</em> construct a mathematical model to corroborate our observations. Some of the these models come from well-understood physical phenomena (such as the case of the falling ball).</p>
</div>
<div id="modeling-in-context-the-spread-of-a-disease" class="section level2">
<h2><span class="header-section-number">3.2</span> Modeling in context: the spread of a disease</h2>
<p>To see what the first steps would be, consider the data in Figure @ref(fig:sierra-leone), which come from an <a href="https://www.cdc.gov/vhf/ebola/history/2014-2016-outbreak/index.html">Ebola outbreak</a> in Sierra Leone in 2014.</p>
<div class="figure">
<img src="ModelingWithR_files/figure-html/sierra-leone-1.png" alt="An Ebola outbreak in Sierra Leone" width="384" />
<p class="caption">
(#fig:sierra-leone)An Ebola outbreak in Sierra Leone
</p>
</div>
<p>These data represent the deaths due to Ebola in Sierra Leone. Constructing a model from disease dynamics is part of the field of <a href="https://en.wikipedia.org/wiki/Mathematical_modelling_of_infectious_disease">mathematical epidemiology</a>. How we construct a mathematical model of the spread of this outbreak largely depends on the assumptions underlying the dynamics of the disease, such as considering the rate of spread of Ebola. This model also depends on the spatial scale studied as well - how a model is constructed depends if we wish to examine the spread of the disease in an individual immune response, or understand general principles for the spread through a population.</p>
<p>Basic questions that one can ask is if the rate of deaths due to Ebola proportional to:</p>
<ul>
<li>The number of people infected?</li>
<li>The number of people not infected?</li>
<li>The number of infected people coming into contact with those not infected?</li>
</ul>
<p>Let’s see what each of these mathematical models would look like if we wrote down an equation. Since we are discussing <em>rates</em> of infection, this means we will need a <em>rate of change</em> or derivative. Let’s use the letter <span class="math inline">\(I\)</span> to represent the number of people that are infected.</p>
<div id="model-1-infection-rate-proportional-to-number-infected." class="section level3">
<h3><span class="header-section-number">3.2.1</span> Model 1: Infection rate proportional to number infected.</h3>
<p>In the first case (the rate of infection proportional to the number of people infected), to translate that statement into an equation would be the following:</p>
<p><span class="math display">\[\begin{equation}
\frac{dI}{dt} = kI
\end{equation}\]</span></p>
<p>where <span class="math inline">\(k\)</span> can be thought of as a proportionality constant, with units of time<span class="math inline">\(^{-1}\)</span> for consistency. This is an example of a <em>differential equation</em>, which is just a mathematical equation with rates of change.</p>
<p>Differential equations may look different because what we are solving for is the function <span class="math inline">\(I(t)\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Later on we will examine how to ``solve’’ a differential equation (which means we determine the family of functions consistent with our rate equation).</p>
<p>Notice the proportionality constant <span class="math inline">\(k\)</span> - we call this a <em>parameter</em>. We can always try to solve an equation without specifying the parameter - and then if we wanted to plot a solution the parameter would also be specified. In some situations we may not be as concerned with the particular <em>value</em> of the parameter but rather its influence on the long-term behavior of the system (this is one aspect of <a href="https://en.wikipedia.org/wiki/Bifurcation_theory">bifurcation theory</a>). Otherwise we can use the collected data shown above with the given model to determine the value for <span class="math inline">\(k\)</span>. This combination of a mathematical model with data is called <em>data assimilation</em> or <em>model-data fusion</em>. How exciting!</p>
<p>Before we think about possible solutions let’s try to reason out if the first model would be plausible. This model states that the rate of change (the amount of increase) gets larger the more people that are sick. That does seem reasonable as a model, but perhaps unreasonable in real life. In the case of Ebola or any other infection disease, stringent public health measures would be put in place before large numbers of people die. We would expect that the rate of infection would decrease and the number of deaths to slow. So perhaps the second model might be a little more plausible. At some point the number of people who are <em>not</em> sick will reach zero, making the rate of infection be zero (or no increase).</p>
</div>
<div id="model-2-infection-rate-proportional-to-number-not-infected." class="section level3">
<h3><span class="header-section-number">3.2.2</span> Model 2: Infection rate proportional to number NOT infected.</h3>
<p>In this description notice how we are talking about people who are sick (which we have denoted as <span class="math inline">\(I\)</span>) and people who are <em>not</em> sick. This looks like we might need to introduce another variable for the ``not sick’’ people, which we will call <span class="math inline">\(S\)</span>, or susceptible. So the differential equation we would write down would be:</p>
<p><span class="math display">\[\begin{equation} 
\frac{dI}{dt} = kS  (\#eq:01notinfected)
\end{equation}\]</span></p>
<p>We are still using the parameter <span class="math inline">\(k\)</span> as with the previous model. Also note we introduced the second variable <span class="math inline">\(S\)</span> is in Equation @ref(eq:01notinfected). Because we have introduced another variable <span class="math inline">\(S\)</span> we should also include a differential equation for how <span class="math inline">\(S\)</span> changes as well. One way that we can do this is by considering our entire population as consisting of two groups of people: <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span>. Infection brings someone over from <span class="math inline">\(S\)</span> to <span class="math inline">\(I\)</span>, which we have in this diagram:</p>
<p><img src="ModelingWithR_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>There are three reasons why I like to use diagrams like these: (1) they help organize my thinking about a mathematical model (2) any assumed parameters are listed, and (3) they help me to see that rates can be conserved. In other words, if I enter into the box for <span class="math inline">\(I\)</span>, then someone is leaving <span class="math inline">\(S\)</span>. In other words, <span class="math inline">\(\displaystyle \frac{dS}{dt} = -kS\)</span>. So the two equations together can be represented as:</p>
<p><span class="math display">\[\begin{align*}
\frac{dS}{dt} &amp;= -kS \\
\frac{dI}{dt} &amp;= kS
\end{align*}\]</span></p>
<p>This differential equation is what we would call a <em>coupled differential equation</em>. In order to ``solve’’ the system we need to determine functions for <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span>. This coupled set of equations looks a little clunky, but we do notice something cool. Algebriacally we have:</p>
<p><span class="math display">\[\begin{equation} 
\frac{dS}{dt} +  \frac{dI}{dt} = \frac{d(S+I)}{dt} = 0
\end{equation}\]</span></p>
<p>Recall from calculus that if a rate of change equals zero then the function is constant. In this case, the variable <span class="math inline">\(S+I\)</span> is constant, or we can also call <span class="math inline">\(S+I=N\)</span>, the number of people in the population. This means that <span class="math inline">\(S=N-I\)</span>, so we can re-write our differential equation in one equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{dI}{dt} = k(N-I)
\end{equation}\]</span></p>
<p>This second model does have some limiting behavior to this model as well. As the number of infected people reaches <span class="math inline">\(N\)</span> (the total population size), the values of <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> approaches zero, meaning <span class="math inline">\(I\)</span> doesn’t change. There is one caveat to this - if there are no infected people around (<span class="math inline">\(I=0\)</span>) <em>the disease can still be transmitted</em>, which might make not good biological sense.</p>
</div>
<div id="model-3-infection-rate-proportional-to-infected-meeting-not-infected." class="section level3">
<h3><span class="header-section-number">3.2.3</span> Model 3: Infection rate proportional to infected meeting not infected.</h3>
<p>The third model rectifies some of the shortcomings of the second model (which rectified the shortcomings of the first model). This model states that the rate of infection is due to those who are sick, actually infecting those who are not sick. This would sort of scenario would also make some sense, as it focused on that <em>transmission</em> of the disease are between susceptibles and infected people. So if nobody is sick (<span class="math inline">\(I=0\)</span>) then the disease is not spread. Likewise if there are no susceptibles (<span class="math inline">\(S=0\)</span>), the disease is not spread as well.</p>
<p>In this case the diagram outlining this approach looks something like this:</p>
<p><img src="ModelingWithR_files/figure-html/logistic-1.png" width="672" /></p>
<p>The differential equations that describe this scenario are the following:</p>
<p><span class="math display">\[\begin{align*}
\frac{dS}{dt} &amp;= -kSI \\
\frac{dI}{dt} &amp;= kSI
\end{align*}\]</span></p>
<p>Just like before for Model 2 we can combine the two equations to yield a single differential equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{dI}{dt} = k\cdot I \cdot (N-I)
\end{equation}\]</span>
Look’s pretty similar to model 2, doesn’t it? In this case notice the variable <span class="math inline">\(I\)</span> outside the expression. Notice this seems to be appropriate - if <span class="math inline">\(I=0\)</span>, then there is no increase in infection. If <span class="math inline">\(I=N\)</span> (the total population size) then there is no increase in the infection.</p>
</div>
</div>
<div id="the-qualitative-nature-of-solution-curves" class="section level2">
<h2><span class="header-section-number">3.3</span> The qualitative nature of solution curves</h2>
<p>So far we have primarily been focused on the qualitative understanding of the different models. One way we can look at how these different models work together is by plotting <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> versus <span class="math inline">\(I\)</span>. I know we have the parameters <span class="math inline">\(k\)</span> and <span class="math inline">\(N\)</span> to specify, but let’s just set them to be <span class="math inline">\(k=1\)</span> and <span class="math inline">\(N=10\)</span> respectively. Plots of these functions are shown in Figure @ref(fig:threeRates).</p>
<div class="figure">
<img src="ModelingWithR_files/figure-html/threeRates-1.png" alt="Comparing rates of change for three models" width="384" />
<p class="caption">
(#fig:threeRates)Comparing rates of change for three models
</p>
</div>
<p>There is a lot that we can tell from this figure. Notice how the sign of <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> is always positive for Model 1, indicating that the solution (<span class="math inline">\(I\)</span>) is always increasing. For Models 2 and 3, <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> equals zero when <span class="math inline">\(I=10\)</span>, which also is the value for <span class="math inline">\(N\)</span> After that case, <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> turns negative, meaning that <span class="math inline">\(I\)</span> is decreasing.</p>
<p>In summary, we can tell a lot about the <em>qualitative behavior</em> of a solution to a differential equation even without the solution.</p>
</div>
<div id="simulating-a-differential-equation" class="section level2">
<h2><span class="header-section-number">3.4</span> Simulating a differential equation</h2>
<p>Let’s talk solutions. One thing to note is that usually a differential equation also has a starting, or an initial value that actualizes the solution. When we state a differential equation with a starting value we have an <strong>initial value problem</strong>. For our case here we will assume that <span class="math inline">\(I(0)=I_{0}\)</span>, where this is also another parameter at our disposal.</p>
<p>With that assumption, we can (and will solve later!) the following solutions for these models:</p>
<p><span class="math display">\[\begin{align*}
\mbox{ Model 1 (Exponential): } &amp; I(t) = I_{0}e^{kt} \\
\mbox{Model 2 (Saturating): } &amp; I(t) = N-(N-I_{0})e^{-kt} \\
\mbox{Model 3 (Logistic): } &amp; I(t) = \frac{N \cdot I_{0} }{I_{0}+(N-I_{0})e^{-kt}}
\end{align*}\]</span></p>
<pre><code>## Warning: Removed 63 row(s) containing missing values (geom_path).</code></pre>
<div class="figure">
<img src="ModelingWithR_files/figure-html/threeSoln-1.png" alt="Three models compared" width="384" />
<p class="caption">
(#fig:threeSoln)Three models compared
</p>
</div>
<p>In Figure @ref(fig:threeSoln), I plot these solutions over the course of several days, using <span class="math inline">\(k=0.03\)</span> and <span class="math inline">\(N=4000\)</span> and <span class="math inline">\(I_{0}=5\)</span>. Notice how Model 1 increases quickly - it actually grows without bound off the chart! Model 2 and Model 3 have saturating behavior, but it looks like Model 3 might be the one that actually captures the trend of the data. Models 2 and 3 are more commonly known as the <strong>saturating</strong> and <strong>logistic</strong> models respectively.</p>
</div>
<div id="which-model-is-best" class="section level2">
<h2><span class="header-section-number">3.5</span> Which model is best?</h2>
<p>All three of these scenarios describe different modeling scenarios. While we haven’t solved these differential equations, we do have some intuitive sense of what could occur. With the saturating and logistic models (Models 2 and 3) we have some limiting behavior the possibility that the the rate of infecion slows. There are several possible models that on the surface seem plausible, but which one is the <em>best</em> one? We will also address that question later on in this textbook when we discuss <em>model selection</em>.</p>
<p>Model selection is one key part of the modeling hypothesis - where we investigate the implications of a particular model analyzed. If we don’t do this, we don’t have an opportunity to test out what is plausible and what is believeable in our models.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">3.6</span> Exercises</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-4" class="exercise"><strong>(#exr:unnamed-chunk-4) </strong></span>Solutions to an outbreak model of the flu are the following:
<span class="math display">\[\begin{align*}
\mbox{Saturating model: } &amp; I(t) = 3000-(2990)e^{-.1t} \\
\mbox{Logistic model: } &amp;  I(t) = \frac{30000 }{10+(2990)e^{-.15t}},
\end{align*}\]</span></p>
where <span class="math inline">\(t\)</span> is in days. Make a plot of both of these models for <span class="math inline">\(0 \leq t \leq 100\)</span>. How would you describe the growth of the outbreak as <span class="math inline">\(t\)</span> increases? How many people will be infected overall? Finally,evaluate <span class="math inline">\(\lim_{t \rightarrow \infty} I(t)\)</span>. How do these results compare to values found on your graph?
</div>

<p> </p>

<div class="exercise">
<span id="exr:unnamed-chunk-5" class="exercise"><strong>(#exr:unnamed-chunk-5) </strong></span>The general solution for the saturating and the logistic models are:
<span class="math display">\[\begin{align*}
\mbox{Saturating model: } &amp; I(t) = N-(N-I_{0})e^{-kt} \\
\mbox{Logistic model: } &amp;  I(t) = \frac{N \cdot I_{0} }{I_{0}+(N-I_{0})e^{-kt}},
\end{align*}\]</span>
where <span class="math inline">\(I_{0}\)</span> is the initial number of people infected and <span class="math inline">\(N\)</span> is the overall population size. Using the functions from the previous exercise, for both models, what are <span class="math inline">\(N\)</span> and <span class="math inline">\(I_{0}\)</span>?
</div>

<p> </p>

<div class="exercise">
<span id="exr:unnamed-chunk-6" class="exercise"><strong>(#exr:unnamed-chunk-6) </strong></span>The general solution for the saturating and the logistic models are:
<span class="math display">\[\begin{align*}
\mbox{Saturating model: } &amp; I(t) = N-(N-I_{0})e^{-kt} \\
\mbox{Logistic model: } &amp;  I(t) = \frac{N \cdot I_{0} }{I_{0}+(N-I_{0})e^{-kt}},
\end{align*}\]</span>
where <span class="math inline">\(I_{0}\)</span> is the initial number of people infected and <span class="math inline">\(N\)</span> is the overall population size. For both models carefully evaluate the limits to show <span class="math inline">\(\lim_{t \rightarrow \infty} I(t)=N\)</span>. How do these compare to the steady-state values you found for Models 2 and 3 of the outbreak data?
</div>

<p> </p>
<div class="figure">
<img src="ModelingWithR_files/figure-html/liberia-1.png" alt="An Ebola outbreak in Liberia in 2014" width="384" />
<p class="caption">
(#fig:liberia)An Ebola outbreak in Liberia in 2014
</p>
</div>
 

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>(#exr:unnamed-chunk-7) </strong></span>Figure @ref(fig:liberia) shows the Ebola outbreak for the country of Liberia in 2014.
If we were to apply the logistic model based on this graphic what would be your estimate for <span class="math inline">\(N\)</span>?
</div>

 
<!-- Sethi model for advertising -->

<div class="exercise">
<p><span id="exr:unnamed-chunk-8" class="exercise"><strong>(#exr:unnamed-chunk-8) </strong></span>A model that describes the growth of sales of a product in response to advertising is the following:
<span class="math display">\[\frac{dS}{dt} = .55\sqrt{1-S}-S, \]</span>
where <span class="math inline">\(S\)</span> is the product’s share of the market (scaled between 0 and 1). Make a plot of the function <span class="math inline">\(f(S)=.55\sqrt{1-S}-S\)</span>. for <span class="math inline">\(0 \leq S \leq 1\)</span>. Interpret your plot to predict when the market share will be increasing and decreasing. At what value is <span class="math inline">\(\frac{dS}{dt}=0\)</span>? (This is called the <strong>steady-state</strong> value.).</p>
<p>A second campaign is has the following differential equation:
<span class="math display">\[\frac{dS}{dt} = .2\sqrt{1-S}-S \]</span></p>
What is the steady-state value and how does it compare to the previous one?
</div>

<p> </p>

<div class="exercise">
<span id="exr:unnamed-chunk-9" class="exercise"><strong>(#exr:unnamed-chunk-9) </strong></span>A more general form of the advertising model is the following:
<span class="math display">\[\frac{dS}{dt} = r\sqrt{1-S}-S, \]</span>
where <span class="math inline">\(S\)</span> is the product’s share of the market (scaled between 0 and 1). The parameter <span class="math inline">\(r\)</span> is related to the effectiveness of the advertising (between 0 and 1). Solve this equation for the steady state value (where <span class="math inline">\(\frac{dS}{dt}=0\)</span>). Make a plot of the steady state value as a function of <span class="math inline">\(r\)</span>, where <span class="math inline">\(0 \leq r \leq 1\)</span>. What can you conclude about the steady state value as the effectiveness of the advertising increases?
</div>

<p> </p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-10" class="exercise"><strong>(#exr:unnamed-chunk-10) </strong></span>A common saying is ``You are what you eat.’’ This saying is mostly true and can be related in a mathematical model! An equation that relates a consumer’s nutrient content (denoted as <span class="math inline">\(y\)</span>) to the nutrient content of food (denoted as <span class="math inline">\(x\)</span>) is given by:
<span class="math display">\[\begin{equation}
 y = c x^{1/\theta},
\end{equation}\]</span>
where <span class="math inline">\(\theta \geq 1\)</span> and <span class="math inline">\(c\)</span> are both constants is a constant. Units on <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are expressed as a proportion of a given nutrient (such as nitrogen or carbon).</p>
<p>Let’s start with an example: <span class="math inline">\(y=x\)</span>. In this case the point <span class="math inline">\((0.05,0.05)\)</span> would say that if an animal ate food that was 5% nitrogen, their body composition would be 5% as well.</p>
Let’s just assume that <span class="math inline">\(c=1\)</span>. How does the nutrient content of the consumer compare to the food when <span class="math inline">\(\theta=2\)</span>? <span class="math inline">\(\theta = 5\)</span>? <span class="math inline">\(\theta \rightarrow \infty\)</span>? Draw some sample curves to help illustrate your findings.
</div>

<p> </p>

<div class="exercise">
<span id="exr:unnamed-chunk-11" class="exercise"><strong>(#exr:unnamed-chunk-11) </strong></span>A model for the outbreak of a cold virus assumes that the rate people get infected is proportional to infected people contacting susceptible people, as in the logistic model 3. However people who are infected can also recover and become susceptible again with rate <span class="math inline">\(\alpha\)</span>. Construct a diagram similar Model 3 for this scenario and also write down the system of differential equations.
</div>

<p> </p>

<div class="exercise">
<span id="exr:unnamed-chunk-12" class="exercise"><strong>(#exr:unnamed-chunk-12) </strong></span>A model for the outbreak of the flu assumes that the rate people get infected is proportional to infected people contacting susceptible people, as in Model 3. However people also account for recovering from the flu, denoted with the variable <span class="math inline">\(R\)</span>. Assume that the rate of recovery is proportional to the number of infected people with parameter <span class="math inline">\(\beta\)</span>. Construct a diagram like Model 3 for this scenario, and also write down the system of differential equations.
</div>

 
<!-- Van den Berg page 19 -->

<div class="exercise">
<p><span id="exr:unnamed-chunk-13" class="exercise"><strong>(#exr:unnamed-chunk-13) </strong></span>Organisms that live in a saline environment biochemically maintain the amount of salt in their blood stream. An equation that represents the level of <span class="math inline">\(S\)</span> in the blood is the following:</p>
<p><span class="math display">\[\frac{dS}{dt} = I + p \cdot (W - S), \]</span></p>
where the parameter <span class="math inline">\(I\)</span> represents the active uptake of salt, <span class="math inline">\(p\)</span> is the permeability of the skin, and <span class="math inline">\(W\)</span> is the salinity in the water. What is that value of <span class="math inline">\(S\)</span> at <em>steady state</em>, or when <span class="math inline">\(\displaystyle \frac{dS}{dt} = 0\)</span>?
</div>

 

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>(#exr:unnamed-chunk-14) </strong></span>Use your steady state solution from the last exercise to determine what parameters (<span class="math inline">\(I\)</span>, <span class="math inline">\(p\)</span>, or <span class="math inline">\(W\)</span>) cause the steady state value <span class="math inline">\(S\)</span> to increase?
</div>

<p> </p>
<!-- From LW -->

<div class="exercise">
<span id="exr:unnamed-chunk-15" class="exercise"><strong>(#exr:unnamed-chunk-15) </strong></span>The immigration rate of bird species (species per time) from a mainland to an offshore island is <span class="math inline">\(I_{m} \cdot (1-S/P)\)</span>, where <span class="math inline">\(I_{m}\)</span> is the maximum immigration rate, <span class="math inline">\(P\)</span> is the size of the source pool of species on the mainland, and <span class="math inline">\(S\)</span> is the number of species already occupying the island. Further, the extinction rate is <span class="math inline">\(E \cdot S / P\)</span>, where <span class="math inline">\(E\)</span> is the maximum extinction rate. The growth rate of the number of species on the island is the immigration rate minus the extinction rate.
</div>

<p> </p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-16" class="exercise"><strong>(#exr:unnamed-chunk-16) </strong></span>This problem relates to animal size and volume. Assume that an animal assimilates nutrients at a rate <span class="math inline">\(R\)</span> proportional to its surface area. Also assume that it uses nutrients at a rate proportional to its volume. You may assume that the size of the animal is implicitly a function of the nutrient intake and usage. Determine the size of the animal if its intake and use rates were in balance (meaning <span class="math inline">\(R\)</span> is set to zero), assuming the animal is the following shapes:</p>
For both of these problems your goal is to determine a numeric value of <span class="math inline">\(r\)</span> and <span class="math inline">\(l\)</span>.
</div>

<!--chapter:end:01-intro.Rmd-->
</div>
</div>
<div id="modeling-with-rates-of-change" class="section level1">
<h1><span class="header-section-number">4</span> Modeling with rates of change</h1>
<p>So far we have looked at some examples for how we can apply rates of change to develop a mathematical model, and also learned a little bit about the ways we can apply computational software such as <code>R</code>.</p>
<p>In this section we are going to look some additional examples of how we can translate equations with rates of change to understand phenomena.</p>
<div id="lynx-and-hares" class="section level2">
<h2><span class="header-section-number">4.1</span> Lynx and Hares</h2>
<p>Our first example is a <em>system of differential equations</em>. The context is between the snowshoe hare and the Canadian lynx. Here is a picture of them below from <a href="https://www.cbc.ca/news/canada/north/canseq150-genome-sequencing-lynx-hare-1.4676308">link</a></p>
<p><img src="figures/03-systems/lynx-hare.png" width="5in" /></p>
<p>This has been a well studied system (REFERENCES), and a timeseries of their population is shown with this figure from REFERENCE.</p>
<p><img src="figures/03-systems/lynx-hare-timeseries.png" width="5in" /></p>
<p>Notice how in this figure both populations seem to fluctuate periodically. One plausible reason is that the lynx prey on the snowshoe hares, which causes the population to initially decline. Once the snowshoe hare population declines, then there is less food for the lynx to survive, so their population declines. The decline in the lynx population causes the hare population to increase, and so on it goes …</p>
<p>In summary it is safe to say that the two populations are <em>coupled</em> to one another. But in order to understand how they are coupled together, first let’s consider the two populations <em>separately</em>.</p>
<p>The hares grow much more quickly than then lynx - in fact some hares have been known to reproduce several times a year, so a reasonable assumption (assuming the hare population is much larger) is that rate of change of the hares is proportional to the hare population. Based on this assumption we have the following differential equation, with <span class="math inline">\(H\)</span> is the population of the hares:</p>
<p><span class="math display">\[\begin{equation}
\frac{dH}{dt} = r H
\end{equation}\]</span></p>
<p>In this case we know that the growth rate <span class="math inline">\(r\)</span> is positive, so then the rate of change (<span class="math inline">\(H&#39;\)</span>) will be positive as well, and <span class="math inline">\(H\)</span> will be increasing. Typical values given for <span class="math inline">\(r\)</span> in REFERENCE are between 1.8 - 2.0 year<span class="math inline">\(^{-1}\)</span>. One way to think about <span class="math inline">\(b\)</span> is - to take its inverse (about 0.5 - 0.55 years), which represents the amount of time that passes before the hare population decreases by one (pretty short!)</p>
<p>Let’s consider the lynx now. A approach is to assume their population declines exponentially, or changes at the rate proportional to the current population. Let’s consider <span class="math inline">\(L\)</span> to be the lynx population, so we have the following equation for them:</p>
<p><span class="math display">\[\begin{equation}
\frac{dL}{dt} = -dL
\end{equation}\]</span></p>
<p>As you can see in this case, the death rate <span class="math inline">\(d\)</span> is positive, leading to a negative rate of change for the Lynx population (and a decreasing value for <span class="math inline">\(L\)</span>). Typical values of <span class="math inline">\(d\)</span> are 0.9 - 2.4 year<span class="math inline">\(^{-1}\)</span>. One way to think about <span class="math inline">\(d\)</span> is - like <span class="math inline">\(b\)</span> - to take its inverse (about 0.4 - 1.1 years), which represents the amount of time that passes before the lynx population decreases by one.</p>
<p>The next part to consider is how they interact. Since the hares are prey for the lynx, when the lynx hunt, the hare population. We can represent this with the following adjustment to our hare equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{dH}{dt} = r H - b HL
\end{equation}\]</span></p>
<p>So the parameter <span class="math inline">\(b\)</span> represents the hunting rate. Notice how we have the term <span class="math inline">\(HL\)</span> for this interaction. This term injects a sense of realism: if the lynx are not present (<span class="math inline">\(L=0\)</span>), then the hare population can’t decrease due to hunting. We say that the <em>interaction</em> between the hares and the lynx with multiplication. Typical values for <span class="math inline">\(b\)</span> are 480 - 870 hares <span class="math inline">\(\cdot\)</span> lynx<span class="math inline">\(^{-1}\)</span> year<span class="math inline">\(^{-1}\)</span>. It is okay if that unit seems a little odd to you - it should be! Here is one way to think about it. The quantity <span class="math inline">\(\displaystyle \frac{dH}{dt}\)</span> represents the <em>rate of change</em> of the hares, so it should have units of hares per year. Since the term <span class="math inline">\(bHL\)</span> has both lynx and hare, the units for <span class="math inline">\(b\)</span> need to account for this.</p>
<p>How does hunting affect the lynx population? One possibility is that it increases the lynx population:</p>
<p><span class="math display">\[\begin{equation}
\frac{dL}{dt} =bHL -dL
\end{equation}\]</span></p>
<p>Notice the symmetry between the rate of change for the hares and the lynx equations. In many cases this makes sense - if you subtract a rate from one population, then that rate should be added to the receiving population. You could also argue that there is some efficiency loss in converting the hares to lynx - not all of the hare is converted int the lynx biomass. In this situation we sometimes like to adjust the lynx equation with another parameter <span class="math inline">\(e\)</span>, representing the efficiency that hares are converted into lynx:</p>
<p><span class="math display">\[\begin{equation}
\frac{dL}{dt} =e\cdot bHL -dL
\end{equation}\]</span></p>
<p>(sometimes people just make a new parameter <span class="math inline">\(c=e \cdot b\)</span>, but for now we will just leave it as is). So now we have the following coupled system of differential equations:</p>
<p><span class="math display">\[\begin{align}
\frac{dH}{dt} &amp;= r H - b HL \\
\frac{dL}{dt} &amp;=ebHL -dL
\end{align}\]</span></p>
<p>The schematic diagram representing these interactions is the following:</p>
<p><img src="ModelingWithR_files/figure-html/lynxhare-1.png" width="672" /></p>
<p>This differential equation is a classical model in mathematical biology and differential equations - it is called the <em>predator prey</em> model, also known as the <a href="https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations">Lotka-Volterra equations</a>. There is a lot of interesting mathematics from this system of equations that we will study later in this textbook. The next steps of the analysis that we will be working on is determining solutions to these differential equations numerically or directly.</p>
<p>Stenseth paper - this is a lot more complicated than we think!</p>
</div>
<div id="the-law-of-mass-action" class="section level2">
<h2><span class="header-section-number">4.2</span> The Law of Mass Action</h2>
<p>Notice in the previous section that the interaction between the lynx and the hare was of the form <em>bHL</em> - meaning you needed both positive values of <em>H</em> and <em>L</em> for the interaction to continue. This law states that the rate of a change is directly proportional to the <em>product</em> of the populations.</p>
<p>This assumption of the law of mass action is also commonly used in chemical reactions - especially in modeling enzyme dynamics. For example let’s say you have a substrate <em>A</em> that reactions with enzyme <em>B</em> to form a product <em>S</em>. Perhaps you might have seen this represented as a reaction equation:</p>
<p><span class="math display">\[\begin{equation}
A+B \rightarrow S
\end{equation}\]</span></p>
<p>How we would write the product of formation, or <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> is the following:</p>
<p><span class="math display">\[\begin{equation}
\frac{dS}{dt}= kAB,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the proportionality constant or the rate constant associated with the reaction. If we wanted to represent this as a schematic we would have the following diagram:</p>
<p><img src="ModelingWithR_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>We could also consider if there was a constant decay of the substrate, which we might revise our diagram to the following:</p>
<p><img src="ModelingWithR_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="invasive-species" class="section level2">
<h2><span class="header-section-number">4.3</span> Invasive species</h2>
<p>Let’s look at another example where we will determine a differential equation model from a context:</p>
<blockquote>
<p>An invasive species enters new territory at a rate proportional to the difference between the current number of native individuals and the number of invasive individuals established in the territory. Assume that the number of native individuals is constant.
<!-- LW pg 5 --></p>
</blockquote>
<p>For this problem we will start by naming our variables. Let <span class="math inline">\(I\)</span> represent number of invasive individuals and <span class="math inline">\(N\)</span> the number of native individuals. We will break this down accordingly:</p>
<ul>
<li><em>An invasive species enters new territory at a rate proportional</em> means <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span>.</li>
<li><em>proportional to the difference between the current number of native individuals and the number of invasive individuals established in the territory</em> means <span class="math inline">\(\displaystyle k \cdot (N-I)\)</span>, where <span class="math inline">\(k\)</span> is the proportionality constant. Including this parameter helps to avoid assuming we have a 1:1 correspondence between the growth rate of the invasive individuals and the population difference.</li>
<li><em>Assume that the number of native individuals is constant.</em> This means that <span class="math inline">\(N=C\)</span>, or equivalently <span class="math inline">\(\displaystyle \frac{dN}{dt} = 0\)</span> (a constant function has zero rate of change).</li>
</ul>
<p>So in summary we have the following model:
<span class="math display">\[\begin{equation}
\frac{dI}{dt} = k(N-I)
\end{equation}\]</span></p>
<p>Does this equation seem familiar to you? It is similar to the second model in Chapter 1 for the spread of Ebola! While this may seem surprising, it is often the case that similar equations appear in different contexts. It is far more advantageous to learn how to analyze models qualitatively rather than memorize several different types of models and not see the connections between them.</p>
<!-- LW pg 73 has some good examples, derived in handlingh patches. -->
</div>
<div id="other-types-of-functional-responses" class="section level2">
<h2><span class="header-section-number">4.4</span> Other types of functional responses</h2>
<p>In several examples we have seen a rate of change proportional to the current population, as in the rate of growth of the hare population is <span class="math inline">\(rH\)</span>. This is one example of what we would call a <a href="https://en.wikipedia.org/wiki/Functional_response"><em>functional response</em></a>. Another type of functional response assumes that the rate reaches a limiting value proportional to the population size, so <span class="math inline">\(\displaystyle \frac{dH}{dt} = \frac{rH}{1+arH}\)</span>. This is an example of a <strong>type II functional response</strong>. Finally the type II response has also been generalized (a <strong>type III functional response</strong>) <span class="math inline">\(\displaystyle \frac{dH}{dt} = \frac{rH^{2}}{1+arH^{2}}\)</span>. The following plot shows all three together:</p>
<p><img src="ModelingWithR_files/figure-html/unnamed-chunk-21-1.png" width="480" /></p>
<p>Notice the limiting behavior in the Type II and Type III functional responses. These responses are commonly used in ecology and predator-prey dynamics and in problems of how animals search for food.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="exercises-1" class="section level2">
<h2><span class="header-section-number">4.5</span> Exercises</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-22" class="exercise"><strong>(#exr:unnamed-chunk-22) </strong></span>Consider the following type of functional responses:
<span class="math display">\[\begin{align}
\mbox{ Type I: } \frac{dP}{dt} &amp;= a P \\
\mbox{ Type II: } \frac{dP}{dt} &amp;= \frac{aP}{1+abP} \\
\mbox{ Type III: } \frac{dP}{dt} &amp;= \frac{rP^{2}}{1+arP^{2}}
\end{align}\]</span></p>
<p>For each of the functional responses evaluate <span class="math inline">\(\displaystyle \lim_{P \rightarrow \infty} \frac{dP}{dt}\)</span>. Since these functional responses represent a rate of change of a population, what are some examples (hypothetical or actual) would each of these responses be appropriate?</p>
</div>

 

<div class="exercise">
<span id="exr:unnamed-chunk-23" class="exercise"><strong>(#exr:unnamed-chunk-23) </strong></span>A population grows according to the equation <span class="math inline">\(\displaystyle \frac{dP}{dt} = \frac{aP}{1+abP} - dP\)</span>, where <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> are parameters. Determine the value of <span class="math inline">\(P\)</span> when the population is in steady state, that is <span class="math inline">\(\displaystyle \frac{dP}{dt}=0\)</span>.
</div>

 

<div class="exercise">
<p><span id="exr:unnamed-chunk-24" class="exercise"><strong>(#exr:unnamed-chunk-24) </strong></span>For a chemical reaction takes two chemicals <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to form a substrate <span class="math inline">\(Z\)</span> through the law of mass action. However the substrate can also disassociate. The reaction schematic is the following:</p>
<p><span class="math display">\[\begin{equation}
X + Y \rightleftharpoons Z,
\end{equation}\]</span></p>
<p>where the proportionality constant <span class="math inline">\(k_+\)</span> is associated with the formation of the substrate <span class="math inline">\(Z\)</span> and <span class="math inline">\(k_-\)</span> the disassociation (<span class="math inline">\(Z\)</span> decays back to <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>). Write down a differential equation that represents the rate of reaction <span class="math inline">\(\displaystyle \frac{dZ}{dt}\)</span>.</p>
</div>

<p> </p>
For each of the following exercises consider the following contextual situations modeling rates of change. Name variables for each situation and write down a differential equation describing the context. For each problem you will need to:

 

<div class="exercise">
<span id="exr:unnamed-chunk-25" class="exercise"><strong>(#exr:unnamed-chunk-25) </strong></span>The rate of change of an animal’s body temperature is proportional to the difference in temperature between the environment.
</div>

 
<!-- Thornley and Johnson -->

<div class="exercise">
<span id="exr:unnamed-chunk-26" class="exercise"><strong>(#exr:unnamed-chunk-26) </strong></span>A plant grows propritional to its current length <span class="math inline">\(L\)</span>. Assume this proportionality constant is <span class="math inline">\(\mu\)</span>, whose rate also decreases proportional to its current value. You will need to write down a system of two equation with variables <span class="math inline">\(L\)</span> and <span class="math inline">\(\mu\)</span>.
</div>

 
<!-- Logan and wollensenky -->

<div class="exercise">
<span id="exr:unnamed-chunk-27" class="exercise"><strong>(#exr:unnamed-chunk-27) </strong></span>A patient undergoing chemotherapy receives an injection at rate <span class="math inline">\(I\)</span>. This injection decreases the rate that a tumor accumulates mass. Independent of the injection, the tumor accumulates mass at a rate proportional to the mass of the tumor.
</div>

 
<!-- Logan and wollensenky page 4 -->

<div class="exercise">
<span id="exr:unnamed-chunk-28" class="exercise"><strong>(#exr:unnamed-chunk-28) </strong></span>A cell with radius <span class="math inline">\(r\)</span> assimilates nutrients at a rate proportional to its surface area, but uses nutrients proportional to its volume. Determine an equation that represents the rate of change of the radius.
</div>

 

<div class="exercise">
<span id="exr:unnamed-chunk-29" class="exercise"><strong>(#exr:unnamed-chunk-29) </strong></span>The rate that a cancer cell divides (increases in amount) is proportional to the amount of healthy cells in its surrounding environment. You may assume that a healthy cell has a mortality <span class="math inline">\(\delta_{H}\)</span> and a cancer cell has mortality <span class="math inline">\(\delta_{C}\)</span>. Be sure to write down a system of differential equations for the population of cancer cells <span class="math inline">\(C\)</span> and healthy cells <span class="math inline">\(H\)</span>.
</div>

 

<div class="exercise">
<span id="exr:unnamed-chunk-30" class="exercise"><strong>(#exr:unnamed-chunk-30) </strong></span>The rate that a virus is spread to the population is proportional to the probability that a person is sick (out of <span class="math inline">\(N\)</span> total sick and healthy individuals).
</div>

<p> </p>
<div class="figure">
<img src="ModelingWithR_files/figure-html/pesticide-ch3-1.png" alt="Reaction schemes." width="672" />
<p class="caption">
(#fig:pesticide-ch3)Reaction schemes.
</p>
</div>
<!-- From Burnham and Anderson pg 135 of pdf -->

<div class="exercise">
<span id="exr:unnamed-chunk-31" class="exercise"><strong>(#exr:unnamed-chunk-31) </strong></span>You are tasked with the job of investigating the effect of a pesticide on water quality, in terms of its effects on the health of the plants and fish in the ecosystem. Different models can be created that investigate the effect of the pesticide. Different types of reaction schemes for this system are shown in Figure @ref(fig:pesticide-ch3), where <span class="math inline">\(F\)</span> represents the amount of pesticide in the fish, <span class="math inline">\(W\)</span> the amount of pesticide in the water, and <span class="math inline">\(S\)</span> the amount of pesticide in the soil. The prime (e.g. <span class="math inline">\(F&#39;\)</span>, <span class="math inline">\(W&#39;\)</span>, and <span class="math inline">\(S&#39;\)</span> represent other bound forms of the respective state). In all seven different models can be derived. For each of the model schematics, apply the Law of Mass Action to write down a system of differential equations.
</div>

<!--chapter:end:03-modelingWithRates.Rmd-->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>You may be used to working with <em>algebraic equations</em> (e.g. solve <span class="math inline">\(x^{2}-4=0\)</span> for <span class="math inline">\(x\)</span>). In that case the solution can be points (for our example, <span class="math inline">\(x=\pm2\)</span>).<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
