<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Cost functions: likelihood functions in disguise | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Cost functions: likelihood functions in disguise | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Cost functions: likelihood functions in disguise | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cost-fns-10.html"/>
<link rel="next" href="connection-to-likelihood-functions.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>2</b> Cost Functions &amp; Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cost-functions-likelihood-functions-in-disguise.html"><a href="cost-functions-likelihood-functions-in-disguise.html"><i class="fa fa-check"></i><b>2.1</b> Cost functions: likelihood functions in disguise</a></li>
<li class="chapter" data-level="2.2" data-path="connection-to-likelihood-functions.html"><a href="connection-to-likelihood-functions.html"><i class="fa fa-check"></i><b>2.2</b> Connection to likelihood functions</a></li>
<li class="chapter" data-level="2.3" data-path="extending-the-cost-function.html"><a href="extending-the-cost-function.html"><i class="fa fa-check"></i><b>2.3</b> Extending the cost function</a></li>
<li class="chapter" data-level="2.4" data-path="conditional-probabilities-and-bayes-rule.html"><a href="conditional-probabilities-and-bayes-rule.html"><i class="fa fa-check"></i><b>2.4</b> Conditional Probabilities and Bayes’ Rule</a></li>
<li class="chapter" data-level="2.5" data-path="bayes-rule-and-linear-regression.html"><a href="bayes-rule-and-linear-regression.html"><i class="fa fa-check"></i><b>2.5</b> Bayes’ Rule and Linear Regression</a></li>
<li class="chapter" data-level="2.6" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cost-functions-likelihood-functions-in-disguise" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Cost functions: likelihood functions in disguise</h2>
<p>So far we have seen the idea of Another approach that can be incorporated into parameter estimation is the idea of a <em>cost function</em>. Let’s start with this problem from the last few sections:</p>
<blockquote>
<p>Assume we have the following (limited) data set of points that we wish to fit a function of the form <span class="math inline">\(y=bx\)</span> (note, we are forcing the intercept term to be zero).</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x\)</span></th>
<th align="center"><span class="math inline">\(y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p>One way that we can do this is by saying the estimate of <span class="math inline">\(b\)</span> is determined by the one that <em>minimizes</em> the difference between the measured <span class="math inline">\(y\)</span> values. We do this by computing the residual, or the expression <span class="math inline">\(y-bx\)</span>. Let’s extend out this table a little more:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x\)</span></th>
<th align="center"><span class="math inline">\(y\)</span></th>
<th align="left"><span class="math inline">\(bx\)</span></th>
<th align="center"><span class="math inline">\(y-bx\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
<td align="left"><span class="math inline">\(b\)</span></td>
<td align="center"><span class="math inline">\(3-b\)</span></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">5</td>
<td align="left"><span class="math inline">\(2b\)</span></td>
<td align="center"><span class="math inline">\(5-2b\)</span></td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">4</td>
<td align="left"><span class="math inline">\(4b\)</span></td>
<td align="center"><span class="math inline">\(4-4b\)</span></td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">10</td>
<td align="left"><span class="math inline">\(4b\)</span></td>
<td align="center"><span class="math inline">\(10-4b\)</span></td>
</tr>
</tbody>
</table>
<p>You can see how this residual changes <span class="math inline">\(y-bx\)</span> for different values of <span class="math inline">\(b\)</span>:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(y-bx\)</span></th>
<th align="center"><span class="math inline">\(b=1\)</span></th>
<th align="left"><span class="math inline">\(b=3\)</span></th>
<th align="left"><span class="math inline">\(b=-1\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(3-b\)</span></td>
<td align="center">2</td>
<td align="left">0</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(5-2b\)</span></td>
<td align="center">3</td>
<td align="left">-1</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(4-4b\)</span></td>
<td align="center">0</td>
<td align="left">-8</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(10-4b\)</span></td>
<td align="center">6</td>
<td align="left">-2</td>
<td align="left">14</td>
</tr>
</tbody>
</table>
<p>Notice that the values of the residual at each <span class="math inline">\((x,y)\)</span> pair change as <span class="math inline">\(b\)</span> changes - some of the residuals can be negative and some can be positive. If we were to assess the overall residuals as a function of the value of <span class="math inline">\(b\)</span>, we need to take into account not just the value of the residual (positive or negative), but rather the <em>magnitude</em> of the residual. How we do that is if we take the sum of the square difference (or the residual), we have:</p>
<p><span class="math display">\[\begin{equation}
S(b)=(3-b)^2+(5-2b)^2+(4-4b)^2+(10-4b)^2
\end{equation}\]</span></p>
<div class="figure"><span id="fig:quadsb"></span>
<img src="series_files/figure-html/quadsb-1.png" alt="The square residual $S(b)$. The vertical line denotes the minimum value at $b=1.561$." width="384" />
<p class="caption">
Figure 2.1: The square residual <span class="math inline">\(S(b)\)</span>. The vertical line denotes the minimum value at <span class="math inline">\(b=1.561\)</span>.
</p>
</div>
<p>This looks like a function of one variable. Let’s make a plot of <span class="math inline">\(S(b)\)</span> in Figure <a href="cost-functions-likelihood-functions-in-disguise.html#fig:quadsb">2.1</a>. Notice how the plot of <span class="math inline">\(S(b)\)</span> looks like a really nice quadratic function, with a minimum at <span class="math inline">\(b=1.86\)</span>. Did you notice that this value for <span class="math inline">\(b\)</span> is the same value for the minimum that we found in the likelihood function from Section <a href="#likelihood-09"><strong>??</strong></a>? In fact, if we multiplied out <span class="math inline">\(S(b)\)</span> and collected terms, this <em>would</em> be a quadratic function - which has a well defined optimum value that you can find using calculus.</p>
<p>Let’s compare the value of <span class="math inline">\(b\)</span> to the best fit line in Figure <a href="cost-functions-likelihood-functions-in-disguise.html#fig:sbbestfit">2.2</a>.</p>
<div class="figure"><span id="fig:sbbestfit"></span>
<img src="series_files/figure-html/sbbestfit-1.png" alt="Data with the best fit line" width="384" />
<p class="caption">
Figure 2.2: Data with the best fit line
</p>
</div>
<p>The cost function approach described above seems to be working out well in that we have a value for <span class="math inline">\(b\)</span>, but it also looks like a lot of the data lies above the best fit line. We can address that later, but one approach is to include the uncertainty on each of the measured values in the cost function. The uncertainty may be the same (<span class="math inline">\(\sigma\)</span>) for all measurements or it could vary from measurement to measurement. In both cases we divide each of the components of the cost function by the given uncertainty. We can represent this cost function more generally using <span class="math inline">\(\sum\)</span> notation:</p>
<p><span class="math display">\[\begin{equation}
S(\vec{\alpha}) = \sum_{i=1}^{N} \frac{(y_{i}-f(x,\vec{\alpha}))^{2}}{\sigma^{2}}
\end{equation}\]</span></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cost-fns-10.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="connection-to-likelihood-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/10-costFunctions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/10-costFunctions.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
