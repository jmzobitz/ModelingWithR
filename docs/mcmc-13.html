<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Markov Chain Monte Carlo Parameter Estimation | Exploring Modeling with Data and Differential Equations Using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Markov Chain Monte Carlo Parameter Estimation | Exploring Modeling with Data and Differential Equations Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Markov Chain Monte Carlo Parameter Estimation | Exploring Modeling with Data and Differential Equations Using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metropolis-12.html"/>
<link rel="next" href="information-criteria-14.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li><a href="index.html#welcome">Welcome<span></span></a>
<ul>
<li><a href="index.html#computational-code">Computational code<span></span></a></li>
<li><a href="index.html#questions-comments-issues">Questions? Comments? Issues?<span></span></a></li>
<li><a href="index.html#about-the-cover">About the cover<span></span></a></li>
<li><a href="index.html#acknowledgments">Acknowledgments<span></span></a></li>
</ul></li>
<li class="part"><span><b>I Models with Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="1" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>1</b> Models of Rates with Data<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-01.html"><a href="intro-01.html#rates-of-change-in-the-world-a-model-is-born"><i class="fa fa-check"></i><b>1.1</b> Rates of change in the world: a model is born<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="intro-01.html"><a href="intro-01.html#modeling-in-context-the-spread-of-a-disease"><i class="fa fa-check"></i><b>1.2</b> Modeling in context: the spread of a disease<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="intro-01.html"><a href="intro-01.html#model-solutions"><i class="fa fa-check"></i><b>1.3</b> Model solutions<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="intro-01.html"><a href="intro-01.html#which-model-is-best"><i class="fa fa-check"></i><b>1.4</b> Which model is best?<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="intro-01.html"><a href="intro-01.html#start-here"><i class="fa fa-check"></i><b>1.5</b> Start here<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="intro-01.html"><a href="intro-01.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-intro-02.html"><a href="r-intro-02.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> <code>R</code> and RStudio<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="r-intro-02.html"><a href="r-intro-02.html#first-steps-getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.2</b> First steps: getting acquainted with <code>R</code><span></span></a></li>
<li class="chapter" data-level="2.3" data-path="r-intro-02.html"><a href="r-intro-02.html#increasing-functionality-with-packages"><i class="fa fa-check"></i><b>2.3</b> Increasing functionality with packages<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="r-intro-02.html"><a href="r-intro-02.html#working-with-r-variables-data-frames-and-datasets"><i class="fa fa-check"></i><b>2.4</b> Working with <code>R</code>: variables, data frames, and datasets<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="r-intro-02.html"><a href="r-intro-02.html#visualization-with-r"><i class="fa fa-check"></i><b>2.5</b> Visualization with <code>R</code><span></span></a></li>
<li class="chapter" data-level="2.6" data-path="r-intro-02.html"><a href="r-intro-02.html#defining-functions"><i class="fa fa-check"></i><b>2.6</b> Defining functions<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="r-intro-02.html"><a href="r-intro-02.html#concluding-thoughts"><i class="fa fa-check"></i><b>2.7</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="2.8" data-path="r-intro-02.html"><a href="r-intro-02.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>3</b> Modeling with Rates of Change<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#competing-plant-species-and-equilibrium-solutions"><i class="fa fa-check"></i><b>3.1</b> Competing plant species and equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#the-law-of-mass-action"><i class="fa fa-check"></i><b>3.2</b> The Law of Mass Action<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#coupled-differential-equations-lynx-and-hares"><i class="fa fa-check"></i><b>3.3</b> Coupled differential equations: lynx and hares<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#functional-responses"><i class="fa fa-check"></i><b>3.4</b> Functional responses<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>4</b> Euler’s Method<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="euler-04.html"><a href="euler-04.html#the-flu-and-locally-linear-approximation"><i class="fa fa-check"></i><b>4.1</b> The flu and locally linear approximation<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="euler-04.html"><a href="euler-04.html#a-workflow-for-approximation"><i class="fa fa-check"></i><b>4.2</b> A workflow for approximation<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="euler-04.html"><a href="euler-04.html#building-an-iterative-method"><i class="fa fa-check"></i><b>4.3</b> Building an iterative method<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="euler-04.html"><a href="euler-04.html#eulers-method-and-beyond"><i class="fa fa-check"></i><b>4.4</b> Euler’s method and beyond<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="euler-04.html"><a href="euler-04.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>5</b> Phase Lines and Equilibrium Solutions<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="phase-05.html"><a href="phase-05.html#equilibrium-solutions"><i class="fa fa-check"></i><b>5.1</b> Equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="phase-05.html"><a href="phase-05.html#phase-lines-for-differential-equations"><i class="fa fa-check"></i><b>5.2</b> Phase lines for differential equations<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="phase-05.html"><a href="phase-05.html#a-stability-test-for-equilibrium-solutions"><i class="fa fa-check"></i><b>5.3</b> A stability test for equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="phase-05.html"><a href="phase-05.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>6</b> Coupled Systems of Equations<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="coupled-06.html"><a href="coupled-06.html#flu-with-quarantine-and-equilibrium-solutions"><i class="fa fa-check"></i><b>6.1</b> Flu with quarantine and equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="coupled-06.html"><a href="coupled-06.html#nullclines"><i class="fa fa-check"></i><b>6.2</b> Nullclines<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="coupled-06.html"><a href="coupled-06.html#phase-planes"><i class="fa fa-check"></i><b>6.3</b> Phase planes<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="coupled-06.html"><a href="coupled-06.html#generating-a-phase-plane-in-r"><i class="fa fa-check"></i><b>6.4</b> Generating a phase plane in <code>R</code><span></span></a></li>
<li class="chapter" data-level="6.5" data-path="coupled-06.html"><a href="coupled-06.html#slope-fields"><i class="fa fa-check"></i><b>6.5</b> Slope fields<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="coupled-06.html"><a href="coupled-06.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>7</b> Exact Solutions to Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-a-solution"><i class="fa fa-check"></i><b>7.1</b> Verify a solution<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="exact-solns-07.html"><a href="exact-solns-07.html#separable-differential-equations"><i class="fa fa-check"></i><b>7.2</b> Separable differential equations<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="exact-solns-07.html"><a href="exact-solns-07.html#integrating-factors"><i class="fa fa-check"></i><b>7.3</b> Integrating factors<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-broad-07"><i class="fa fa-check"></i><b>7.4</b> Applying the verification method to coupled equations<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="exact-solns-07.html"><a href="exact-solns-07.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>II Parameterizing Models with Data<span></span></b></span></li>
<li class="chapter" data-level="8" data-path="linear-regression-08.html"><a href="linear-regression-08.html"><i class="fa fa-check"></i><b>8</b> Linear Regression and Curve Fitting<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression-08.html"><a href="linear-regression-08.html#what-is-parameter-estimation"><i class="fa fa-check"></i><b>8.1</b> What is parameter estimation?<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-for-global-temperature-data"><i class="fa fa-check"></i><b>8.2</b> Parameter estimation for global temperature data<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="linear-regression-08.html"><a href="linear-regression-08.html#beyond-linear-08"><i class="fa fa-check"></i><b>8.3</b> Moving beyond linear models for parameter estimation<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-with-nonlinear-models"><i class="fa fa-check"></i><b>8.4</b> Parameter estimation with nonlinear models<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression-08.html"><a href="linear-regression-08.html#towards-model-data-fusion"><i class="fa fa-check"></i><b>8.5</b> Towards model-data fusion<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="linear-regression-08.html"><a href="linear-regression-08.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="likelihood-09.html"><a href="likelihood-09.html"><i class="fa fa-check"></i><b>9</b> Probability and Likelihood Functions<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="likelihood-09.html"><a href="likelihood-09.html#linear-regression-on-a-small-dataset"><i class="fa fa-check"></i><b>9.1</b> Linear regression on a small dataset<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="likelihood-09.html"><a href="likelihood-09.html#continuous-probability-density-functions"><i class="fa fa-check"></i><b>9.2</b> Continuous probability density functions<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="likelihood-09.html"><a href="likelihood-09.html#connecting-probabilities-to-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Connecting probabilities to linear regression<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="likelihood-09.html"><a href="likelihood-09.html#visualizing-likelihood-surfaces"><i class="fa fa-check"></i><b>9.4</b> Visualizing likelihood surfaces<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="likelihood-09.html"><a href="likelihood-09.html#looking-back-and-forward"><i class="fa fa-check"></i><b>9.5</b> Looking back and forward<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="likelihood-09.html"><a href="likelihood-09.html#exercises-8"><i class="fa fa-check"></i><b>9.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>10</b> Cost Functions qnd Bayes’ Rule<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="cost-fns-10.html"><a href="cost-fns-10.html#cost-functions-and-model-data-residuals"><i class="fa fa-check"></i><b>10.1</b> Cost functions and model-data residuals<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="cost-fns-10.html"><a href="cost-fns-10.html#further-extensions-to-the-cost-function"><i class="fa fa-check"></i><b>10.2</b> Further extensions to the cost function<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="cost-fns-10.html"><a href="cost-fns-10.html#conditional-probabilities-and-bayes-rule"><i class="fa fa-check"></i><b>10.3</b> Conditional probabilities and Bayes’ rule<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="cost-fns-10.html"><a href="cost-fns-10.html#bayes-rule-in-action"><i class="fa fa-check"></i><b>10.4</b> Bayes’ rule in action<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="cost-fns-10.html"><a href="cost-fns-10.html#next-steps"><i class="fa fa-check"></i><b>10.5</b> Next steps<span></span></a></li>
<li class="chapter" data-level="10.6" data-path="cost-fns-10.html"><a href="cost-fns-10.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bootstrap-11.html"><a href="bootstrap-11.html"><i class="fa fa-check"></i><b>11</b> Sampling Distributions and the Bootstrap Method<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="bootstrap-11.html"><a href="bootstrap-11.html#histograms-and-their-visualization"><i class="fa fa-check"></i><b>11.1</b> Histograms and their visualization<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="bootstrap-11.html"><a href="bootstrap-11.html#statistical-theory-sampling-distributions"><i class="fa fa-check"></i><b>11.2</b> Statistical theory: sampling distributions<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="bootstrap-11.html"><a href="bootstrap-11.html#summary-and-next-steps"><i class="fa fa-check"></i><b>11.3</b> Summary and next steps<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="bootstrap-11.html"><a href="bootstrap-11.html#exercises-10"><i class="fa fa-check"></i><b>11.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="metropolis-12.html"><a href="metropolis-12.html"><i class="fa fa-check"></i><b>12</b> The Metropolis-Hastings Algorithm<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="metropolis-12.html"><a href="metropolis-12.html#estimating-the-growth-of-a-dog"><i class="fa fa-check"></i><b>12.1</b> Estimating the growth of a dog<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="metropolis-12.html"><a href="metropolis-12.html#lr-12"><i class="fa fa-check"></i><b>12.2</b> Likelihood ratios for parameter estimation<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="metropolis-12.html"><a href="metropolis-12.html#the-metropolis-hastings-algorithm-for-parameter-estimation"><i class="fa fa-check"></i><b>12.3</b> The Metropolis-Hastings algorithm for parameter estimation<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="metropolis-12.html"><a href="metropolis-12.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mcmc-13.html"><a href="mcmc-13.html"><i class="fa fa-check"></i><b>13</b> Markov Chain Monte Carlo Parameter Estimation<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="mcmc-13.html"><a href="mcmc-13.html#the-recipe-for-mcmc"><i class="fa fa-check"></i><b>13.1</b> The recipe for MCMC<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-an-empirical-model"><i class="fa fa-check"></i><b>13.2</b> MCMC parameter estimation with an empirical model<span></span></a></li>
<li class="chapter" data-level="13.3" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-a-differential-equation-model"><i class="fa fa-check"></i><b>13.3</b> MCMC parameter estimation with a differential equation model<span></span></a></li>
<li class="chapter" data-level="13.4" data-path="mcmc-13.html"><a href="mcmc-13.html#timing-your-code"><i class="fa fa-check"></i><b>13.4</b> Timing your code<span></span></a></li>
<li class="chapter" data-level="13.5" data-path="mcmc-13.html"><a href="mcmc-13.html#further-extensions-to-mcmc"><i class="fa fa-check"></i><b>13.5</b> Further extensions to MCMC<span></span></a></li>
<li class="chapter" data-level="13.6" data-path="mcmc-13.html"><a href="mcmc-13.html#exercises-12"><i class="fa fa-check"></i><b>13.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="information-criteria-14.html"><a href="information-criteria-14.html"><i class="fa fa-check"></i><b>14</b> Information Criteria<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="information-criteria-14.html"><a href="information-criteria-14.html#model-assessment-guidelines"><i class="fa fa-check"></i><b>14.1</b> Model assessment guidelines<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="information-criteria-14.html"><a href="information-criteria-14.html#information-criteria-for-assessing-competing-models"><i class="fa fa-check"></i><b>14.2</b> Information criteria for assessing competing models<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="information-criteria-14.html"><a href="information-criteria-14.html#a-few-cautionary-notes"><i class="fa fa-check"></i><b>14.3</b> A few cautionary notes<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="information-criteria-14.html"><a href="information-criteria-14.html#exercises-13"><i class="fa fa-check"></i><b>14.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>III Stability Analysis for Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="15" data-path="linearsystems-15.html"><a href="linearsystems-15.html"><i class="fa fa-check"></i><b>15</b> Systems of Linear Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="linearsystems-15.html"><a href="linearsystems-15.html#linear-systems-of-differential-equations-and-matrix-notation"><i class="fa fa-check"></i><b>15.1</b> Linear systems of differential equations and matrix notation<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="linearsystems-15.html"><a href="linearsystems-15.html#equilibrium-solutions-1"><i class="fa fa-check"></i><b>15.2</b> Equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="linearsystems-15.html"><a href="linearsystems-15.html#the-phase-plane"><i class="fa fa-check"></i><b>15.3</b> The phase plane<span></span></a></li>
<li class="chapter" data-level="15.4" data-path="linearsystems-15.html"><a href="linearsystems-15.html#non-equilibrium-solutions-and-their-stability"><i class="fa fa-check"></i><b>15.4</b> Non-equilibrium solutions and their stability<span></span></a></li>
<li class="chapter" data-level="15.5" data-path="linearsystems-15.html"><a href="linearsystems-15.html#exercises-14"><i class="fa fa-check"></i><b>15.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="nonlinear-16.html"><a href="nonlinear-16.html"><i class="fa fa-check"></i><b>16</b> Systems of Nonlinear Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="nonlinear-16.html"><a href="nonlinear-16.html#introducing-nonlinear-systems-of-differential-equations"><i class="fa fa-check"></i><b>16.1</b> Introducing nonlinear systems of differential equations<span></span></a></li>
<li class="chapter" data-level="16.2" data-path="nonlinear-16.html"><a href="nonlinear-16.html#zooming-in-on-the-phase-plane"><i class="fa fa-check"></i><b>16.2</b> Zooming in on the phase plane<span></span></a></li>
<li class="chapter" data-level="16.3" data-path="nonlinear-16.html"><a href="nonlinear-16.html#determining-equilibrium-solutions-with-nullclines"><i class="fa fa-check"></i><b>16.3</b> Determining equilibrium solutions with nullclines<span></span></a></li>
<li class="chapter" data-level="16.4" data-path="nonlinear-16.html"><a href="nonlinear-16.html#stability-of-an-equilibrium-solution"><i class="fa fa-check"></i><b>16.4</b> Stability of an equilibrium solution<span></span></a></li>
<li class="chapter" data-level="16.5" data-path="nonlinear-16.html"><a href="nonlinear-16.html#graphing-nullclines-in-a-phase-plane"><i class="fa fa-check"></i><b>16.5</b> Graphing nullclines in a phase plane<span></span></a></li>
<li class="chapter" data-level="16.6" data-path="nonlinear-16.html"><a href="nonlinear-16.html#exercises-15"><i class="fa fa-check"></i><b>16.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="jacobian-17.html"><a href="jacobian-17.html"><i class="fa fa-check"></i><b>17</b> Local Linearization and the Jacobian<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="jacobian-17.html"><a href="jacobian-17.html#competing-populations"><i class="fa fa-check"></i><b>17.1</b> Competing populations<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="jacobian-17.html"><a href="jacobian-17.html#tangent-plane-approximations"><i class="fa fa-check"></i><b>17.2</b> Tangent plane approximations<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="jacobian-17.html"><a href="jacobian-17.html#the-jacobian-matrix"><i class="fa fa-check"></i><b>17.3</b> The Jacobian matrix<span></span></a></li>
<li class="chapter" data-level="17.4" data-path="jacobian-17.html"><a href="jacobian-17.html#exercises-16"><i class="fa fa-check"></i><b>17.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html"><i class="fa fa-check"></i><b>18</b> What are Eigenvalues?<span></span></a>
<ul>
<li class="chapter" data-level="18.1" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#introduction"><i class="fa fa-check"></i><b>18.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#straight-line-solutions"><i class="fa fa-check"></i><b>18.2</b> Straight line solutions<span></span></a></li>
<li class="chapter" data-level="18.3" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#computing-eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>18.3</b> Computing eigenvalues and eigenvectors<span></span></a></li>
<li class="chapter" data-level="18.4" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#what-do-eigenvalues-tell-us"><i class="fa fa-check"></i><b>18.4</b> What do eigenvalues tell us?<span></span></a></li>
<li class="chapter" data-level="18.5" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#concluding-thoughts-1"><i class="fa fa-check"></i><b>18.5</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="18.6" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#exercises-17"><i class="fa fa-check"></i><b>18.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="stability-19.html"><a href="stability-19.html"><i class="fa fa-check"></i><b>19</b> Qualitative Stability Analysis<span></span></a>
<ul>
<li class="chapter" data-level="19.1" data-path="stability-19.html"><a href="stability-19.html#the-characteristic-polynomial-again"><i class="fa fa-check"></i><b>19.1</b> The characteristic polynomial (again)<span></span></a></li>
<li class="chapter" data-level="19.2" data-path="stability-19.html"><a href="stability-19.html#stability-with-the-trace-and-determinant"><i class="fa fa-check"></i><b>19.2</b> Stability with the trace and determinant<span></span></a></li>
<li class="chapter" data-level="19.3" data-path="stability-19.html"><a href="stability-19.html#a-workflow-for-stability-analysis"><i class="fa fa-check"></i><b>19.3</b> A workflow for stability analysis<span></span></a></li>
<li class="chapter" data-level="19.4" data-path="stability-19.html"><a href="stability-19.html#stability-for-higher-order-systems-of-differential-equations."><i class="fa fa-check"></i><b>19.4</b> Stability for higher-order systems of differential equations.<span></span></a></li>
<li class="chapter" data-level="19.5" data-path="stability-19.html"><a href="stability-19.html#exercises-18"><i class="fa fa-check"></i><b>19.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bifurcation-20.html"><a href="bifurcation-20.html"><i class="fa fa-check"></i><b>20</b> Bifurcation<span></span></a>
<ul>
<li class="chapter" data-level="20.1" data-path="bifurcation-20.html"><a href="bifurcation-20.html#a-series-of-equations"><i class="fa fa-check"></i><b>20.1</b> A series of equations<span></span></a></li>
<li class="chapter" data-level="20.2" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-with-systems-of-equations"><i class="fa fa-check"></i><b>20.2</b> Bifurcations with systems of equations<span></span></a></li>
<li class="chapter" data-level="20.3" data-path="bifurcation-20.html"><a href="bifurcation-20.html#functions-as-equilibrium-solutions-limit-cycles"><i class="fa fa-check"></i><b>20.3</b> Functions as equilibrium solutions: limit cycles<span></span></a></li>
<li class="chapter" data-level="20.4" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-as-analysis-tools"><i class="fa fa-check"></i><b>20.4</b> Bifurcations as analysis tools<span></span></a></li>
<li class="chapter" data-level="20.5" data-path="bifurcation-20.html"><a href="bifurcation-20.html#exercises-19"><i class="fa fa-check"></i><b>20.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>IV Stochastic Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="21" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html"><i class="fa fa-check"></i><b>21</b> Stochastic Biological Systems<span></span></a>
<ul>
<li class="chapter" data-level="21.1" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#introducing-stochastic-effects"><i class="fa fa-check"></i><b>21.1</b> Introducing stochastic effects<span></span></a></li>
<li class="chapter" data-level="21.2" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#a-discrete-dynamical-system"><i class="fa fa-check"></i><b>21.2</b> A discrete dynamical system<span></span></a></li>
<li class="chapter" data-level="21.3" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#environmental-stochasticity"><i class="fa fa-check"></i><b>21.3</b> Environmental stochasticity<span></span></a></li>
<li class="chapter" data-level="21.4" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#discrete-systems-of-equations"><i class="fa fa-check"></i><b>21.4</b> Discrete systems of equations<span></span></a></li>
<li class="chapter" data-level="21.5" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#exercises-20"><i class="fa fa-check"></i><b>21.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html"><i class="fa fa-check"></i><b>22</b> Simulating and Visualizing Randomness<span></span></a>
<ul>
<li class="chapter" data-level="22.1" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#ensemble-averages"><i class="fa fa-check"></i><b>22.1</b> Ensemble averages<span></span></a></li>
<li class="chapter" data-level="22.2" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#repeated-iteration"><i class="fa fa-check"></i><b>22.2</b> Repeated iteration<span></span></a></li>
<li class="chapter" data-level="22.3" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#exercises-21"><i class="fa fa-check"></i><b>22.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="random-walks-23.html"><a href="random-walks-23.html"><i class="fa fa-check"></i><b>23</b> Random Walks<span></span></a>
<ul>
<li class="chapter" data-level="23.1" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-on-a-number-line"><i class="fa fa-check"></i><b>23.1</b> Random walk on a number line<span></span></a></li>
<li class="chapter" data-level="23.2" data-path="random-walks-23.html"><a href="random-walks-23.html#iteration-and-ensemble-averages"><i class="fa fa-check"></i><b>23.2</b> Iteration and ensemble averages<span></span></a></li>
<li class="chapter" data-level="23.3" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-mathematics"><i class="fa fa-check"></i><b>23.3</b> Random walk mathematics<span></span></a></li>
<li class="chapter" data-level="23.4" data-path="random-walks-23.html"><a href="random-walks-23.html#continuous-random-walks-and-diffusion"><i class="fa fa-check"></i><b>23.4</b> Continuous random walks and diffusion<span></span></a></li>
<li class="chapter" data-level="23.5" data-path="random-walks-23.html"><a href="random-walks-23.html#exercises-22"><i class="fa fa-check"></i><b>23.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="diffusion-24.html"><a href="diffusion-24.html"><i class="fa fa-check"></i><b>24</b> Diffusion and Brownian Motion<span></span></a>
<ul>
<li class="chapter" data-level="24.1" data-path="diffusion-24.html"><a href="diffusion-24.html#random-walk-redux"><i class="fa fa-check"></i><b>24.1</b> Random walk redux<span></span></a></li>
<li class="chapter" data-level="24.2" data-path="diffusion-24.html"><a href="diffusion-24.html#simulating-brownian-motion"><i class="fa fa-check"></i><b>24.2</b> Simulating Brownian motion<span></span></a></li>
<li class="chapter" data-level="24.3" data-path="diffusion-24.html"><a href="diffusion-24.html#exercises-23"><i class="fa fa-check"></i><b>24.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>25</b> Simulating Stochastic Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="25.1" data-path="sdes-25.html"><a href="sdes-25.html#the-stochastic-logistic-model"><i class="fa fa-check"></i><b>25.1</b> The stochastic logistic model<span></span></a></li>
<li class="chapter" data-level="25.2" data-path="sdes-25.html"><a href="sdes-25.html#the-euler-maruyama-method"><i class="fa fa-check"></i><b>25.2</b> The Euler-Maruyama method<span></span></a></li>
<li class="chapter" data-level="25.3" data-path="sdes-25.html"><a href="sdes-25.html#adding-stochasticity-to-parameters"><i class="fa fa-check"></i><b>25.3</b> Adding stochasticity to parameters<span></span></a></li>
<li class="chapter" data-level="25.4" data-path="sdes-25.html"><a href="sdes-25.html#systems-of-stochastic-differential-equations"><i class="fa fa-check"></i><b>25.4</b> Systems of stochastic differential equations<span></span></a></li>
<li class="chapter" data-level="25.5" data-path="sdes-25.html"><a href="sdes-25.html#concluding-thoughts-2"><i class="fa fa-check"></i><b>25.5</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="25.6" data-path="sdes-25.html"><a href="sdes-25.html#exercises-24"><i class="fa fa-check"></i><b>25.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html"><i class="fa fa-check"></i><b>26</b> Statistics of a Stochastic Differential Equation<span></span></a>
<ul>
<li class="chapter" data-level="26.1" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#expected-value-of-a-stochastic-process"><i class="fa fa-check"></i><b>26.1</b> Expected value of a stochastic process<span></span></a></li>
<li class="chapter" data-level="26.2" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#birth-death-processes"><i class="fa fa-check"></i><b>26.2</b> Birth-death processes<span></span></a></li>
<li class="chapter" data-level="26.3" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#wrapping-up"><i class="fa fa-check"></i><b>26.3</b> Wrapping up<span></span></a></li>
<li class="chapter" data-level="26.4" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#exercises-25"><i class="fa fa-check"></i><b>26.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>27</b> Solutions to Stochastic Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="27.1" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#meet-the-fokker-planck-equation"><i class="fa fa-check"></i><b>27.1</b> Meet the Fokker-Planck equation<span></span></a></li>
<li class="chapter" data-level="27.2" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#deterministically-the-end"><i class="fa fa-check"></i><b>27.2</b> Deterministically the end<span></span></a></li>
<li class="chapter" data-level="27.3" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#exercises-26"><i class="fa fa-check"></i><b>27.3</b> Exercises<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Modeling with Data and Differential Equations Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mcmc-13" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Markov Chain Monte Carlo Parameter Estimation<a href="mcmc-13.html#mcmc-13" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We have explored likelihood functions, iterative methods, and the Metropolis-Hastings algorithm. In this chapter all these together introduce a sophisticated parameter estimation algorithm called Markov Chain Monte Carlo (MCMC) parameter estimation, which has a rich history <span class="citation">(<a href="#ref-richey_evolution_2010" role="doc-biblioref">Richey 2010</a>)</span>. MCMC methods can be highly computational; more importantly you already have the skills in place to understand <em>how</em> the MCMC method works. To do the heavy lifting we will rely on functions from the <code>demodelr</code> package. Let’s get started!</p>
<div id="the-recipe-for-mcmc" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> The recipe for MCMC<a href="mcmc-13.html#the-recipe-for-mcmc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The MCMC approach is a systematic exploration to determine the set of parameters that optimizes the value of the log-likehood function, given the data. It may be helpful to think of the MCMC method as a recipe, and in order to “run” the MCMC method, you will need four key ingredients:</p>
<ul>
<li><em>Model</em>: a function that we have for our dynamics (this is <span class="math inline">\(\displaystyle \frac{d\vec{y}}{dt} = f(\vec{y},\vec{\alpha},t)\)</span>), or an empirical equation <span class="math inline">\(\vec{y}=f(\vec{x},\vec{\alpha})\)</span>.</li>
<li><em>Data</em>: a data frame (<code>tibble</code>) or a spreadsheet file (to read into <code>R</code>) of the data you wish to use for parameter estimation.</li>
<li><em>Parameter bounds</em>: upper and lower bounds on your parameter values. We typically assume an initial uniform distribution on the parameters.</li>
<li><em>Initial conditions</em>: (optional) needed if your model is a differential equation.</li>
<li><em>Run diagnostics</em>: specifications for the MCMC code, which may include how long you will run the code and other aspects of the MCMC algorithm.</li>
</ul>
<p>We will work step by step through two examples of an application of the MCMC algorithm using both a differential equation and an empirical model. Example code is provided so you can also run your own estimates. The workflow that we will use is:</p>
<div style="page-break-after: always;"></div>
<blockquote>
<p>Define the model, parameters, and data <span class="math inline">\(\rightarrow\)</span> Determine MCMC settings <span class="math inline">\(\rightarrow\)</span> Compute MCMC estimate <span class="math inline">\(\rightarrow\)</span> Analyze results.</p>
</blockquote>
<p>Having an established workflow helps to breakdown the process step by step, making it easier to check for any coding errors.</p>
</div>
<div id="mcmc-parameter-estimation-with-an-empirical-model" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> MCMC parameter estimation with an empirical model<a href="mcmc-13.html#mcmc-parameter-estimation-with-an-empirical-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first step of our workflow is to “Define the model and parameters.” Here we return to the problem exploring of the phosphorous content in algae (denoted by <span class="math inline">\(x\)</span>) compared to the phosphorous content in daphnia (denoted by <span class="math inline">\(y\)</span>), and estimating <span class="math inline">\(c\)</span> and <span class="math inline">\(\theta\)</span> from Equation <a href="mcmc-13.html#eq:phos-13">(13.1)</a>.</p>
<p><span class="math display" id="eq:phos-13">\[\begin{equation}
y = c \cdot x^{1/\theta} \tag{13.1}
\end{equation}\]</span></p>
<p>The parameters <span class="math inline">\(c\)</span> and <span class="math inline">\(\theta\)</span> from Equation <a href="mcmc-13.html#eq:phos-13">(13.1)</a> range from <span class="math inline">\(0 \leq c \leq 2\)</span> and <span class="math inline">\(1 \leq \theta \leq 20\)</span>. To define the model we use similar code to how we defined models in Chapter <a href="linear-regression-08.html#linear-regression-08">8</a>. Then to define the parameters we will use a <code>tibble</code>, specifying the upper and lower bounds:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="mcmc-13.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 1: Define the model and parameters</span></span>
<span id="cb63-2"><a href="mcmc-13.html#cb63-2" aria-hidden="true" tabindex="-1"></a>phos_model <span class="ot">&lt;-</span> daphnia <span class="sc">~</span> c <span class="sc">*</span> algae<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> theta)</span>
<span id="cb63-3"><a href="mcmc-13.html#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="mcmc-13.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameters that you will use with their bounds</span></span>
<span id="cb63-5"><a href="mcmc-13.html#cb63-5" aria-hidden="true" tabindex="-1"></a>phos_param <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb63-6"><a href="mcmc-13.html#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;theta&quot;</span>),</span>
<span id="cb63-7"><a href="mcmc-13.html#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower_bound =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb63-8"><a href="mcmc-13.html#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper_bound =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">20</span>)</span>
<span id="cb63-9"><a href="mcmc-13.html#cb63-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Notice how we defined that <code>tibble</code> called <code>phos_param</code>, which has three columns: <code>name</code> which contains the name of the variables in our model (<code>c</code> and <code>theta</code>), the lower (<code>lower_bound</code>) and upper (<code>upper_bound</code>) for the parameters (listed in the same order as the parameters listed in <code>name</code>).</p>
<p>The data that we use is the dataset <code>phosphorous</code>, which is already located in the <code>demodelr</code> package).</p>
<p>The next two steps in our workflow (Determine MCMC settings <span class="math inline">\(\rightarrow\)</span> Compute MCMC estimate) are combined together below:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="mcmc-13.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 2: Determine MCMC settings</span></span>
<span id="cb64-2"><a href="mcmc-13.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of iterations</span></span>
<span id="cb64-3"><a href="mcmc-13.html#cb64-3" aria-hidden="true" tabindex="-1"></a>phos_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb64-4"><a href="mcmc-13.html#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="mcmc-13.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 3: Compute MCMC estimate</span></span>
<span id="cb64-6"><a href="mcmc-13.html#cb64-6" aria-hidden="true" tabindex="-1"></a>phos_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc_estimate</span>(</span>
<span id="cb64-7"><a href="mcmc-13.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> phos_model,</span>
<span id="cb64-8"><a href="mcmc-13.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> phosphorous,</span>
<span id="cb64-9"><a href="mcmc-13.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> phos_param,</span>
<span id="cb64-10"><a href="mcmc-13.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> phos_iter</span>
<span id="cb64-11"><a href="mcmc-13.html#cb64-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The variable <code>phos_iter</code> specifies how many iterations we will run of the MCMC method. Notice that <code>mcmc_estimate</code> has several inputs, which for convenience we write on separate lines. There are four required inputs to the function <code>mcmc_estimate</code> and several predefined inputs; you will explore these further in Exercise <a href="mcmc-13.html#exr:mcmc-input-13">13.3</a>.</p>
<p>The function <code>mcmc_estimate</code> may take some time (which is OK). But once it finishes a <code>tibble</code> is produced, which we call <code>phosphorous_mcmc</code> (run this code on your own):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mcmc-13.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(phos_mcmc)</span></code></pre></div>
<p>Notice <code>phos_mcmc</code> contains four columns:</p>
<ul>
<li><code>accept_flag</code> tells you if at that particular iteration the MCMC estimate was accepted or not. This is a categorical variable of <code>TRUE</code> or <code>FALSE</code></li>
<li><code>l_hood</code> is the value of the likelihood for that given iteration.</li>
<li>The values of the parameters follow on the next few lines. Notice that <span class="math inline">\(\theta\)</span> is written as <code>theta</code> in the resulting data frame.</li>
</ul>
<p>The final step of our workflow is to “Analyze results.” Fortunately the <code>demodelr</code> package has a function called <code>mcmc_analyze</code> to help you:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="mcmc-13.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 4: Analyze results:</span></span>
<span id="cb66-2"><a href="mcmc-13.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_analyze</span>(</span>
<span id="cb66-3"><a href="mcmc-13.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> phos_model,</span>
<span id="cb66-4"><a href="mcmc-13.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> phosphorous,</span>
<span id="cb66-5"><a href="mcmc-13.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mcmc_out =</span> phos_mcmc</span>
<span id="cb66-6"><a href="mcmc-13.html#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The function <code>mcmc_analyze</code> filters <code>phos_mcmc</code> whenever the variable <code>accept_flag</code> is <code>TRUE</code>. This function will compute parameter statistics (e.g. median and 95% confidence intervals) to be displayed at the console. In addition this function will generate two different types of graphs.<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a> Let’s examine each one individually. The first plot (Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a> is called a pairwise parameter plot, which is a collection of different plots together in a square matrix pattern, sized to the number of parameters that were estimated.</p>
<div class="figure" style="text-align: center"><span id="fig:phos-pp-13"></span>
<img src="figures/13-mcmc/histogram.png" alt="Pairwise parameter histogram from the MCMC parameter estimation with Equation \ref{eq:phos-13}." width="80%" />
<p class="caption">
FIGURE 13.1: Pairwise parameter histogram from the MCMC parameter estimation with Equation .
</p>
</div>
<p>Along the diagonal of Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a> is a histogram of the accepted parameter values from the Metropolis algorithm. Depending on the results that you obtain, you may have some interesting shaped histograms. Generally they are grouped in the following ways:</p>
<ul>
<li><em>well-constrained:</em> the parameter takes on a definite, well-defined value. The parameter <span class="math inline">\(c\)</span> seems to behave like this.</li>
<li><em>edge-hitting:</em> the parameter seems to cluster near the edges of its value.</li>
<li><em>non-informative:</em> the histogram looks like a uniform distribution. The parameter <span class="math inline">\(\theta\)</span> has some indications of being edge hitting, but we would need more iterations in order to confirm.</li>
</ul>
<p>The off-diagonal plots in Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a> are interesting as well. These plots are a scatter plot of the accepted values for the two parameters in the particular row and column, and the upper off-diagonal reports the correlation coefficient <span class="math inline">\(r\)</span> from simple linear regression of the variables in that particular row and column. The asterisks (<code>*</code>) denote the degree of significance of the linear correlation.</p>
<p>Examining the off-diagonal terms in Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a> helps ascertain the degree of <em>equifinality</em> in a particular set of variables <span class="citation">(<a href="#ref-beven_equifinality_2001" role="doc-biblioref">Beven and Freer 2001</a>)</span>. In Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a> it looks like as <em>c</em> increases, <span class="math inline">\(\theta\)</span> decreases. This degree of linear coupling means that we may not be able to independently resolve each parameter separately. Each model and parameter estimation is different, so be prepared to be surprised!</p>
<p>The presence of equifinality in a model does not mean the parameter estimation is a failure - just that we need to be aware of these relationships. Perhaps we may be able to go out in the field and measure a parameter (for example <span class="math inline">\(c\)</span>) more carefully, narrowing the range of accepted values.</p>
<p>The second figure that is produced from <code>mcmc_analyze</code> displays an <em>ensemble</em> estimate of the model results with the data (Figure <a href="mcmc-13.html#fig:phos-out-13">13.2</a>). The ensemble average plot provides a high-level model-data overview. Figure <a href="mcmc-13.html#fig:phos-out-13">13.2</a> is generated when the model (<code>phos_mcmc</code>) is run for each accepted parameter estimate in <code>phos_mcmc</code>. At each of the data points in Figure <a href="mcmc-13.html#fig:phos-out-13">13.2</a> a <a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">boxplot</a> is produced from the model runs. The median, and the 25th and 75th percentile make up the box. The whiskers extend no further than 1.5 of the difference between the 25th and 75th percentile. By eye, it seems that the model and estimated parameters fit the data, but there is still wide variation in the model predictions. Perhaps this variation is caused by relative wide confidence intervals on our parameters (Figure <a href="mcmc-13.html#fig:phos-pp-13">13.1</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:phos-out-13"></span>
<img src="figures/13-mcmc/output-plot.png" alt="Ensemble output results from the MCMC parameter estimation with Equation \ref{eq:phos-13}." width="80%" />
<p class="caption">
FIGURE 13.2: Ensemble output results from the MCMC parameter estimation with Equation .
</p>
</div>
</div>
<div id="mcmc-parameter-estimation-with-a-differential-equation-model" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> MCMC parameter estimation with a differential equation model<a href="mcmc-13.html#mcmc-parameter-estimation-with-a-differential-equation-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next let’s try parameter estimation with a differential equation model. Here the measured data are solutions to a differential equation, which contains unknown parameters. Once the MCMC method proposes a parameter, then the differential equation needs to be solved numerically with Euler’s or a Runge-Kutta method before evaluating the likelihood function.<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a></p>
<p>The example that we are going to use relates to land use management, in particular a coupled system between a resource (such as a national park) and the number of visitors it receives <span class="citation">(<a href="#ref-sinay_simple_2006" role="doc-biblioref">Sinay and Sinay 2006</a>)</span>. The tourism model relies on two nondimensional scaled variables, <span class="math inline">\(R\)</span> which is the amount of the resource (as a percentage) and <span class="math inline">\(V\)</span> the percentage of visitors that could visit (also as a percentage):</p>
<p><span class="math display" id="eq:tourism-13">\[\begin{equation}
\begin{split}
\frac{dR}{dt}&amp;=R\cdot (1-R)-aV \\ 
\frac{dV}{dt}&amp;=b\cdot V \cdot (R-V)
\end{split} \tag{13.2}
\end{equation}\]</span></p>
<p>Equation <a href="mcmc-13.html#eq:tourism-13">(13.2)</a> has two parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, which relate to how the resource is used up as visitors come (<span class="math inline">\(a\)</span>) and how as the visitors increase, word of mouth leads to a negative effect of it being too crowded (<span class="math inline">\(b\)</span>).</p>
<p>For this case we are going to use a pre-defined dataset of the number of resources and visitors to a national park as reported in <span class="citation"><a href="#ref-sinay_simple_2006" role="doc-biblioref">Sinay and Sinay</a> (<a href="#ref-sinay_simple_2006" role="doc-biblioref">2006</a>)</span> (this is the <code>parks</code> dataset in the <code>demodelr</code> package) which is plotted in Figure <a href="mcmc-13.html#fig:park-data-13">13.3</a>.</p>
<div class="figure"><span id="fig:park-data-13"></span>
<img src="explore-model-zobitz-220419_files/figure-html/park-data-13-1.png" alt="Scaled data on resources and visitors to a national park over time." width="672" />
<p class="caption">
FIGURE 13.3: Scaled data on resources and visitors to a national park over time.
</p>
</div>
<p>As the visitors <span class="math inline">\(V\)</span> increase in Figure <a href="mcmc-13.html#fig:park-data-13">13.3</a>, the percentage of the resources <span class="math inline">\(R\)</span> decreases. Notably though, the data on both variables may be limited. In Figure <a href="mcmc-13.html#fig:park-data-13">13.3</a> the proportion of visitors ranges from 0.9 to 1, and the resources ranges up to 0.03. Perhaps from this limited dataset given we can estimate the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and then forecast out as time increases. We will estimate the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> in Equation <a href="mcmc-13.html#eq:tourism-13">(13.2)</a> with the data shown in Figure <a href="mcmc-13.html#fig:park-data-13">13.3</a>. We are going to assume that <span class="math inline">\(0 \leq a \leq 30\)</span> and <span class="math inline">\(0 \leq b \leq 5\)</span>. We will still use the same workflow (Define the model, parameters, and data <span class="math inline">\(\rightarrow\)</span> Determine MCMC settings <span class="math inline">\(\rightarrow\)</span> Compute MCMC estimate <span class="math inline">\(\rightarrow\)</span> Analyze results) as we did in estimating parameters for an empirical model. Since this workflow was presented earlier we will combine the first three steps below:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="mcmc-13.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 1: Define the model, parameters, and data</span></span>
<span id="cb67-2"><a href="mcmc-13.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the tourism model</span></span>
<span id="cb67-3"><a href="mcmc-13.html#cb67-3" aria-hidden="true" tabindex="-1"></a>tourism_model <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb67-4"><a href="mcmc-13.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  dRdt <span class="sc">~</span> resources <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> resources) <span class="sc">-</span> a <span class="sc">*</span> visitors,</span>
<span id="cb67-5"><a href="mcmc-13.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  dVdt <span class="sc">~</span> b <span class="sc">*</span> visitors <span class="sc">*</span> (resources <span class="sc">-</span> visitors)</span>
<span id="cb67-6"><a href="mcmc-13.html#cb67-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-7"><a href="mcmc-13.html#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="mcmc-13.html#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameters that you will use with their bounds</span></span>
<span id="cb67-9"><a href="mcmc-13.html#cb67-9" aria-hidden="true" tabindex="-1"></a>tourism_param <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-10"><a href="mcmc-13.html#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb67-11"><a href="mcmc-13.html#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower_bound =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">0</span>),</span>
<span id="cb67-12"><a href="mcmc-13.html#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper_bound =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">5</span>)</span>
<span id="cb67-13"><a href="mcmc-13.html#cb67-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-14"><a href="mcmc-13.html#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="mcmc-13.html#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 2: Determine MCMC settings</span></span>
<span id="cb67-16"><a href="mcmc-13.html#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the initial conditions</span></span>
<span id="cb67-17"><a href="mcmc-13.html#cb67-17" aria-hidden="true" tabindex="-1"></a>tourism_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">resources =</span> <span class="fl">0.995</span>, <span class="at">visitors =</span> <span class="fl">0.00167</span>)</span>
<span id="cb67-18"><a href="mcmc-13.html#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="mcmc-13.html#cb67-19" aria-hidden="true" tabindex="-1"></a>deltaT <span class="ot">&lt;-</span> .<span class="dv">1</span> <span class="co"># timestep length</span></span>
<span id="cb67-20"><a href="mcmc-13.html#cb67-20" aria-hidden="true" tabindex="-1"></a>n_steps <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># must be a number greater than 1</span></span>
<span id="cb67-21"><a href="mcmc-13.html#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="mcmc-13.html#cb67-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of iterations</span></span>
<span id="cb67-23"><a href="mcmc-13.html#cb67-23" aria-hidden="true" tabindex="-1"></a>tourism_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb67-24"><a href="mcmc-13.html#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="mcmc-13.html#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 3: Compute MCMC estimate</span></span>
<span id="cb67-26"><a href="mcmc-13.html#cb67-26" aria-hidden="true" tabindex="-1"></a>tourism_out <span class="ot">&lt;-</span> <span class="fu">mcmc_estimate</span>(</span>
<span id="cb67-27"><a href="mcmc-13.html#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> tourism_model,</span>
<span id="cb67-28"><a href="mcmc-13.html#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> parks,</span>
<span id="cb67-29"><a href="mcmc-13.html#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> tourism_param,</span>
<span id="cb67-30"><a href="mcmc-13.html#cb67-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;de&quot;</span>,</span>
<span id="cb67-31"><a href="mcmc-13.html#cb67-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> tourism_init,</span>
<span id="cb67-32"><a href="mcmc-13.html#cb67-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaT =</span> deltaT,</span>
<span id="cb67-33"><a href="mcmc-13.html#cb67-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_steps =</span> n_steps,</span>
<span id="cb67-34"><a href="mcmc-13.html#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> tourism_iter</span>
<span id="cb67-35"><a href="mcmc-13.html#cb67-35" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Notice how <code>mcmc_estimate</code> has some additional arguments. Most important is the option <code>mode "de"</code>, where <code>de</code> stands for <em>differential equation</em>. (The default mode is <code>emp</code>, or <em>empirical</em> model - like the <code>phosphorous</code> data set.) If the <code>de</code> mode is specified, then you also need to define the initial conditions (<code>tourism_init</code>), <span class="math inline">\(\Delta t\)</span> (<code>deltaT</code>), and timesteps (<code>n_steps</code>) in order to generate the numerical solution.</p>
<p>Visualizing the data also is done with <code>mcmc_analyze</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="mcmc-13.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 4: Analyze results</span></span>
<span id="cb68-2"><a href="mcmc-13.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_analyze</span>(</span>
<span id="cb68-3"><a href="mcmc-13.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> tourism_model,</span>
<span id="cb68-4"><a href="mcmc-13.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> parks,</span>
<span id="cb68-5"><a href="mcmc-13.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mcmc_out =</span> tourism_out,</span>
<span id="cb68-6"><a href="mcmc-13.html#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;de&quot;</span>,</span>
<span id="cb68-7"><a href="mcmc-13.html#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_condition =</span> tourism_init,</span>
<span id="cb68-8"><a href="mcmc-13.html#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">deltaT =</span> deltaT,</span>
<span id="cb68-9"><a href="mcmc-13.html#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_steps =</span> n_steps</span>
<span id="cb68-10"><a href="mcmc-13.html#cb68-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Examining the parameter histograms (Figure <a href="mcmc-13.html#fig:tourism-pp-13">13.4</a>) shows <span class="math inline">\(b\)</span> to be well-constrained. The histogram for <span class="math inline">\(a\)</span> seems like it could be well-constrained - but we may need to run more iterations to confirm this.</p>
<div class="figure" style="text-align: center"><span id="fig:tourism-pp-13"></span>
<img src="figures/13-mcmc/histogram-tourism.png" alt="Pairwise parameter histogram of MCMC parameter estimation results with Equation \ref{eq:tourism-13}." width="70%" />
<p class="caption">
FIGURE 13.4: Pairwise parameter histogram of MCMC parameter estimation results with Equation .
</p>
</div>
<p>The model results and confidence intervals show good agreement to the data (Figure <a href="mcmc-13.html#fig:tourism-out-13">13.5</a>). Additionally the model forecasts out in time confirming that as visitors increase, the resources in the national park will decrease due to overuse. In contrast to Figure <a href="mcmc-13.html#fig:phos-out-13">13.2</a>, the black line in Figure <a href="mcmc-13.html#fig:tourism-out-13">13.5</a> represents the median and the grey shading is the 95% confidence interval for all timesteps defined in solving the model.</p>
<div class="figure" style="text-align: center"><span id="fig:tourism-out-13"></span>
<img src="figures/13-mcmc/output-tourism.png" alt="Ensemble output results from the MCMC parameter estimation for Equation \ref{eq:tourism-13}." width="80%" />
<p class="caption">
FIGURE 13.5: Ensemble output results from the MCMC parameter estimation for Equation .
</p>
</div>
</div>
<div id="timing-your-code" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Timing your code<a href="mcmc-13.html#timing-your-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you can imagine the more iterations we have the better our parameter estimates will be. However, this means the full estimate with that number of iterations will take some more time. Before doing that, you first should get an estimate for the length of time it takes to run this code. Fortunately <code>R</code> has a stopwatch function. Let’s check this out with one iteration of the phosphorous dataset:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="mcmc-13.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This &quot;starts&quot; the stopwatch</span></span>
<span id="cb69-2"><a href="mcmc-13.html#cb69-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb69-3"><a href="mcmc-13.html#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="mcmc-13.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute a single mcmc estimate</span></span>
<span id="cb69-5"><a href="mcmc-13.html#cb69-5" aria-hidden="true" tabindex="-1"></a>phosphorous1_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc_estimate</span>(</span>
<span id="cb69-6"><a href="mcmc-13.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> phos_model,</span>
<span id="cb69-7"><a href="mcmc-13.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> phosphorous,</span>
<span id="cb69-8"><a href="mcmc-13.html#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> phos_param,</span>
<span id="cb69-9"><a href="mcmc-13.html#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">1</span></span>
<span id="cb69-10"><a href="mcmc-13.html#cb69-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-11"><a href="mcmc-13.html#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="mcmc-13.html#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># End the stopwatch</span></span>
<span id="cb69-13"><a href="mcmc-13.html#cb69-13" aria-hidden="true" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb69-14"><a href="mcmc-13.html#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="mcmc-13.html#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the difference between the start and end times</span></span>
<span id="cb69-16"><a href="mcmc-13.html#cb69-16" aria-hidden="true" tabindex="-1"></a>end_time <span class="sc">-</span> start_time</span></code></pre></div>
<pre><code>## Time difference of 0.224685 secs</code></pre>
<p>Timing the code for one iteration gives you a ballpark estimate for a full MCMC parameter estimate. If we were to run <em>N</em> MCMC iterations, a good benchmark would be to multiply the time difference (<code>end_time - start_time</code>) by <em>N</em>. Performance time varies by computer and the other programs / apps that are running at the same time. However, this gives you an estimate of what to expect.<a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a></p>
</div>
<div id="further-extensions-to-mcmc" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Further extensions to MCMC<a href="mcmc-13.html#further-extensions-to-mcmc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the examples in this chapter we limited the number of iterations to a smaller number to make the results computationally feasible. However we can extend the MCMC approach in two notable ways:</p>
<ul>
<li><p>One approach is to separate the data into two different sets - one for optimization and one for validation. In this approach the “optimization data” consists of a certain percentage of the original dataset, leaving the remaining to validate the forward forecasts. This is a type of cross-validation approach, and is generally preferred because you are demonstrating the strength of your model ability against non-optimized data.</p></li>
<li><p>We also run multiple “chains” of optimization, starting from a different value in parameter space. What we do then after running each of these chains is to select the one with the best log-likelihood value, and run <em>another</em> MCMC iteration starting at that value. The idea is with a different chain we have sampled the parameter space and are hopefully starting near an optimum value.</p></li>
</ul>
<p>As you can see, the MCMC algorithm is an extremely powerful technique for parameter estimation. While MCMC may take additional time and programming skill to analyze - it is definitely worth it!</p>
</div>
<div id="exercises-12" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Exercises<a href="mcmc-13.html#exercises-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="exercise">
<span id="exr:unnamed-chunk-172" class="exercise"><strong>Exercise 13.1  </strong></span>Re-run both of the MCMC examples in this chapter, but increase the number of iterations to <span class="math inline">\(10,000\)</span>. Analyze your results from both cases. How does increasing the number of iterations affect the posterior parameter estimates and their confidence intervals? Does the log-likelihood value change?
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-173" class="exercise"><strong>Exercise 13.2  </strong></span>Time the MCMC parameter estimate for the <code>phosphorous</code> dataset for <span class="math inline">\(1\)</span> iteration. Then time the MCMC parameter estimate for <span class="math inline">\(10\)</span>, <span class="math inline">\(100\)</span>, and <span class="math inline">\(1000\)</span> iterations, recording the times for each one. Make a scatterplot with the number of iterations on the horizontal axis and time on the vertical axis. How would you characterize the relationship between the number of iterations and the time it takes to run the code? How long would it take to compute an MCMC estimate with <span class="math inline">\(10,000\)</span> iterations?
</div>

<div class="exercise">
<span id="exr:mcmc-input-13" class="exercise"><strong>Exercise 13.3  </strong></span>The function <code>mcmc_estimate</code> has several other input variables that are set to default values. What are they and how would you explain their use? (<em>Hint:</em> to see the documentation associated with this function type <code>?mcmc_estimate</code> at the <code>R</code> console.)
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-174" class="exercise"><strong>Exercise 13.4  </strong></span>For the <code>parks</code> data (Equation (13.2)) studied in this chapter, compare the 1:1 and the posterior parameter plots (Figure <a href="mcmc-13.html#fig:tourism-pp-13">13.4</a>). Write a summary of each panel of the plot. Apply your understanding of equifinality and other observations to determine by how much you have estimated the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> from the data.</p>
</div>

<div class="exercise">
<p><span id="exr:yeast-v1-13" class="exercise"><strong>Exercise 13.5  </strong></span>Run an MCMC parameter estimation on the dataset <code>yeast</code> from <span class="citation"><a href="#ref-gause_experimental_1932" role="doc-biblioref">Gause</a> (<a href="#ref-gause_experimental_1932" role="doc-biblioref">1932</a>)</span>, where the equation for the volume of yeast <span class="math inline">\(V\)</span> over time is given by the following equation for a yeast growing in isolation:</p>
<p><span class="math display">\[\begin{equation}
V = \frac{K}{1+e^{a-bt}},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(K\)</span> is the carrying capacity, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> respective rate constants.</p>
<ol style="list-style-type: lower-alpha">
<li>Show that when <span class="math inline">\(V(0)=0.45\)</span>, <span class="math inline">\(a = \ln(K/0.45-1)\)</span>.</li>
<li>Rewrite the <span class="math inline">\(V(t)\)</span> equation without <span class="math inline">\(a\)</span>.</li>
<li>With the <code>yeast</code> data, perform an MCMC estimate for this equation. (<em>Reminder:</em> <span class="math inline">\(\ln(5)\)</span>) is implemented as <code>log(5)</code> in <code>R</code>.)</li>
</ol>
<p>Use the following settings for your MCMC parameter estimation:</p>
<ul>
<li><span class="math inline">\(K:\)</span> 1 to 20</li>
<li><span class="math inline">\(b\)</span>: 0 to 1</li>
<li>1000 iterations</li>
</ul>
<p>When setting up the MCMC method, be sure to name the variables in your model to match the <code>yeast</code> data frame.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Report all outputs from the MCMC estimation (this includes parameter estimates, confidence intervals, log-likelihood values, and any graphs). Compare your results to the results from Exercise <a href="mcmc-13.html#exr:yeast-v2-13">13.6</a>.</li>
</ol>
</div>

<div class="exercise">
<p><span id="exr:yeast-v2-13" class="exercise"><strong>Exercise 13.6  </strong></span>Another model for this growth of yeast is the function <span class="math inline">\(\displaystyle V= K + Ae^{-bt}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Show that when <span class="math inline">\(V(0)=0.45\)</span>, <span class="math inline">\(A = K - 0.45\)</span>.</li>
<li>Rewrite the initial equation without <span class="math inline">\(A\)</span>.</li>
<li>With the <code>yeast</code> data, apply an MCMC estimate for this equation.</li>
</ol>
<p>Use the following settings for your MCMC parameter estimation:</p>
<ul>
<li><span class="math inline">\(K:\)</span> 1 to 20</li>
<li><span class="math inline">\(b\)</span>: 0 to 1</li>
<li>1000 iterations</li>
</ul>
<p>When setting up the MCMC method, be sure to name the variables in your model to match the <code>yeast</code> data frame.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Report all outputs from the MCMC estimation (this includes parameter estimates, confidence intervals, log-likelihood values, and any graphs). Compare your results to the results from Exercise <a href="mcmc-13.html#exr:yeast-v1-13">13.5</a>.</li>
</ol>
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-175" class="exercise"><strong>Exercise 13.7  </strong></span>Run an MCMC parameter estimation on the dataset <code>wilson</code> according to the following differential equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{dP}{dt} = b(N-P),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(P\)</span> represents the mass of the dog. Use the following settings for your MCMC parameter estimation:</p>
<ul>
<li><span class="math inline">\(N\)</span>: 60 to 90</li>
<li><span class="math inline">\(b\)</span>: 0 to .01</li>
<li><span class="math inline">\(P(0)=5\)</span></li>
<li><span class="math inline">\(\Delta t = 1\)</span> day</li>
<li>Number of timesteps: 1500</li>
<li>Number of iterations: 1000</li>
</ul>
<p>When setting up the MCMC method, be sure to name the variables in your model to match the <code>wilson</code> data frame. Be sure to report all outputs from the MCMC estimation (this includes parameter estimates, confidence intervals, log-likelihood values, and any graphs).</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-beven_equifinality_2001" class="csl-entry">
Beven, Keith, and Jim Freer. 2001. <span>“Equifinality, Data Assimilation, and Uncertainty Estimation in Mechanistic Modelling of Complex Environmental Systems Using the <span>GLUE</span> Methodology.”</span> <em>Journal of Hydrology</em> 249 (1-4): 11–29. <a href="https://doi.org/10.1016/S0022-1694(01)00421-8">https://doi.org/10.1016/S0022-1694(01)00421-8</a>.
</div>
<div id="ref-gause_experimental_1932" class="csl-entry">
Gause, G. F. 1932. <span>“Experimental <span>Studies</span> on the <span>Struggle</span> for <span>Existence</span>: <span>I</span>. <span>Mixed Population</span> of <span>Two Species</span> of <span>Yeast</span>.”</span> <em>Journal of Experimental Biology</em> 9 (4): 389–402.
</div>
<div id="ref-richey_evolution_2010" class="csl-entry">
Richey, Matthew. 2010. <span>“The Evolution of <span>Markov</span> Chain <span>Monte Carlo</span> Methods.”</span> <em>The American Mathematical Monthly</em> 117 (5): 383–413.
</div>
<div id="ref-sinay_simple_2006" class="csl-entry">
Sinay, Laura, and Leon Sinay. 2006. <span>“A <span>Simple Mathematical Model</span> for the <span>Effects</span> of the <span>Growth</span> of <span>Tourism</span> on <span>Environment</span>.”</span> In <em>New <span>Perspectives</span> and <span>Values</span> in <span>World Tourism</span> and <span>Tourism Management</span> in the <span>Future</span>, 20-26 <span>November</span>, 2006</em>. <span>Alanya, Turkey</span>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="32">
<li id="fn32"><p>To see each graph, you can click the left arrow button on the Plots tab in the lower right hand pane of the RStudio window.<a href="mcmc-13.html#fnref32" class="footnote-back">↩︎</a></p></li>
<li id="fn33"><p>If we knew the function that solves the differential equation, then we would have an empirical model.<a href="mcmc-13.html#fnref33" class="footnote-back">↩︎</a></p></li>
<li id="fn34"><p>I am a big fan of “set it and forget it” - meaning I set up the code before I go to sleep and it is ready in the morning!<a href="mcmc-13.html#fnref34" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metropolis-12.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="information-criteria-14.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/13-mcmc.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/13-mcmc.Rmd",
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
