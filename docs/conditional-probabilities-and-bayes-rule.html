<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Conditional Probabilities and Bayes’ Rule | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Conditional Probabilities and Bayes’ Rule | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Conditional Probabilities and Bayes’ Rule | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="extending-the-cost-function.html"/>
<link rel="next" href="bayes-rule-and-linear-regression.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>2</b> Cost Functions &amp; Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cost-functions-likelihood-functions-in-disguise.html"><a href="cost-functions-likelihood-functions-in-disguise.html"><i class="fa fa-check"></i><b>2.1</b> Cost functions: likelihood functions in disguise</a></li>
<li class="chapter" data-level="2.2" data-path="connection-to-likelihood-functions.html"><a href="connection-to-likelihood-functions.html"><i class="fa fa-check"></i><b>2.2</b> Connection to likelihood functions</a></li>
<li class="chapter" data-level="2.3" data-path="extending-the-cost-function.html"><a href="extending-the-cost-function.html"><i class="fa fa-check"></i><b>2.3</b> Extending the cost function</a></li>
<li class="chapter" data-level="2.4" data-path="conditional-probabilities-and-bayes-rule.html"><a href="conditional-probabilities-and-bayes-rule.html"><i class="fa fa-check"></i><b>2.4</b> Conditional Probabilities and Bayes’ Rule</a></li>
<li class="chapter" data-level="2.5" data-path="bayes-rule-and-linear-regression.html"><a href="bayes-rule-and-linear-regression.html"><i class="fa fa-check"></i><b>2.5</b> Bayes’ Rule and Linear Regression</a></li>
<li class="chapter" data-level="2.6" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditional-probabilities-and-bayes-rule" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Conditional Probabilities and Bayes’ Rule</h2>
<!-- Adapted from Silver, *The Signal and the Noise*, 2012. -->
<p>In order to understand Bayesian statistics we first need to understand Bayes’ rule and conditional probability. So let’s look at an example.</p>

<div class="example">
<p><span id="exm:president-pop" class="example"><strong>Example 2.1  </strong></span>The following table shows results from a survey of people’s views on the economy and whether or not they voted for the President in the last election. Percentages are reported as decimals.</p>
<table>
<thead>
<tr class="header">
<th align="center">Probability</th>
<th align="center">Optimistic view on economy</th>
<th align="left">Pessimistic view on economy</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Voted for the president</td>
<td align="center">0.20</td>
<td align="left">0.20</td>
<td align="left">0.40</td>
</tr>
<tr class="even">
<td align="center">Did not vote for president</td>
<td align="center">0.15</td>
<td align="left">0.45</td>
<td align="left">0.60</td>
</tr>
<tr class="odd">
<td align="center">Total</td>
<td align="center">0.35</td>
<td align="left">0.65</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
Compute the probability of having an optimistic view on the economy.
</div>

<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> Probability tables are a clever way to organize information with conditional probability. We define the following probabilities:</p>
<ul>
<li>The probability you voted for the President <em>and</em> have an <strong>optimistic</strong> view on the economy is 0.20</li>
<li>The probability you <strong>did not</strong> vote for the President <em>and</em> have an <strong>optimistic</strong> view on the economy is 0.15</li>
<li>The probability you voted for the President <em>and</em> have an <strong>pessimistic</strong> view on the economy is 0.20</li>
<li>The probability you <strong>did not</strong> vote for the President <em>and</em> have an <strong>pessimistic</strong> view on the economy is 0.45</li>
</ul>
<p>We calculate the probability of having an <strong>Optimistic view on the economy</strong> by adding the probabilities with an optimistic view, whether or not they voted for the president. For this example, this probability sums to 0.20 + 0.15 = 0.35. On the other hand, the probability you have a pessimistic view on the economy is 0.20 + 0.45 = 0.65. Notice how the two of these together (probability of optimistic and pessimistic views of the economy is 1, or 100% of the outcomes.)</p>
</div>
<div id="conditional-probabilities" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Conditional probabilities</h3>
<p>A conditional probability is the probability of an outcome given some previous outcome, or <span class="math inline">\(\mbox{Pr} (A | B)\)</span>, where Pr means “probability of an outcome” and <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are two different outcomes or events. In probability theory you might study the following law of conditional probability:</p>
<p><span class="math display" id="eq:law-cond-prop">\[\begin{equation}
\begin{split}\tag{2.1}
\mbox{Pr}(A \mbox { and } B) &amp;= \mbox{Pr} (A \mbox{ given } B) \cdot  \mbox{Pr}(B) \\
 &amp;= \mbox{Pr} (A | B) \cdot  \mbox{Pr}(B) \\
  &amp;= \mbox{Pr} (B | A) \cdot  \mbox{Pr}(A)
\end{split}
\end{equation}\]</span></p>
<p>Typically in the conditional probability equation we remove “and” and write <span class="math inline">\(P(A \mbox{ and } B) = P(AB)\)</span> and “given” as <span class="math inline">\(P(A \mbox{ given } B) = P(A|B)\)</span>.</p>

<div class="example">
<span id="exm:unnamed-chunk-4" class="example"><strong>Example 2.2  </strong></span>Sometimes people believe that your views of the economy <a href="https://www.cbsnews.com/news/how-much-impact-can-a-president-have-on-the-economy/">influence if you are going to vote for the President</a>, so use the information from the table in Example <a href="conditional-probabilities-and-bayes-rule.html#exm:president-pop">2.1</a> to compute the probability you voted for the president <em>given</em> you have an optimistic view of the economy.
</div>

<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> To compute the probability you voted for the president <em>given</em> you have an optimistic view of the economy is a rearrangement of Equation <a href="conditional-probabilities-and-bayes-rule.html#eq:law-cond-prop">(2.1)</a>:</p>
<p><span class="math display" id="eq:econ-cond-prop">\[\begin{equation}
\begin{split}\tag{2.2}
\mbox{Pr(Voted for President | Optimistic View on Economy)} = \\
\frac{\mbox{Pr(Voted for President and Optimistic View on Economy)}}{\mbox{Pr(Optimistic View on Economy)}} = \\
\frac{0.20}{0.35} = 0.57
\end{split}
\end{equation}\]</span></p>
</div>
<p>So the probability you compute in Equation <a href="conditional-probabilities-and-bayes-rule.html#eq:econ-cond-prop">(2.2)</a> seems telling. Contrast this percentage to that of the probability you voted for the President, which is 0.4. Perhaps your view of the economy does indeed influences whether or not you would vote to re-elect the President.</p>
</div>
<div id="bayes-rule-application-of-conditional-probabilities" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Bayes’ Rule: Application of Conditional Probabilities</h3>
<p>How could we systematically incorporate prior information into a parameter estimation problem? We are going to introduce <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem"><em>Bayes’ Rule</em></a>, which is a rearrangment of the rule for conditional probability:</p>
<p><span class="math display">\[\begin{equation}
\mbox{Pr} (A | B) = \frac{ \mbox{Pr} (B | A) \cdot  \mbox{Pr}(A)}{\mbox{Pr}(B) }
\end{equation}\]</span></p>
<p>It turns out Bayes’ Rule is a really helpful way to understand how we can systematically incorporate this prior information into the likelihood function (and by association the cost function). For data assimilation problems our goal is to estimate parameters, given data. So we can think of Bayes’ rule in terms of parameters and data:</p>
<p><span class="math display">\[\begin{equation}
\mbox{Pr}( \mbox{ parameters } | \mbox{ data }) = \frac{\mbox{Pr}( \mbox{ data } | \mbox{ parameters }) \cdot \mbox{ Pr}( \mbox{ parameters }) }{\mbox{Pr}(\mbox{ data }) }.
\end{equation}\]</span></p>
<p>Here are a few observations from that last equation:</p>
<ul>
<li>The term <span class="math inline">\(\mbox{Pr}( \mbox{ data } | \mbox{ parameters })\)</span> is similar to the model data residual, or the standard likelihood function.</li>
<li>If we think of the term <span class="math inline">\(\mbox{Pr}( \mbox{ parameters })\)</span>, then prior information is a multiplicative effect on the likelihood function - this is good news! You will demonstrate in the homework that the log likelihood is related to the cost function - so when we added that additional term to form <span class="math inline">\(\tilde{S}(b)\)</span>, we accounted for the prior information correctly.</li>
<li>The expression <span class="math inline">\(\mbox{Pr}( \mbox{ parameters } | \mbox{ data })\)</span> is the start of a framework for a probability density function, which should integrate to unity. (You will explore this more if you study probability theory.) In many cases we select parameters that optimize a likelihood or cost function. So the expression in the denominator (<span class="math inline">\(\mbox{Pr}(\mbox{ data })\)</span> ) does not change the <em>location</em> of the optimum values. And in fact, many people consider the denominator term to be a <a href="https://stats.stackexchange.com/questions/12112/normalizing-constant-in-bayes-theorem">normalizing constant</a>.</li>
</ul>
<p>In the following sections we will explore Bayes’ Rule in action and how to utilize it for different types of cost functions, but wow - we made some significant progress in our conceptual understanding of how to incorporate models and data.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="extending-the-cost-function.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayes-rule-and-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/10-costFunctions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/10-costFunctions.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
