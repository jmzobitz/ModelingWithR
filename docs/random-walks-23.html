<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Random Walks | Exploring Modeling with Data and Differential Equations Using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Random Walks | Exploring Modeling with Data and Differential Equations Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Random Walks | Exploring Modeling with Data and Differential Equations Using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stoch-sim-22.html"/>
<link rel="next" href="diffusion-24.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li><a href="index.html#welcome">Welcome<span></span></a>
<ul>
<li><a href="index.html#computational-code">Computational code<span></span></a></li>
<li><a href="index.html#questions-comments-issues">Questions? Comments? Issues?<span></span></a></li>
<li><a href="index.html#about-the-cover">About the cover<span></span></a></li>
<li><a href="index.html#acknowledgments">Acknowledgments<span></span></a></li>
</ul></li>
<li class="part"><span><b>I Models with Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="1" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>1</b> Models of Rates with Data<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-01.html"><a href="intro-01.html#rates-of-change-in-the-world-a-model-is-born"><i class="fa fa-check"></i><b>1.1</b> Rates of change in the world: a model is born<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="intro-01.html"><a href="intro-01.html#modeling-in-context-the-spread-of-a-disease"><i class="fa fa-check"></i><b>1.2</b> Modeling in context: the spread of a disease<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="intro-01.html"><a href="intro-01.html#model-solutions"><i class="fa fa-check"></i><b>1.3</b> Model solutions<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="intro-01.html"><a href="intro-01.html#which-model-is-best"><i class="fa fa-check"></i><b>1.4</b> Which model is best?<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="intro-01.html"><a href="intro-01.html#start-here"><i class="fa fa-check"></i><b>1.5</b> Start here<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="intro-01.html"><a href="intro-01.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-intro-02.html"><a href="r-intro-02.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> <code>R</code> and RStudio<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="r-intro-02.html"><a href="r-intro-02.html#first-steps-getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.2</b> First steps: getting acquainted with <code>R</code><span></span></a></li>
<li class="chapter" data-level="2.3" data-path="r-intro-02.html"><a href="r-intro-02.html#increasing-functionality-with-packages"><i class="fa fa-check"></i><b>2.3</b> Increasing functionality with packages<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="r-intro-02.html"><a href="r-intro-02.html#working-with-r-variables-data-frames-and-datasets"><i class="fa fa-check"></i><b>2.4</b> Working with <code>R</code>: variables, data frames, and datasets<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="r-intro-02.html"><a href="r-intro-02.html#visualization-with-r"><i class="fa fa-check"></i><b>2.5</b> Visualization with <code>R</code><span></span></a></li>
<li class="chapter" data-level="2.6" data-path="r-intro-02.html"><a href="r-intro-02.html#defining-functions"><i class="fa fa-check"></i><b>2.6</b> Defining functions<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="r-intro-02.html"><a href="r-intro-02.html#concluding-thoughts"><i class="fa fa-check"></i><b>2.7</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="2.8" data-path="r-intro-02.html"><a href="r-intro-02.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>3</b> Modeling with Rates of Change<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#competing-plant-species-and-equilibrium-solutions"><i class="fa fa-check"></i><b>3.1</b> Competing plant species and equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#the-law-of-mass-action"><i class="fa fa-check"></i><b>3.2</b> The Law of Mass Action<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#coupled-differential-equations-lynx-and-hares"><i class="fa fa-check"></i><b>3.3</b> Coupled differential equations: lynx and hares<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#functional-responses"><i class="fa fa-check"></i><b>3.4</b> Functional responses<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>4</b> Euler’s Method<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="euler-04.html"><a href="euler-04.html#the-flu-and-locally-linear-approximation"><i class="fa fa-check"></i><b>4.1</b> The flu and locally linear approximation<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="euler-04.html"><a href="euler-04.html#a-workflow-for-approximation"><i class="fa fa-check"></i><b>4.2</b> A workflow for approximation<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="euler-04.html"><a href="euler-04.html#building-an-iterative-method"><i class="fa fa-check"></i><b>4.3</b> Building an iterative method<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="euler-04.html"><a href="euler-04.html#eulers-method-and-beyond"><i class="fa fa-check"></i><b>4.4</b> Euler’s method and beyond<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="euler-04.html"><a href="euler-04.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>5</b> Phase Lines and Equilibrium Solutions<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="phase-05.html"><a href="phase-05.html#equilibrium-solutions"><i class="fa fa-check"></i><b>5.1</b> Equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="phase-05.html"><a href="phase-05.html#phase-lines-for-differential-equations"><i class="fa fa-check"></i><b>5.2</b> Phase lines for differential equations<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="phase-05.html"><a href="phase-05.html#a-stability-test-for-equilibrium-solutions"><i class="fa fa-check"></i><b>5.3</b> A stability test for equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="phase-05.html"><a href="phase-05.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>6</b> Coupled Systems of Equations<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="coupled-06.html"><a href="coupled-06.html#flu-with-quarantine-and-equilibrium-solutions"><i class="fa fa-check"></i><b>6.1</b> Flu with quarantine and equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="coupled-06.html"><a href="coupled-06.html#nullclines"><i class="fa fa-check"></i><b>6.2</b> Nullclines<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="coupled-06.html"><a href="coupled-06.html#phase-planes"><i class="fa fa-check"></i><b>6.3</b> Phase planes<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="coupled-06.html"><a href="coupled-06.html#generating-a-phase-plane-in-r"><i class="fa fa-check"></i><b>6.4</b> Generating a phase plane in <code>R</code><span></span></a></li>
<li class="chapter" data-level="6.5" data-path="coupled-06.html"><a href="coupled-06.html#slope-fields"><i class="fa fa-check"></i><b>6.5</b> Slope fields<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="coupled-06.html"><a href="coupled-06.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>7</b> Exact Solutions to Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-a-solution"><i class="fa fa-check"></i><b>7.1</b> Verify a solution<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="exact-solns-07.html"><a href="exact-solns-07.html#separable-differential-equations"><i class="fa fa-check"></i><b>7.2</b> Separable differential equations<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="exact-solns-07.html"><a href="exact-solns-07.html#integrating-factors"><i class="fa fa-check"></i><b>7.3</b> Integrating factors<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-broad-07"><i class="fa fa-check"></i><b>7.4</b> Applying the verification method to coupled equations<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="exact-solns-07.html"><a href="exact-solns-07.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>II Parameterizing Models with Data<span></span></b></span></li>
<li class="chapter" data-level="8" data-path="linear-regression-08.html"><a href="linear-regression-08.html"><i class="fa fa-check"></i><b>8</b> Linear Regression and Curve Fitting<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression-08.html"><a href="linear-regression-08.html#what-is-parameter-estimation"><i class="fa fa-check"></i><b>8.1</b> What is parameter estimation?<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-for-global-temperature-data"><i class="fa fa-check"></i><b>8.2</b> Parameter estimation for global temperature data<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="linear-regression-08.html"><a href="linear-regression-08.html#beyond-linear-08"><i class="fa fa-check"></i><b>8.3</b> Moving beyond linear models for parameter estimation<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-with-nonlinear-models"><i class="fa fa-check"></i><b>8.4</b> Parameter estimation with nonlinear models<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression-08.html"><a href="linear-regression-08.html#towards-model-data-fusion"><i class="fa fa-check"></i><b>8.5</b> Towards model-data fusion<span></span></a></li>
<li class="chapter" data-level="8.6" data-path="linear-regression-08.html"><a href="linear-regression-08.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="likelihood-09.html"><a href="likelihood-09.html"><i class="fa fa-check"></i><b>9</b> Probability and Likelihood Functions<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="likelihood-09.html"><a href="likelihood-09.html#linear-regression-on-a-small-dataset"><i class="fa fa-check"></i><b>9.1</b> Linear regression on a small dataset<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="likelihood-09.html"><a href="likelihood-09.html#continuous-probability-density-functions"><i class="fa fa-check"></i><b>9.2</b> Continuous probability density functions<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="likelihood-09.html"><a href="likelihood-09.html#connecting-probabilities-to-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Connecting probabilities to linear regression<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="likelihood-09.html"><a href="likelihood-09.html#visualizing-likelihood-surfaces"><i class="fa fa-check"></i><b>9.4</b> Visualizing likelihood surfaces<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="likelihood-09.html"><a href="likelihood-09.html#looking-back-and-forward"><i class="fa fa-check"></i><b>9.5</b> Looking back and forward<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="likelihood-09.html"><a href="likelihood-09.html#exercises-8"><i class="fa fa-check"></i><b>9.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>10</b> Cost Functions qnd Bayes’ Rule<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="cost-fns-10.html"><a href="cost-fns-10.html#cost-functions-and-model-data-residuals"><i class="fa fa-check"></i><b>10.1</b> Cost functions and model-data residuals<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="cost-fns-10.html"><a href="cost-fns-10.html#further-extensions-to-the-cost-function"><i class="fa fa-check"></i><b>10.2</b> Further extensions to the cost function<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="cost-fns-10.html"><a href="cost-fns-10.html#conditional-probabilities-and-bayes-rule"><i class="fa fa-check"></i><b>10.3</b> Conditional probabilities and Bayes’ rule<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="cost-fns-10.html"><a href="cost-fns-10.html#bayes-rule-in-action"><i class="fa fa-check"></i><b>10.4</b> Bayes’ rule in action<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="cost-fns-10.html"><a href="cost-fns-10.html#next-steps"><i class="fa fa-check"></i><b>10.5</b> Next steps<span></span></a></li>
<li class="chapter" data-level="10.6" data-path="cost-fns-10.html"><a href="cost-fns-10.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bootstrap-11.html"><a href="bootstrap-11.html"><i class="fa fa-check"></i><b>11</b> Sampling Distributions and the Bootstrap Method<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="bootstrap-11.html"><a href="bootstrap-11.html#histograms-and-their-visualization"><i class="fa fa-check"></i><b>11.1</b> Histograms and their visualization<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="bootstrap-11.html"><a href="bootstrap-11.html#statistical-theory-sampling-distributions"><i class="fa fa-check"></i><b>11.2</b> Statistical theory: sampling distributions<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="bootstrap-11.html"><a href="bootstrap-11.html#summary-and-next-steps"><i class="fa fa-check"></i><b>11.3</b> Summary and next steps<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="bootstrap-11.html"><a href="bootstrap-11.html#exercises-10"><i class="fa fa-check"></i><b>11.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="metropolis-12.html"><a href="metropolis-12.html"><i class="fa fa-check"></i><b>12</b> The Metropolis-Hastings Algorithm<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="metropolis-12.html"><a href="metropolis-12.html#estimating-the-growth-of-a-dog"><i class="fa fa-check"></i><b>12.1</b> Estimating the growth of a dog<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="metropolis-12.html"><a href="metropolis-12.html#lr-12"><i class="fa fa-check"></i><b>12.2</b> Likelihood ratios for parameter estimation<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="metropolis-12.html"><a href="metropolis-12.html#the-metropolis-hastings-algorithm-for-parameter-estimation"><i class="fa fa-check"></i><b>12.3</b> The Metropolis-Hastings algorithm for parameter estimation<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="metropolis-12.html"><a href="metropolis-12.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mcmc-13.html"><a href="mcmc-13.html"><i class="fa fa-check"></i><b>13</b> Markov Chain Monte Carlo Parameter Estimation<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="mcmc-13.html"><a href="mcmc-13.html#the-recipe-for-mcmc"><i class="fa fa-check"></i><b>13.1</b> The recipe for MCMC<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-an-empirical-model"><i class="fa fa-check"></i><b>13.2</b> MCMC parameter estimation with an empirical model<span></span></a></li>
<li class="chapter" data-level="13.3" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-a-differential-equation-model"><i class="fa fa-check"></i><b>13.3</b> MCMC parameter estimation with a differential equation model<span></span></a></li>
<li class="chapter" data-level="13.4" data-path="mcmc-13.html"><a href="mcmc-13.html#timing-your-code"><i class="fa fa-check"></i><b>13.4</b> Timing your code<span></span></a></li>
<li class="chapter" data-level="13.5" data-path="mcmc-13.html"><a href="mcmc-13.html#further-extensions-to-mcmc"><i class="fa fa-check"></i><b>13.5</b> Further extensions to MCMC<span></span></a></li>
<li class="chapter" data-level="13.6" data-path="mcmc-13.html"><a href="mcmc-13.html#exercises-12"><i class="fa fa-check"></i><b>13.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="information-criteria-14.html"><a href="information-criteria-14.html"><i class="fa fa-check"></i><b>14</b> Information Criteria<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="information-criteria-14.html"><a href="information-criteria-14.html#model-assessment-guidelines"><i class="fa fa-check"></i><b>14.1</b> Model assessment guidelines<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="information-criteria-14.html"><a href="information-criteria-14.html#information-criteria-for-assessing-competing-models"><i class="fa fa-check"></i><b>14.2</b> Information criteria for assessing competing models<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="information-criteria-14.html"><a href="information-criteria-14.html#a-few-cautionary-notes"><i class="fa fa-check"></i><b>14.3</b> A few cautionary notes<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="information-criteria-14.html"><a href="information-criteria-14.html#exercises-13"><i class="fa fa-check"></i><b>14.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>III Stability Analysis for Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="15" data-path="linearsystems-15.html"><a href="linearsystems-15.html"><i class="fa fa-check"></i><b>15</b> Systems of Linear Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="linearsystems-15.html"><a href="linearsystems-15.html#linear-systems-of-differential-equations-and-matrix-notation"><i class="fa fa-check"></i><b>15.1</b> Linear systems of differential equations and matrix notation<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="linearsystems-15.html"><a href="linearsystems-15.html#equilibrium-solutions-1"><i class="fa fa-check"></i><b>15.2</b> Equilibrium solutions<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="linearsystems-15.html"><a href="linearsystems-15.html#the-phase-plane"><i class="fa fa-check"></i><b>15.3</b> The phase plane<span></span></a></li>
<li class="chapter" data-level="15.4" data-path="linearsystems-15.html"><a href="linearsystems-15.html#non-equilibrium-solutions-and-their-stability"><i class="fa fa-check"></i><b>15.4</b> Non-equilibrium solutions and their stability<span></span></a></li>
<li class="chapter" data-level="15.5" data-path="linearsystems-15.html"><a href="linearsystems-15.html#exercises-14"><i class="fa fa-check"></i><b>15.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="nonlinear-16.html"><a href="nonlinear-16.html"><i class="fa fa-check"></i><b>16</b> Systems of Nonlinear Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="nonlinear-16.html"><a href="nonlinear-16.html#introducing-nonlinear-systems-of-differential-equations"><i class="fa fa-check"></i><b>16.1</b> Introducing nonlinear systems of differential equations<span></span></a></li>
<li class="chapter" data-level="16.2" data-path="nonlinear-16.html"><a href="nonlinear-16.html#zooming-in-on-the-phase-plane"><i class="fa fa-check"></i><b>16.2</b> Zooming in on the phase plane<span></span></a></li>
<li class="chapter" data-level="16.3" data-path="nonlinear-16.html"><a href="nonlinear-16.html#determining-equilibrium-solutions-with-nullclines"><i class="fa fa-check"></i><b>16.3</b> Determining equilibrium solutions with nullclines<span></span></a></li>
<li class="chapter" data-level="16.4" data-path="nonlinear-16.html"><a href="nonlinear-16.html#stability-of-an-equilibrium-solution"><i class="fa fa-check"></i><b>16.4</b> Stability of an equilibrium solution<span></span></a></li>
<li class="chapter" data-level="16.5" data-path="nonlinear-16.html"><a href="nonlinear-16.html#graphing-nullclines-in-a-phase-plane"><i class="fa fa-check"></i><b>16.5</b> Graphing nullclines in a phase plane<span></span></a></li>
<li class="chapter" data-level="16.6" data-path="nonlinear-16.html"><a href="nonlinear-16.html#exercises-15"><i class="fa fa-check"></i><b>16.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="jacobian-17.html"><a href="jacobian-17.html"><i class="fa fa-check"></i><b>17</b> Local Linearization and the Jacobian<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="jacobian-17.html"><a href="jacobian-17.html#competing-populations"><i class="fa fa-check"></i><b>17.1</b> Competing populations<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="jacobian-17.html"><a href="jacobian-17.html#tangent-plane-approximations"><i class="fa fa-check"></i><b>17.2</b> Tangent plane approximations<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="jacobian-17.html"><a href="jacobian-17.html#the-jacobian-matrix"><i class="fa fa-check"></i><b>17.3</b> The Jacobian matrix<span></span></a></li>
<li class="chapter" data-level="17.4" data-path="jacobian-17.html"><a href="jacobian-17.html#exercises-16"><i class="fa fa-check"></i><b>17.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html"><i class="fa fa-check"></i><b>18</b> What are Eigenvalues?<span></span></a>
<ul>
<li class="chapter" data-level="18.1" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#introduction"><i class="fa fa-check"></i><b>18.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#straight-line-solutions"><i class="fa fa-check"></i><b>18.2</b> Straight line solutions<span></span></a></li>
<li class="chapter" data-level="18.3" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#computing-eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>18.3</b> Computing eigenvalues and eigenvectors<span></span></a></li>
<li class="chapter" data-level="18.4" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#what-do-eigenvalues-tell-us"><i class="fa fa-check"></i><b>18.4</b> What do eigenvalues tell us?<span></span></a></li>
<li class="chapter" data-level="18.5" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#concluding-thoughts-1"><i class="fa fa-check"></i><b>18.5</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="18.6" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#exercises-17"><i class="fa fa-check"></i><b>18.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="stability-19.html"><a href="stability-19.html"><i class="fa fa-check"></i><b>19</b> Qualitative Stability Analysis<span></span></a>
<ul>
<li class="chapter" data-level="19.1" data-path="stability-19.html"><a href="stability-19.html#the-characteristic-polynomial-again"><i class="fa fa-check"></i><b>19.1</b> The characteristic polynomial (again)<span></span></a></li>
<li class="chapter" data-level="19.2" data-path="stability-19.html"><a href="stability-19.html#stability-with-the-trace-and-determinant"><i class="fa fa-check"></i><b>19.2</b> Stability with the trace and determinant<span></span></a></li>
<li class="chapter" data-level="19.3" data-path="stability-19.html"><a href="stability-19.html#a-workflow-for-stability-analysis"><i class="fa fa-check"></i><b>19.3</b> A workflow for stability analysis<span></span></a></li>
<li class="chapter" data-level="19.4" data-path="stability-19.html"><a href="stability-19.html#stability-for-higher-order-systems-of-differential-equations."><i class="fa fa-check"></i><b>19.4</b> Stability for higher-order systems of differential equations.<span></span></a></li>
<li class="chapter" data-level="19.5" data-path="stability-19.html"><a href="stability-19.html#exercises-18"><i class="fa fa-check"></i><b>19.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bifurcation-20.html"><a href="bifurcation-20.html"><i class="fa fa-check"></i><b>20</b> Bifurcation<span></span></a>
<ul>
<li class="chapter" data-level="20.1" data-path="bifurcation-20.html"><a href="bifurcation-20.html#a-series-of-equations"><i class="fa fa-check"></i><b>20.1</b> A series of equations<span></span></a></li>
<li class="chapter" data-level="20.2" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-with-systems-of-equations"><i class="fa fa-check"></i><b>20.2</b> Bifurcations with systems of equations<span></span></a></li>
<li class="chapter" data-level="20.3" data-path="bifurcation-20.html"><a href="bifurcation-20.html#functions-as-equilibrium-solutions-limit-cycles"><i class="fa fa-check"></i><b>20.3</b> Functions as equilibrium solutions: limit cycles<span></span></a></li>
<li class="chapter" data-level="20.4" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-as-analysis-tools"><i class="fa fa-check"></i><b>20.4</b> Bifurcations as analysis tools<span></span></a></li>
<li class="chapter" data-level="20.5" data-path="bifurcation-20.html"><a href="bifurcation-20.html#exercises-19"><i class="fa fa-check"></i><b>20.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>IV Stochastic Differential Equations<span></span></b></span></li>
<li class="chapter" data-level="21" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html"><i class="fa fa-check"></i><b>21</b> Stochastic Biological Systems<span></span></a>
<ul>
<li class="chapter" data-level="21.1" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#introducing-stochastic-effects"><i class="fa fa-check"></i><b>21.1</b> Introducing stochastic effects<span></span></a></li>
<li class="chapter" data-level="21.2" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#a-discrete-dynamical-system"><i class="fa fa-check"></i><b>21.2</b> A discrete dynamical system<span></span></a></li>
<li class="chapter" data-level="21.3" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#environmental-stochasticity"><i class="fa fa-check"></i><b>21.3</b> Environmental stochasticity<span></span></a></li>
<li class="chapter" data-level="21.4" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#discrete-systems-of-equations"><i class="fa fa-check"></i><b>21.4</b> Discrete systems of equations<span></span></a></li>
<li class="chapter" data-level="21.5" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#exercises-20"><i class="fa fa-check"></i><b>21.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html"><i class="fa fa-check"></i><b>22</b> Simulating and Visualizing Randomness<span></span></a>
<ul>
<li class="chapter" data-level="22.1" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#ensemble-averages"><i class="fa fa-check"></i><b>22.1</b> Ensemble averages<span></span></a></li>
<li class="chapter" data-level="22.2" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#repeated-iteration"><i class="fa fa-check"></i><b>22.2</b> Repeated iteration<span></span></a></li>
<li class="chapter" data-level="22.3" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#exercises-21"><i class="fa fa-check"></i><b>22.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="random-walks-23.html"><a href="random-walks-23.html"><i class="fa fa-check"></i><b>23</b> Random Walks<span></span></a>
<ul>
<li class="chapter" data-level="23.1" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-on-a-number-line"><i class="fa fa-check"></i><b>23.1</b> Random walk on a number line<span></span></a></li>
<li class="chapter" data-level="23.2" data-path="random-walks-23.html"><a href="random-walks-23.html#iteration-and-ensemble-averages"><i class="fa fa-check"></i><b>23.2</b> Iteration and ensemble averages<span></span></a></li>
<li class="chapter" data-level="23.3" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-mathematics"><i class="fa fa-check"></i><b>23.3</b> Random walk mathematics<span></span></a></li>
<li class="chapter" data-level="23.4" data-path="random-walks-23.html"><a href="random-walks-23.html#continuous-random-walks-and-diffusion"><i class="fa fa-check"></i><b>23.4</b> Continuous random walks and diffusion<span></span></a></li>
<li class="chapter" data-level="23.5" data-path="random-walks-23.html"><a href="random-walks-23.html#exercises-22"><i class="fa fa-check"></i><b>23.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="diffusion-24.html"><a href="diffusion-24.html"><i class="fa fa-check"></i><b>24</b> Diffusion and Brownian Motion<span></span></a>
<ul>
<li class="chapter" data-level="24.1" data-path="diffusion-24.html"><a href="diffusion-24.html#random-walk-redux"><i class="fa fa-check"></i><b>24.1</b> Random walk redux<span></span></a></li>
<li class="chapter" data-level="24.2" data-path="diffusion-24.html"><a href="diffusion-24.html#simulating-brownian-motion"><i class="fa fa-check"></i><b>24.2</b> Simulating Brownian motion<span></span></a></li>
<li class="chapter" data-level="24.3" data-path="diffusion-24.html"><a href="diffusion-24.html#exercises-23"><i class="fa fa-check"></i><b>24.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>25</b> Simulating Stochastic Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="25.1" data-path="sdes-25.html"><a href="sdes-25.html#the-stochastic-logistic-model"><i class="fa fa-check"></i><b>25.1</b> The stochastic logistic model<span></span></a></li>
<li class="chapter" data-level="25.2" data-path="sdes-25.html"><a href="sdes-25.html#the-euler-maruyama-method"><i class="fa fa-check"></i><b>25.2</b> The Euler-Maruyama method<span></span></a></li>
<li class="chapter" data-level="25.3" data-path="sdes-25.html"><a href="sdes-25.html#adding-stochasticity-to-parameters"><i class="fa fa-check"></i><b>25.3</b> Adding stochasticity to parameters<span></span></a></li>
<li class="chapter" data-level="25.4" data-path="sdes-25.html"><a href="sdes-25.html#systems-of-stochastic-differential-equations"><i class="fa fa-check"></i><b>25.4</b> Systems of stochastic differential equations<span></span></a></li>
<li class="chapter" data-level="25.5" data-path="sdes-25.html"><a href="sdes-25.html#concluding-thoughts-2"><i class="fa fa-check"></i><b>25.5</b> Concluding thoughts<span></span></a></li>
<li class="chapter" data-level="25.6" data-path="sdes-25.html"><a href="sdes-25.html#exercises-24"><i class="fa fa-check"></i><b>25.6</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html"><i class="fa fa-check"></i><b>26</b> Statistics of a Stochastic Differential Equation<span></span></a>
<ul>
<li class="chapter" data-level="26.1" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#expected-value-of-a-stochastic-process"><i class="fa fa-check"></i><b>26.1</b> Expected value of a stochastic process<span></span></a></li>
<li class="chapter" data-level="26.2" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#birth-death-processes"><i class="fa fa-check"></i><b>26.2</b> Birth-death processes<span></span></a></li>
<li class="chapter" data-level="26.3" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#wrapping-up"><i class="fa fa-check"></i><b>26.3</b> Wrapping up<span></span></a></li>
<li class="chapter" data-level="26.4" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#exercises-25"><i class="fa fa-check"></i><b>26.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>27</b> Solutions to Stochastic Differential Equations<span></span></a>
<ul>
<li class="chapter" data-level="27.1" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#meet-the-fokker-planck-equation"><i class="fa fa-check"></i><b>27.1</b> Meet the Fokker-Planck equation<span></span></a></li>
<li class="chapter" data-level="27.2" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#deterministically-the-end"><i class="fa fa-check"></i><b>27.2</b> Deterministically the end<span></span></a></li>
<li class="chapter" data-level="27.3" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#exercises-26"><i class="fa fa-check"></i><b>27.3</b> Exercises<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Modeling with Data and Differential Equations Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-walks-23" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> Random Walks<a href="random-walks-23.html#random-walks-23" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Chapters <a href="stoch-sys-21.html#stoch-sys-21">21</a> and <a href="stoch-sim-22.html#stoch-sim-22">22</a> introduced the concept of stochastic dynamical systems and ways to compute ensemble averages. In this chapter we will begin to develop some tools to understand stochastic differential equations by studying the concept of <em>random walks</em>. While exploring random walks may seem like a diversion from understanding stochastic differential equations, there are deep connections between the two topics. We will do some interesting computational exercises that may lead to some non-intuitive results. Curious? Let’s get started!</p>
<div id="random-walk-on-a-number-line" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Random walk on a number line<a href="random-walks-23.html#random-walk-on-a-number-line" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The conceptual idea of a random walk begins on a number line. Let’s begin at the origin (so at <span class="math inline">\(t=0\)</span> then <span class="math inline">\(x=0\)</span>). Based on this number line we can only move to the left or the right, with equal probability. At a given time we decide to move in a direction based on a random number <span class="math inline">\(r\)</span> drawn between 0 and 1 (in <code>R</code> we do this with the command <code>runif(1)</code>). Figure <a href="random-walks-23.html#fig:random-walk">23.1</a> conceptually illustrates this random walk</p>
<div class="figure" style="text-align: center"><span id="fig:random-walk"></span>
<img src="explore-model-zobitz-220419_files/figure-html/random-walk-1.png" alt="Schematic diagram for one-dimensional random walk." width="672" />
<p class="caption">
FIGURE 23.1: Schematic diagram for one-dimensional random walk.
</p>
</div>
<p>For each iteration of this process we will draw a random number using <code>runif(1)</code>. We can code this process using a <code>for</code> loop. Try the following code out on your own:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="random-walks-23.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of steps our random walk takes</span></span>
<span id="cb94-2"><a href="random-walks-23.html#cb94-2" aria-hidden="true" tabindex="-1"></a>number_steps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb94-3"><a href="random-walks-23.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="random-walks-23.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up vector of results</span></span>
<span id="cb94-5"><a href="random-walks-23.html#cb94-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> number_steps)</span>
<span id="cb94-6"><a href="random-walks-23.html#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="random-walks-23.html#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>number_steps) {</span>
<span id="cb94-8"><a href="random-walks-23.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb94-9"><a href="random-walks-23.html#cb94-9" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb94-10"><a href="random-walks-23.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># Move right</span></span>
<span id="cb94-11"><a href="random-walks-23.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb94-12"><a href="random-walks-23.html#cb94-12" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb94-13"><a href="random-walks-23.html#cb94-13" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># Move left</span></span>
<span id="cb94-14"><a href="random-walks-23.html#cb94-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-15"><a href="random-walks-23.html#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="random-walks-23.html#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s take a peek at our result:</span></span>
<span id="cb94-17"><a href="random-walks-23.html#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="random-walks-23.html#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb94-19"><a href="random-walks-23.html#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="random-walks-23.html#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(x)) <span class="co"># Average position over the time interval</span></span>
<span id="cb94-21"><a href="random-walks-23.html#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(x)) <span class="co"># Standard deviation over the time interval</span></span></code></pre></div>
<p>Let’s remind ourselves what this code does:</p>
<ul>
<li><code>number_steps &lt;- 100</code>: The number of times we draw a random number, referred to <em>steps</em>.</li>
<li><code>x &lt;- array(0,dim=number_steps)</code>: We are going to pre-allocate a vector (<code>array</code>) of our results. Values in this array are all set at 0 for convenience.</li>
<li>The for loop starts at the second step and then either adds or subtracts one from the prevoius position <code>x[i-1]</code> and updates the result to <code>x[i]</code>.</li>
<li><code>plot(x,type='l')</code> makes a simple line plot of the results.</li>
</ul>
<p>Now that you have run this code, try running it again. Do you get the same result? I hope you didn’t - because this process is random! It is interesting to run it several times because there can be a wide variance in our results - for some realizations of the sample path, we end up being strictly positive, other times we go negative, and other times we just hover around the middle line (<span class="math inline">\(x=0\)</span>) in the plot.</p>
</div>
<div id="iteration-and-ensemble-averages" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> Iteration and ensemble averages<a href="random-walks-23.html#iteration-and-ensemble-averages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can apply the workflow (Do once <span class="math inline">\(\rightarrow\)</span> Do several times <span class="math inline">\(\rightarrow\)</span> Summarize <span class="math inline">\(\rightarrow\)</span> Visualize) from Chapter <a href="stoch-sim-22.html#stoch-sim-22">22</a> on this random walk process to investigate what happens when we run additional simulations and compute the ensemble average. Let’s apply this workflow:</p>
<p>For the “Do once” step, we will define a function called <code>random_walk</code> that has the number of steps as an input:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="random-walks-23.html#cb95-1" aria-hidden="true" tabindex="-1"></a>random_walk <span class="ot">&lt;-</span> <span class="cf">function</span>(number_steps) {</span>
<span id="cb95-2"><a href="random-walks-23.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="random-walks-23.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up vector of results</span></span>
<span id="cb95-4"><a href="random-walks-23.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> number_steps)</span>
<span id="cb95-5"><a href="random-walks-23.html#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="random-walks-23.html#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>number_steps) {</span>
<span id="cb95-7"><a href="random-walks-23.html#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb95-8"><a href="random-walks-23.html#cb95-8" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb95-9"><a href="random-walks-23.html#cb95-9" aria-hidden="true" tabindex="-1"></a>    } <span class="co"># Move right</span></span>
<span id="cb95-10"><a href="random-walks-23.html#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb95-11"><a href="random-walks-23.html#cb95-11" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb95-12"><a href="random-walks-23.html#cb95-12" aria-hidden="true" tabindex="-1"></a>    } <span class="co"># Move left</span></span>
<span id="cb95-13"><a href="random-walks-23.html#cb95-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-14"><a href="random-walks-23.html#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="random-walks-23.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  out_x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> <span class="dv">0</span><span class="sc">:</span>(number_steps <span class="sc">-</span> <span class="dv">1</span>), x)</span>
<span id="cb95-16"><a href="random-walks-23.html#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_x)</span>
<span id="cb95-17"><a href="random-walks-23.html#cb95-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next to “Do several times” we will run this random walk function for 100 steps and 500 simulations and display the spaghetti plot in Figure <a href="random-walks-23.html#fig:spaghetti-rw-23">23.2</a>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="random-walks-23.html#cb96-1" aria-hidden="true" tabindex="-1"></a>number_steps <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Then number of steps in random walk</span></span>
<span id="cb96-2"><a href="random-walks-23.html#cb96-2" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># The number of simulations</span></span>
<span id="cb96-3"><a href="random-walks-23.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="random-walks-23.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute solutions</span></span>
<span id="cb96-5"><a href="random-walks-23.html#cb96-5" aria-hidden="true" tabindex="-1"></a>random_walk_sim <span class="ot">&lt;-</span> <span class="fu">rerun</span>(n_sims) <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="random-walks-23.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">&quot;sim&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_sims)) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="random-walks-23.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">random_walk</span>(number_steps)) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="random-walks-23.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span>.x, <span class="at">.id =</span> <span class="st">&quot;simulation&quot;</span>)</span>
<span id="cb96-9"><a href="random-walks-23.html#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="random-walks-23.html#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these all together</span></span>
<span id="cb96-11"><a href="random-walks-23.html#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> random_walk_sim, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb96-12"><a href="random-walks-23.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> simulation)) <span class="sc">+</span></span>
<span id="cb96-13"><a href="random-walks-23.html#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Random Walk&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-14"><a href="random-walks-23.html#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-15"><a href="random-walks-23.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Steps&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:spaghetti-rw-23"></span>
<img src="explore-model-zobitz-220419_files/figure-html/spaghetti-rw-23-1.png" alt="Spaghetti plot of 500 simulations for the random walk." width="672" />
<p class="caption">
FIGURE 23.2: Spaghetti plot of 500 simulations for the random walk.
</p>
</div>
<p>For the “Summarize” and “Visualize” steps we will compute the 95% confidence interval, structuring the code similar to Figure <a href="stoch-sim-22.html#fig:logistic-conf">22.5</a> from Chapter <a href="stoch-sim-22.html#stoch-sim-22">22</a>. Try writing this code out on your own, but the results are shown in Figure <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a>.</p>
<div class="figure"><span id="fig:ensemble-ave-23"></span>
<img src="explore-model-zobitz-220419_files/figure-html/ensemble-ave-23-1.png" alt="Ensemble average of 500 simulations for the random walk." width="672" />
<p class="caption">
FIGURE 23.3: Ensemble average of 500 simulations for the random walk.
</p>
</div>
<p>Two interesting things are occurring in Figures <a href="random-walks-23.html#fig:spaghetti-rw-23">23.2</a> and <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a>. First, Figure <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a> suggests that on <em>average</em> you go nowhere (in other words, the average position is <span class="math inline">\(x=0\)</span>), but as the number of steps increases, you are very likely to be <em>somewhere</em> (in other words, the confidence interval increases as the number of steps increases). Second, the 95% confidence interval appears to be a square root function <span class="math inline">\(y=a\sqrt{t}\)</span>. One way that we could confirm this is by running more realizations and investigating the ensemble average (Exercise <a href="random-walks-23.html#exr:rw-sim">23.3</a>).</p>
</div>
<div id="random-walk-mathematics" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Random walk mathematics<a href="random-walks-23.html#random-walk-mathematics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another way to corroborate our observations in Figures <a href="random-walks-23.html#fig:spaghetti-rw-23">23.2</a> and <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a> is with mathematics.
First we define some terminology and notation. Call <span class="math inline">\(x^{n}\)</span> the position <span class="math inline">\(x\)</span> at step <span class="math inline">\(n\)</span> in a random walk that increments with step size <span class="math inline">\(\Delta x\)</span> (Equation <a href="random-walks-23.html#eq:evol-eqn">(23.1)</a>:</p>
<p><span class="math display" id="eq:evol-eqn">\[\begin{equation}
x^{n}=x^{n-1}+r_{s} \; \Delta x = \sum_{s=1}^{n} \Delta x \; r_{s}, \tag{23.1}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\Delta x\)</span> being the jump size (in our example above <span class="math inline">\(\Delta x=1\)</span>), and <span class="math inline">\(s\)</span> the particular step in our random walk. We denote <span class="math inline">\(r_{s}\)</span> as a random variable that takes the value of <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span>. Another way to write <span class="math inline">\(r_{s}\)</span> is with Equation <a href="random-walks-23.html#eq:equal-prob">(23.2)</a>:</p>
<p><span class="math display" id="eq:equal-prob">\[\begin{equation}
r_{s}=\begin{cases} -1 &amp; p(-1)=0.5 \\
1 &amp; p(1)=0.5 \end{cases} \tag{23.2}
\end{equation}\]</span></p>
<p>The way to interpret Equation <a href="random-walks-23.html#eq:evol-eqn">(23.1)</a> is that the variable <span class="math inline">\(r_{s}\)</span> equals <span class="math inline">\(-1\)</span> (<span class="math inline">\(r_{s}=-1\)</span>) with probability 0.5 (<span class="math inline">\(p(-1)=0.5\)</span>). We can write Equation <a href="random-walks-23.html#eq:evol-eqn">(23.1)</a> as a single summation because the position depends on the different values of <span class="math inline">\(-1\)</span> or 1 generated at each step, only as long as we keep track of the sequence of <span class="math inline">\(-1\)</span> or 1 for each step <span class="math inline">\(s\)</span>.</p>
<p>When we run multiple simulations we will use the notation <span class="math inline">\(x_{j}^{n}\)</span>, which is the position at step <span class="math inline">\(n\)</span> for simulation <span class="math inline">\(j\)</span>.</p>
<p>Let’s introduce some terminology to help us out here. The quantity <span class="math inline">\(\displaystyle \big \langle X \big \rangle = \sum_{i=1}^{n} p(X) \cdot X\)</span> is the <em>expected value</em>  for a discrete random variable. What we do is weight the value of each possibility by its probability. For the random variable <span class="math inline">\(r_{s}\)</span> we have:</p>
<p><span class="math display">\[\begin{equation}
\big \langle r_{s} \big \rangle = (1) \cdot 0.5 + (- 1) \cdot 0.5 = 0
\end{equation}\]</span></p>
<p>Nice! The expected value is a linear operator<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>.</p>
<p>The next step is to determine the expected value of <span class="math inline">\(x^{n}\)</span>. Here we have <span class="math inline">\(J\)</span> different simulations; this will be computed as <span class="math inline">\(\displaystyle \big \langle x^{n} \big \rangle = \frac{1}{J} \sum_{j=1}^{J} p(x_{j}^{n}) \cdot x_{j}^{n}\)</span>. We can further compute the expected value using Equation <a href="random-walks-23.html#eq:evol-eqn">(23.1)</a>:</p>
<p><span class="math display">\[\begin{equation}
\big \langle x^{n} \big \rangle = \big \langle \sum_{j=1}^{J} \left( \Delta x \; r_{s} \right) \big \rangle = \sum_{j=1}^{J} \left( \big \langle \Delta x \; r_{s} \big \rangle \right) = \sum_{j=1}^{J} \Delta x  \cdot \big \langle \; r_{s} \big \rangle  = 0
\end{equation}\]</span></p>
<p>Imagine that! All of this mathematics leads to the conclusion that the expected value of <span class="math inline">\(x^{n}\)</span> is zero! In other words, on average a <em>random walk goes nowhere</em>!</p>
<div id="random-walk-variance" class="section level3 hasAnchor" number="23.3.1">
<h3><span class="header-section-number">23.3.1</span> Random walk variance<a href="random-walks-23.html#random-walk-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have characterized the expected value we will determine the variance<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a>  of <span class="math inline">\(x^{n}\)</span>, or <span class="math inline">\(\langle (x^{n})^{2} \rangle\)</span>. This is still a lot of work with summations, but it is worth it! First, multiply out the square of Equation <a href="random-walks-23.html#eq:evol-eqn">(23.1)</a> using properties of summation:</p>
<p><span class="math display">\[\begin{equation}
(x^{n})^{2} = \left( \sum_{s=1}^{n} \left( \Delta x \; r_{s} \right) \right)^{2} = \left( \Delta x \right)^{2}  \sum_{s=1}^{n} \sum_{t=1}^{n}  (r_{s} \cdot r_{t} )
\end{equation}\]</span></p>
<p>Now when we compute the expected value for <span class="math inline">\(\displaystyle \big \langle (x^{n})^{2} \big \rangle\)</span> we need to consider the double summation - so this means there are two different indices <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. However because of summation properties we have:</p>
<p><span class="math display">\[\begin{equation}
\big \langle (x^{n})^{2}  \big \rangle =  \left( \Delta x \right)^{2}  \sum_{s=1}^{n} \sum_{t=1}^{n}  \big \langle r_{s} \cdot r_{t} \big \rangle
\end{equation}\]</span></p>
<p>So really we need to consider the term <span class="math inline">\(\displaystyle \big \langle r_{s} \cdot r_{t} \big \rangle\)</span>. While that may seem scary, let’s break it down into two cases: when <span class="math inline">\(t=s\)</span> and <span class="math inline">\(t \neq s\)</span>:</p>
<div class="line-block">- Case <span class="math inline">\(t \neq s\)</span>: Here we need to multiply together all the possible combinations for the random variable <span class="math inline">\(r_{s} \cdot r_{t}\)</span>. There are four possibilities: <span class="math inline">\(r_{s} \cdot r_{t}=(-1) \cdot (1)\)</span>, <span class="math inline">\(r_{s} \cdot r_{t}=(-1) \cdot (-1)\)</span>, <span class="math inline">\(r_{s} \cdot r_{t}=(1) \cdot (1)\)</span>, <span class="math inline">\(r_{s} \cdot r_{t}=(1) \cdot (-1)\)</span>. When we multiply these results and consider the different probabilities associated with them we get the following random variable for <span class="math inline">\(r_{s} \cdot r_{t}\)</span>:</div>
<p><span class="math display" id="eq:equal-prob-two">\[\begin{equation}
r_{s} \cdot r_{t} =\begin{cases} -1 &amp; p(-1)=0.5 \\
1 &amp; p(1)=0.5 \end{cases} \tag{23.3}
\end{equation}\]</span></p>
<div class="line-block">Then the expected value is the following:</div>
<p><span class="math display">\[\begin{equation}
\big \langle r_{s} \cdot r_{t} \big \rangle = (1) \cdot 0.5 + (-1) \cdot 0.5 = 0
\end{equation}\]</span></p>
<div class="line-block">- Case <span class="math inline">\(t = s\)</span>: This case is a little easier. In both instances (when <span class="math inline">\(r_{t}=1\)</span> or <span class="math inline">\(r_{t}=-1\)</span>) the variable <span class="math inline">\(r_{t} \cdot r_{t}\)</span> equals 1, so the expected value <span class="math inline">\(\displaystyle \big \langle r_{s} \cdot r_{t} \big \rangle\)</span> is simply 1! So as a result:</div>
<p><span class="math display" id="eq:rw-variance-final">\[\begin{equation}
\begin{split}
\big \langle (x^{n})^{2} \big \rangle &amp;= \left( \Delta x \right)^{2}  \sum_{s=1}^{n} \big \langle r_{s}^{2} \big \rangle \\
&amp; = \left( \Delta x \right)^{2}  \sum_{s=1}^{n} 1\\
&amp;= n \left( \Delta x \right)^{2}
\end{split} \tag{23.4}
\end{equation}\]</span></p>
<div class="line-block">Equation <a href="random-walks-23.html#eq:rw-variance-final">(23.4)</a> tells us that the variance, or the mean square displacement, is proportional to <span class="math inline">\(n\)</span>. Another way to state this is that the standard deviation (the square root of the variance) is equal to <span class="math inline">\(\pm \sqrt{n} \; \Delta x\)</span>, where <span class="math inline">\(n\)</span> is the current step. This matches up with our graphs from earlier since <span class="math inline">\(\Delta x =1\)</span>! Informally, the variance tells us that on <em>average</em> you go nowhere, but <em>eventually</em> you travel everywhere - how cool!</div>
</div>
</div>
<div id="continuous-random-walks-and-diffusion" class="section level2 hasAnchor" number="23.4">
<h2><span class="header-section-number">23.4</span> Continuous random walks and diffusion<a href="random-walks-23.html#continuous-random-walks-and-diffusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On a final note, we can extend the discrete random walk to continuous time. This process is perhaps similar to how you may have seen that the Riemann sum to (discretely) approximate the area underneath a curve and the horizontal axis becomes a definite integral.</p>
<p>Define the variable <span class="math inline">\(t\)</span> such that <span class="math inline">\(t= n \Delta t\)</span>. Equivalently <span class="math inline">\(\displaystyle n = \frac{t}{\Delta t}\)</span>. With this information we can use Equation <a href="random-walks-23.html#eq:rw-variance-final">(23.4)</a> to do the following:</p>
<p><span class="math display" id="eq:rw-diffusion">\[\begin{equation}
\big \langle (x^{n})^{2} \big \rangle = \frac{t}{\Delta t} ( \Delta x)^{2}. \tag{23.5}
\end{equation}\]</span></p>
<p>The quantity <span class="math inline">\(\displaystyle D = \frac{( \Delta x)^{2}}{2 \Delta t}\)</span> is known as the <em>diffusion coefficent</em>. So then the mean square displacement can be arranged as <span class="math inline">\(\langle (x^{n})^{2} \rangle = 2Dt\)</span>, confirming again that the variance grows proportional to <span class="math inline">\(t\)</span>.</p>
<p>To connect this back to our discussion of stochastic differential equations, understanding random walks helps us to understand how demographic and environmental stochasticity may affect a differential equation. An excellent, highly readable book on random walks in biology is <span class="citation"><a href="#ref-berg_random_1993" role="doc-biblioref">Howard Berg</a> (<a href="#ref-berg_random_1993" role="doc-biblioref">1993</a>)</span>. Since there is a randomness to solution trajectories, we will repeatedly use ensemble averages (developed in Chapter <a href="stoch-sim-22.html#stoch-sim-22">22</a>) to understand the expected behaviors of a stochastic differential equation. The next chapters will apply the workflows studied here to investigate the connections between random walks and stochastic differential equations.</p>
</div>
<div id="exercises-22" class="section level2 hasAnchor" number="23.5">
<h2><span class="header-section-number">23.5</span> Exercises<a href="random-walks-23.html#exercises-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="exercise">
<span id="exr:unnamed-chunk-279" class="exercise"><strong>Exercise 23.1  </strong></span>When doing the random walk mathematics, we made the claim that <span class="math inline">\(\displaystyle x^{n} = \sum_{s=1}^n \Delta x \, r_{s}\)</span>, where <span class="math inline">\(r_{s}\)</span> takes on the value of <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span>. Set <span class="math inline">\(\Delta x = 1\)</span> and do a random walk for 5 steps, keeping track whether the value of <span class="math inline">\(r\)</span> is <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span> at each step. Does the final position equal the sum of all the values of <span class="math inline">\(-1\)</span> or <span class="math inline">\(1\)</span>?
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-280" class="exercise"><strong>Exercise 23.2  </strong></span>Let <span class="math inline">\(r_{s}\)</span> be the random variable defined by Equation <a href="random-walks-23.html#eq:equal-prob">(23.2)</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Multiply out the following summation: <span class="math inline">\(\displaystyle \sum_{s=1}^{2} \sum_{t=1}^{2} (r_{s} r_{t} )\)</span>.</li>
<li>Use the previous result to compute the expected value <span class="math inline">\(\displaystyle \big \langle \sum_{s=1}^{2} \sum_{t=1}^{2} r_{s} \cdot r_{t} \big \rangle\)</span></li>
</ol>
</div>

<div class="exercise">
<span id="exr:rw-sim" class="exercise"><strong>Exercise 23.3  </strong></span>Re-run the code used to generate Figure <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a>, but where the number of realizations is set to 1000 and 5000 (this may take some time to compute). Do your results conform to the observation that the expected position is zero, but the uncertainty grows as the number of steps increases? Can you determine the value of <span class="math inline">\(a\)</span> such that <span class="math inline">\(y=a\cdot\sqrt{n}\)</span> that parameterizes the 95% confidence interval as a function of <span class="math inline">\(n\)</span>?
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-281" class="exercise"><strong>Exercise 23.4  </strong></span>Use the fact that the diffusion coefficient is equal to <span class="math inline">\(\displaystyle D = \frac{ (\Delta x)^{2}}{2\Delta t}\)</span> to answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li>Solve <span class="math inline">\(\displaystyle D = \frac{ (\Delta x)^{2}}{2\Delta t}\)</span> to isolate <span class="math inline">\(\Delta t\)</span> on one side of the expression.</li>
<li>The diffusion coefficient for oxygen in water is approximately <span class="math inline">\(10^{-5}\)</span> cm<span class="math inline">\(^{2}\)</span> sec<span class="math inline">\(^{-1}\)</span>. Use that value to complete the following table:</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center"><strong>Distance (<span class="math inline">\(\Delta x\)</span>)</strong></th>
<th align="center">1 <span class="math inline">\(\mu\)</span>m = 10<span class="math inline">\(^{-6}\)</span> m</th>
<th align="center">10 <span class="math inline">\(\mu\)</span>m</th>
<th align="center">1 mm</th>
<th align="center">1 cm</th>
<th align="center">1 m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Diffusion time (<span class="math inline">\(\Delta t\)</span>)</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Report the diffusion time in an appropriate unit (seconds, minutes, hours, years) accordingly.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Navigate to the following website, which lists <a href="https://en.wikibooks.org/wiki/Cell_Biology/Introduction/Cell_size">sizes of different cells:</a>. For what cells would diffusion be a reasonable process to transport materials?</li>
</ol>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-282" class="exercise"><strong>Exercise 23.5  </strong></span>Consider Equation <a href="random-walks-23.html#eq:rw-diffusion">(23.5)</a>. Evaluate separately the effect of <span class="math inline">\(\Delta x\)</span> and <span class="math inline">\(\Delta t\)</span> on the variance. How would you characterize the variance if either of them independently is small or large?
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-283" class="exercise"><strong>Exercise 23.6  </strong></span>Compute <span class="math inline">\(\langle r \rangle\)</span> for the following random variable:</p>
<p><span class="math display">\[\begin{equation} 
r=\begin{cases} -1 &amp; p(-1)=0.52 \\
1 &amp; p(1)=0.48 \end{cases}
\end{equation}\]</span></p>
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-284" class="exercise"><strong>Exercise 23.7  </strong></span>Compute <span class="math inline">\(\langle r \rangle\)</span> for the following random variable:</p>
<span class="math display">\[\begin{equation} 
r=\begin{cases} -1 &amp; p(-1)=q \\
1 &amp; p(1)=(1-q) \end{cases}
\end{equation}\]</span>
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-285" class="exercise"><strong>Exercise 23.8  </strong></span>Consider the following random variable:</p>
<p><span class="math display">\[\begin{equation}
r_{q}=
\begin{cases}
-1 &amp; p(-1) = 1/3 \\
0 &amp; p(0)= 1/3\\
1 &amp; p(1)=1/3
\end{cases}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Modify the code for the one-dimensional random walk to generate a simulation of this random walk and plot your result. You can do this by applying an <code>if</code> <code>else</code> statement as shown in the code chunk below.</li>
<li>Compute <span class="math inline">\(\displaystyle \langle r_{q} \rangle\)</span> and <span class="math inline">\(\displaystyle \langle r_{q}^{2} \rangle\)</span>.</li>
<li>Based on your last answer, explain how this random variable introduces a different random walk than the one described in this chapter. In what ways would this random walk change the calculations for the mean and variance of the ensemble simulations?</li>
</ol>
</div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="random-walks-23.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code for random variable r_q:</span></span>
<span id="cb97-2"><a href="random-walks-23.html#cb97-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb97-3"><a href="random-walks-23.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (p <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>) {</span>
<span id="cb97-4"><a href="random-walks-23.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb97-5"><a href="random-walks-23.html#cb97-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span> <span class="sc">&lt;=</span> p <span class="sc">&amp;</span> p <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span>) {</span>
<span id="cb97-6"><a href="random-walks-23.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb97-7"><a href="random-walks-23.html#cb97-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb97-8"><a href="random-walks-23.html#cb97-8" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb97-9"><a href="random-walks-23.html#cb97-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

<div class="exercise">
<p><span id="exr:random-2d-23" class="exercise"><strong>Exercise 23.9  </strong></span>In this exercise you will write code and simulate a two-dimensional random walk. In a given step you can either move (1) left, (2) right, (3) up, or (4) down. (You cannot move up and left for example). The random walk starts at <span class="math inline">\((x,y)=(0,0)\)</span>. With <span class="math inline">\(\Delta x = 1\)</span>, the random walk at step <span class="math inline">\(n\)</span> can be described by <span class="math inline">\(\displaystyle (x,y)^{n} = \sum_{s=1}^{n} r_{d}\)</span>, where <span class="math inline">\(r_{d}\)</span> is one of the four motions, represented as a coordinate pair. (A movement up is <span class="math inline">\(r_{d}=(0,1)\)</span> for example.)</p>
<ol style="list-style-type: lower-alpha">
<li>Define a variable <span class="math inline">\(r_{d}\)</span> that models the motion from step to step.</li>
<li>Modify the code for the one-dimensional random walk to incorporate this two-dimensional random walk. One way to do this is to create a variable <span class="math inline">\(y\)</span> structured similar to <span class="math inline">\(x\)</span>, and to have multiple <code>if</code> statements in the <code>for</code> loop that moves <code>y</code>.</li>
<li>Plot a few different realizations of your sample paths.</li>
<li>If we were to compute the mean and variance of the ensemble simulations, what do you think they would be?</li>
</ol>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-berg_random_1993" class="csl-entry">
Berg, Howard. 1993. <em>Random <span>Walks</span> in <span>Biology</span></em>. <span>Princeton, New Jersey</span>: <span>Princeton University Press</span>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>This means that for random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> with constants <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>: <span class="math inline">\(\displaystyle \big \langle aX+bY \big \rangle = a \cdot \big \langle X \big \rangle + b \cdot \big \langle Y \big \rangle\)</span>.<a href="random-walks-23.html#fnref47" class="footnote-back">↩︎</a></p></li>
<li id="fn48"><p>The definition of the variance of a random variable <span class="math inline">\(X\)</span> is <span class="math inline">\(\big \langle (X-\mu)^{2} \big \rangle\)</span>, where <span class="math inline">\(\mu\)</span> is the expected value. For our case <span class="math inline">\(\mu\)</span> equals 0.<a href="random-walks-23.html#fnref48" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stoch-sim-22.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diffusion-24.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/23-randomWalks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/23-randomWalks.Rmd",
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
