<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 24 Diffusion and Brownian Motion | Exploring Modeling with Data and Differential Equations Using R</title>
  <meta name="description" content="A textbook used for combining differential equation models with data using R." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 24 Diffusion and Brownian Motion | Exploring Modeling with Data and Differential Equations Using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A textbook used for combining differential equation models with data using R." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 24 Diffusion and Brownian Motion | Exploring Modeling with Data and Differential Equations Using R" />
  
  <meta name="twitter:description" content="A textbook used for combining differential equation models with data using R." />
  

<meta name="author" content="John M. Zobitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-walks-23.html"/>
<link rel="next" href="sdes-25.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computational-code"><i class="fa fa-check"></i>Computational code</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#questions-comments-issues"><i class="fa fa-check"></i>Questions? Comments? Issues?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-cover"><i class="fa fa-check"></i>About the cover</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Models with Differential Equations</b></span></li>
<li class="chapter" data-level="1" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>1</b> Models of Rates with Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-01.html"><a href="intro-01.html#rates-of-change-in-the-world-a-model-is-born"><i class="fa fa-check"></i><b>1.1</b> Rates of change in the world: a model is born</a></li>
<li class="chapter" data-level="1.2" data-path="intro-01.html"><a href="intro-01.html#modeling-in-context-the-spread-of-a-disease"><i class="fa fa-check"></i><b>1.2</b> Modeling in context: the spread of a disease</a></li>
<li class="chapter" data-level="1.3" data-path="intro-01.html"><a href="intro-01.html#model-solutions"><i class="fa fa-check"></i><b>1.3</b> Model solutions</a></li>
<li class="chapter" data-level="1.4" data-path="intro-01.html"><a href="intro-01.html#which-model-is-best"><i class="fa fa-check"></i><b>1.4</b> Which model is best?</a></li>
<li class="chapter" data-level="1.5" data-path="intro-01.html"><a href="intro-01.html#start-here"><i class="fa fa-check"></i><b>1.5</b> Start here</a></li>
<li class="chapter" data-level="1.6" data-path="intro-01.html"><a href="intro-01.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-intro-02.html"><a href="r-intro-02.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> <code>R</code> and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-intro-02.html"><a href="r-intro-02.html#first-steps-getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.2</b> First steps: getting acquainted with <code>R</code></a></li>
<li class="chapter" data-level="2.3" data-path="r-intro-02.html"><a href="r-intro-02.html#increasing-functionality-with-packages"><i class="fa fa-check"></i><b>2.3</b> Increasing functionality with packages</a></li>
<li class="chapter" data-level="2.4" data-path="r-intro-02.html"><a href="r-intro-02.html#working-with-r-variables-data-frames-and-datasets"><i class="fa fa-check"></i><b>2.4</b> Working with <code>R</code>: variables, data frames, and datasets</a></li>
<li class="chapter" data-level="2.5" data-path="r-intro-02.html"><a href="r-intro-02.html#visualization-with-r"><i class="fa fa-check"></i><b>2.5</b> Visualization with <code>R</code></a></li>
<li class="chapter" data-level="2.6" data-path="r-intro-02.html"><a href="r-intro-02.html#defining-functions"><i class="fa fa-check"></i><b>2.6</b> Defining functions</a></li>
<li class="chapter" data-level="2.7" data-path="r-intro-02.html"><a href="r-intro-02.html#concluding-thoughts"><i class="fa fa-check"></i><b>2.7</b> Concluding thoughts</a></li>
<li class="chapter" data-level="2.8" data-path="r-intro-02.html"><a href="r-intro-02.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>3</b> Modeling with Rates of Change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#competing-plant-species-and-equilibrium-solutions"><i class="fa fa-check"></i><b>3.1</b> Competing plant species and equilibrium solutions</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#the-law-of-mass-action"><i class="fa fa-check"></i><b>3.2</b> The Law of Mass Action</a></li>
<li class="chapter" data-level="3.3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#coupled-differential-equations-lynx-and-hares"><i class="fa fa-check"></i><b>3.3</b> Coupled differential equations: lynx and hares</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#functional-responses"><i class="fa fa-check"></i><b>3.4</b> Functional responses</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>4</b> Euler’s Method</a>
<ul>
<li class="chapter" data-level="4.1" data-path="euler-04.html"><a href="euler-04.html#the-flu-and-locally-linear-approximation"><i class="fa fa-check"></i><b>4.1</b> The flu and locally linear approximation</a></li>
<li class="chapter" data-level="4.2" data-path="euler-04.html"><a href="euler-04.html#a-workflow-for-approximation"><i class="fa fa-check"></i><b>4.2</b> A workflow for approximation</a></li>
<li class="chapter" data-level="4.3" data-path="euler-04.html"><a href="euler-04.html#building-an-iterative-method"><i class="fa fa-check"></i><b>4.3</b> Building an iterative method</a></li>
<li class="chapter" data-level="4.4" data-path="euler-04.html"><a href="euler-04.html#eulers-method-and-beyond"><i class="fa fa-check"></i><b>4.4</b> Euler’s method and beyond</a></li>
<li class="chapter" data-level="4.5" data-path="euler-04.html"><a href="euler-04.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>5</b> Phase Lines and Equilibrium Solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="phase-05.html"><a href="phase-05.html#equilibrium-solutions"><i class="fa fa-check"></i><b>5.1</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="5.2" data-path="phase-05.html"><a href="phase-05.html#phase-lines-for-differential-equations"><i class="fa fa-check"></i><b>5.2</b> Phase lines for differential equations</a></li>
<li class="chapter" data-level="5.3" data-path="phase-05.html"><a href="phase-05.html#a-stability-test-for-equilibrium-solutions"><i class="fa fa-check"></i><b>5.3</b> A stability test for equilibrium solutions</a></li>
<li class="chapter" data-level="5.4" data-path="phase-05.html"><a href="phase-05.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>6</b> Coupled Systems of Equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="coupled-06.html"><a href="coupled-06.html#flu-with-quarantine-and-equilibrium-solutions"><i class="fa fa-check"></i><b>6.1</b> Flu with quarantine and equilibrium solutions</a></li>
<li class="chapter" data-level="6.2" data-path="coupled-06.html"><a href="coupled-06.html#nullclines"><i class="fa fa-check"></i><b>6.2</b> Nullclines</a></li>
<li class="chapter" data-level="6.3" data-path="coupled-06.html"><a href="coupled-06.html#phase-planes"><i class="fa fa-check"></i><b>6.3</b> Phase planes</a></li>
<li class="chapter" data-level="6.4" data-path="coupled-06.html"><a href="coupled-06.html#generating-a-phase-plane-in-r"><i class="fa fa-check"></i><b>6.4</b> Generating a phase plane in <code>R</code></a></li>
<li class="chapter" data-level="6.5" data-path="coupled-06.html"><a href="coupled-06.html#slope-fields"><i class="fa fa-check"></i><b>6.5</b> Slope fields</a></li>
<li class="chapter" data-level="6.6" data-path="coupled-06.html"><a href="coupled-06.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>7</b> Exact Solutions to Differential Equations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-a-solution"><i class="fa fa-check"></i><b>7.1</b> Verify a solution</a></li>
<li class="chapter" data-level="7.2" data-path="exact-solns-07.html"><a href="exact-solns-07.html#separable-differential-equations"><i class="fa fa-check"></i><b>7.2</b> Separable differential equations</a></li>
<li class="chapter" data-level="7.3" data-path="exact-solns-07.html"><a href="exact-solns-07.html#integrating-factors"><i class="fa fa-check"></i><b>7.3</b> Integrating factors</a></li>
<li class="chapter" data-level="7.4" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-broad-07"><i class="fa fa-check"></i><b>7.4</b> Applying the verification method to coupled equations</a></li>
<li class="chapter" data-level="7.5" data-path="exact-solns-07.html"><a href="exact-solns-07.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Parameterizing Models with Data</b></span></li>
<li class="chapter" data-level="8" data-path="linear-regression-08.html"><a href="linear-regression-08.html"><i class="fa fa-check"></i><b>8</b> Linear Regression and Curve Fitting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression-08.html"><a href="linear-regression-08.html#what-is-parameter-estimation"><i class="fa fa-check"></i><b>8.1</b> What is parameter estimation?</a></li>
<li class="chapter" data-level="8.2" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-for-global-temperature-data"><i class="fa fa-check"></i><b>8.2</b> Parameter estimation for global temperature data</a></li>
<li class="chapter" data-level="8.3" data-path="linear-regression-08.html"><a href="linear-regression-08.html#beyond-linear-08"><i class="fa fa-check"></i><b>8.3</b> Moving beyond linear models for parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-with-nonlinear-models"><i class="fa fa-check"></i><b>8.4</b> Parameter estimation with nonlinear models</a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression-08.html"><a href="linear-regression-08.html#towards-model-data-fusion"><i class="fa fa-check"></i><b>8.5</b> Towards model-data fusion</a></li>
<li class="chapter" data-level="8.6" data-path="linear-regression-08.html"><a href="linear-regression-08.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="likelihood-09.html"><a href="likelihood-09.html"><i class="fa fa-check"></i><b>9</b> Probability and Likelihood Functions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="likelihood-09.html"><a href="likelihood-09.html#linear-regression-on-a-small-dataset"><i class="fa fa-check"></i><b>9.1</b> Linear regression on a small dataset</a></li>
<li class="chapter" data-level="9.2" data-path="likelihood-09.html"><a href="likelihood-09.html#continuous-probability-density-functions"><i class="fa fa-check"></i><b>9.2</b> Continuous probability density functions</a></li>
<li class="chapter" data-level="9.3" data-path="likelihood-09.html"><a href="likelihood-09.html#connecting-probabilities-to-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Connecting probabilities to linear regression</a></li>
<li class="chapter" data-level="9.4" data-path="likelihood-09.html"><a href="likelihood-09.html#visualizing-likelihood-surfaces"><i class="fa fa-check"></i><b>9.4</b> Visualizing likelihood surfaces</a></li>
<li class="chapter" data-level="9.5" data-path="likelihood-09.html"><a href="likelihood-09.html#looking-back-and-forward"><i class="fa fa-check"></i><b>9.5</b> Looking back and forward</a></li>
<li class="chapter" data-level="9.6" data-path="likelihood-09.html"><a href="likelihood-09.html#exercises-8"><i class="fa fa-check"></i><b>9.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>10</b> Cost Functions and Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cost-fns-10.html"><a href="cost-fns-10.html#cost-functions-and-model-data-residuals"><i class="fa fa-check"></i><b>10.1</b> Cost functions and model-data residuals</a></li>
<li class="chapter" data-level="10.2" data-path="cost-fns-10.html"><a href="cost-fns-10.html#further-extensions-to-the-cost-function"><i class="fa fa-check"></i><b>10.2</b> Further extensions to the cost function</a></li>
<li class="chapter" data-level="10.3" data-path="cost-fns-10.html"><a href="cost-fns-10.html#conditional-probabilities-and-bayes-rule"><i class="fa fa-check"></i><b>10.3</b> Conditional probabilities and Bayes’ rule</a></li>
<li class="chapter" data-level="10.4" data-path="cost-fns-10.html"><a href="cost-fns-10.html#bayes-rule-in-action"><i class="fa fa-check"></i><b>10.4</b> Bayes’ rule in action</a></li>
<li class="chapter" data-level="10.5" data-path="cost-fns-10.html"><a href="cost-fns-10.html#next-steps"><i class="fa fa-check"></i><b>10.5</b> Next steps</a></li>
<li class="chapter" data-level="10.6" data-path="cost-fns-10.html"><a href="cost-fns-10.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bootstrap-11.html"><a href="bootstrap-11.html"><i class="fa fa-check"></i><b>11</b> Sampling Distributions and the Bootstrap Method</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bootstrap-11.html"><a href="bootstrap-11.html#histograms-and-their-visualization"><i class="fa fa-check"></i><b>11.1</b> Histograms and their visualization</a></li>
<li class="chapter" data-level="11.2" data-path="bootstrap-11.html"><a href="bootstrap-11.html#statistical-theory-sampling-distributions"><i class="fa fa-check"></i><b>11.2</b> Statistical theory: sampling distributions</a></li>
<li class="chapter" data-level="11.3" data-path="bootstrap-11.html"><a href="bootstrap-11.html#summary-and-next-steps"><i class="fa fa-check"></i><b>11.3</b> Summary and next steps</a></li>
<li class="chapter" data-level="11.4" data-path="bootstrap-11.html"><a href="bootstrap-11.html#exercises-10"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="metropolis-12.html"><a href="metropolis-12.html"><i class="fa fa-check"></i><b>12</b> The Metropolis-Hastings Algorithm</a>
<ul>
<li class="chapter" data-level="12.1" data-path="metropolis-12.html"><a href="metropolis-12.html#estimating-the-growth-of-a-dog"><i class="fa fa-check"></i><b>12.1</b> Estimating the growth of a dog</a></li>
<li class="chapter" data-level="12.2" data-path="metropolis-12.html"><a href="metropolis-12.html#lr-12"><i class="fa fa-check"></i><b>12.2</b> Likelihood ratios for parameter estimation</a></li>
<li class="chapter" data-level="12.3" data-path="metropolis-12.html"><a href="metropolis-12.html#the-metropolis-hastings-algorithm-for-parameter-estimation"><i class="fa fa-check"></i><b>12.3</b> The Metropolis-Hastings algorithm for parameter estimation</a></li>
<li class="chapter" data-level="12.4" data-path="metropolis-12.html"><a href="metropolis-12.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mcmc-13.html"><a href="mcmc-13.html"><i class="fa fa-check"></i><b>13</b> Markov Chain Monte Carlo Parameter Estimation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mcmc-13.html"><a href="mcmc-13.html#the-recipe-for-mcmc"><i class="fa fa-check"></i><b>13.1</b> The recipe for MCMC</a></li>
<li class="chapter" data-level="13.2" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-an-empirical-model"><i class="fa fa-check"></i><b>13.2</b> MCMC parameter estimation with an empirical model</a></li>
<li class="chapter" data-level="13.3" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-a-differential-equation-model"><i class="fa fa-check"></i><b>13.3</b> MCMC parameter estimation with a differential equation model</a></li>
<li class="chapter" data-level="13.4" data-path="mcmc-13.html"><a href="mcmc-13.html#timing-your-code"><i class="fa fa-check"></i><b>13.4</b> Timing your code</a></li>
<li class="chapter" data-level="13.5" data-path="mcmc-13.html"><a href="mcmc-13.html#further-extensions-to-mcmc"><i class="fa fa-check"></i><b>13.5</b> Further extensions to MCMC</a></li>
<li class="chapter" data-level="13.6" data-path="mcmc-13.html"><a href="mcmc-13.html#exercises-12"><i class="fa fa-check"></i><b>13.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="information-criteria-14.html"><a href="information-criteria-14.html"><i class="fa fa-check"></i><b>14</b> Information Criteria</a>
<ul>
<li class="chapter" data-level="14.1" data-path="information-criteria-14.html"><a href="information-criteria-14.html#model-assessment-guidelines"><i class="fa fa-check"></i><b>14.1</b> Model assessment guidelines</a></li>
<li class="chapter" data-level="14.2" data-path="information-criteria-14.html"><a href="information-criteria-14.html#information-criteria-for-assessing-competing-models"><i class="fa fa-check"></i><b>14.2</b> Information criteria for assessing competing models</a></li>
<li class="chapter" data-level="14.3" data-path="information-criteria-14.html"><a href="information-criteria-14.html#a-few-cautionary-notes"><i class="fa fa-check"></i><b>14.3</b> A few cautionary notes</a></li>
<li class="chapter" data-level="14.4" data-path="information-criteria-14.html"><a href="information-criteria-14.html#exercises-13"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Stability Analysis for Differential Equations</b></span></li>
<li class="chapter" data-level="15" data-path="linearsystems-15.html"><a href="linearsystems-15.html"><i class="fa fa-check"></i><b>15</b> Systems of Linear Differential Equations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linearsystems-15.html"><a href="linearsystems-15.html#linear-systems-of-differential-equations-and-matrix-notation"><i class="fa fa-check"></i><b>15.1</b> Linear systems of differential equations and matrix notation</a></li>
<li class="chapter" data-level="15.2" data-path="linearsystems-15.html"><a href="linearsystems-15.html#equilibrium-solutions-1"><i class="fa fa-check"></i><b>15.2</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="15.3" data-path="linearsystems-15.html"><a href="linearsystems-15.html#the-phase-plane"><i class="fa fa-check"></i><b>15.3</b> The phase plane</a></li>
<li class="chapter" data-level="15.4" data-path="linearsystems-15.html"><a href="linearsystems-15.html#non-equilibrium-solutions-and-their-stability"><i class="fa fa-check"></i><b>15.4</b> Non-equilibrium solutions and their stability</a></li>
<li class="chapter" data-level="15.5" data-path="linearsystems-15.html"><a href="linearsystems-15.html#exercises-14"><i class="fa fa-check"></i><b>15.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="nonlinear-16.html"><a href="nonlinear-16.html"><i class="fa fa-check"></i><b>16</b> Systems of Nonlinear Differential Equations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nonlinear-16.html"><a href="nonlinear-16.html#introducing-nonlinear-systems-of-differential-equations"><i class="fa fa-check"></i><b>16.1</b> Introducing nonlinear systems of differential equations</a></li>
<li class="chapter" data-level="16.2" data-path="nonlinear-16.html"><a href="nonlinear-16.html#zooming-in-on-the-phase-plane"><i class="fa fa-check"></i><b>16.2</b> Zooming in on the phase plane</a></li>
<li class="chapter" data-level="16.3" data-path="nonlinear-16.html"><a href="nonlinear-16.html#determining-equilibrium-solutions-with-nullclines"><i class="fa fa-check"></i><b>16.3</b> Determining equilibrium solutions with nullclines</a></li>
<li class="chapter" data-level="16.4" data-path="nonlinear-16.html"><a href="nonlinear-16.html#stability-of-an-equilibrium-solution"><i class="fa fa-check"></i><b>16.4</b> Stability of an equilibrium solution</a></li>
<li class="chapter" data-level="16.5" data-path="nonlinear-16.html"><a href="nonlinear-16.html#graphing-nullclines-in-a-phase-plane"><i class="fa fa-check"></i><b>16.5</b> Graphing nullclines in a phase plane</a></li>
<li class="chapter" data-level="16.6" data-path="nonlinear-16.html"><a href="nonlinear-16.html#exercises-15"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="jacobian-17.html"><a href="jacobian-17.html"><i class="fa fa-check"></i><b>17</b> Local Linearization and the Jacobian</a>
<ul>
<li class="chapter" data-level="17.1" data-path="jacobian-17.html"><a href="jacobian-17.html#competing-populations"><i class="fa fa-check"></i><b>17.1</b> Competing populations</a></li>
<li class="chapter" data-level="17.2" data-path="jacobian-17.html"><a href="jacobian-17.html#tangent-plane-approximations"><i class="fa fa-check"></i><b>17.2</b> Tangent plane approximations</a></li>
<li class="chapter" data-level="17.3" data-path="jacobian-17.html"><a href="jacobian-17.html#the-jacobian-matrix"><i class="fa fa-check"></i><b>17.3</b> The Jacobian matrix</a></li>
<li class="chapter" data-level="17.4" data-path="jacobian-17.html"><a href="jacobian-17.html#exercises-16"><i class="fa fa-check"></i><b>17.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html"><i class="fa fa-check"></i><b>18</b> What are Eigenvalues?</a>
<ul>
<li class="chapter" data-level="18.1" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#introduction"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#straight-line-solutions"><i class="fa fa-check"></i><b>18.2</b> Straight line solutions</a></li>
<li class="chapter" data-level="18.3" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#computing-eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>18.3</b> Computing eigenvalues and eigenvectors</a></li>
<li class="chapter" data-level="18.4" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#what-do-eigenvalues-tell-us"><i class="fa fa-check"></i><b>18.4</b> What do eigenvalues tell us?</a></li>
<li class="chapter" data-level="18.5" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#concluding-thoughts-1"><i class="fa fa-check"></i><b>18.5</b> Concluding thoughts</a></li>
<li class="chapter" data-level="18.6" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#exercises-17"><i class="fa fa-check"></i><b>18.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="stability-19.html"><a href="stability-19.html"><i class="fa fa-check"></i><b>19</b> Qualitative Stability Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="stability-19.html"><a href="stability-19.html#the-characteristic-polynomial-again"><i class="fa fa-check"></i><b>19.1</b> The characteristic polynomial (again)</a></li>
<li class="chapter" data-level="19.2" data-path="stability-19.html"><a href="stability-19.html#stability-with-the-trace-and-determinant"><i class="fa fa-check"></i><b>19.2</b> Stability with the trace and determinant</a></li>
<li class="chapter" data-level="19.3" data-path="stability-19.html"><a href="stability-19.html#a-workflow-for-stability-analysis"><i class="fa fa-check"></i><b>19.3</b> A workflow for stability analysis</a></li>
<li class="chapter" data-level="19.4" data-path="stability-19.html"><a href="stability-19.html#stability-for-higher-order-systems-of-differential-equations."><i class="fa fa-check"></i><b>19.4</b> Stability for higher-order systems of differential equations.</a></li>
<li class="chapter" data-level="19.5" data-path="stability-19.html"><a href="stability-19.html#exercises-18"><i class="fa fa-check"></i><b>19.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bifurcation-20.html"><a href="bifurcation-20.html"><i class="fa fa-check"></i><b>20</b> Bifurcation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="bifurcation-20.html"><a href="bifurcation-20.html#a-series-of-equations"><i class="fa fa-check"></i><b>20.1</b> A series of equations</a></li>
<li class="chapter" data-level="20.2" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-with-systems-of-equations"><i class="fa fa-check"></i><b>20.2</b> Bifurcations with systems of equations</a></li>
<li class="chapter" data-level="20.3" data-path="bifurcation-20.html"><a href="bifurcation-20.html#functions-as-equilibrium-solutions-limit-cycles"><i class="fa fa-check"></i><b>20.3</b> Functions as equilibrium solutions: limit cycles</a></li>
<li class="chapter" data-level="20.4" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-as-analysis-tools"><i class="fa fa-check"></i><b>20.4</b> Bifurcations as analysis tools</a></li>
<li class="chapter" data-level="20.5" data-path="bifurcation-20.html"><a href="bifurcation-20.html#exercises-19"><i class="fa fa-check"></i><b>20.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV Stochastic Differential Equations</b></span></li>
<li class="chapter" data-level="21" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html"><i class="fa fa-check"></i><b>21</b> Stochastic Biological Systems</a>
<ul>
<li class="chapter" data-level="21.1" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#introducing-stochastic-effects"><i class="fa fa-check"></i><b>21.1</b> Introducing stochastic effects</a></li>
<li class="chapter" data-level="21.2" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#a-discrete-dynamical-system"><i class="fa fa-check"></i><b>21.2</b> A discrete dynamical system</a></li>
<li class="chapter" data-level="21.3" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#environmental-stochasticity"><i class="fa fa-check"></i><b>21.3</b> Environmental stochasticity</a></li>
<li class="chapter" data-level="21.4" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#discrete-systems-of-equations"><i class="fa fa-check"></i><b>21.4</b> Discrete systems of equations</a></li>
<li class="chapter" data-level="21.5" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#exercises-20"><i class="fa fa-check"></i><b>21.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html"><i class="fa fa-check"></i><b>22</b> Simulating and Visualizing Randomness</a>
<ul>
<li class="chapter" data-level="22.1" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#ensemble-averages"><i class="fa fa-check"></i><b>22.1</b> Ensemble averages</a></li>
<li class="chapter" data-level="22.2" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#repeated-iteration"><i class="fa fa-check"></i><b>22.2</b> Repeated iteration</a></li>
<li class="chapter" data-level="22.3" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#exercises-21"><i class="fa fa-check"></i><b>22.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="random-walks-23.html"><a href="random-walks-23.html"><i class="fa fa-check"></i><b>23</b> Random Walks</a>
<ul>
<li class="chapter" data-level="23.1" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-on-a-number-line"><i class="fa fa-check"></i><b>23.1</b> Random walk on a number line</a></li>
<li class="chapter" data-level="23.2" data-path="random-walks-23.html"><a href="random-walks-23.html#iteration-and-ensemble-averages"><i class="fa fa-check"></i><b>23.2</b> Iteration and ensemble averages</a></li>
<li class="chapter" data-level="23.3" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-mathematics"><i class="fa fa-check"></i><b>23.3</b> Random walk mathematics</a></li>
<li class="chapter" data-level="23.4" data-path="random-walks-23.html"><a href="random-walks-23.html#continuous-random-walks-and-diffusion"><i class="fa fa-check"></i><b>23.4</b> Continuous random walks and diffusion</a></li>
<li class="chapter" data-level="23.5" data-path="random-walks-23.html"><a href="random-walks-23.html#exercises-22"><i class="fa fa-check"></i><b>23.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="diffusion-24.html"><a href="diffusion-24.html"><i class="fa fa-check"></i><b>24</b> Diffusion and Brownian Motion</a>
<ul>
<li class="chapter" data-level="24.1" data-path="diffusion-24.html"><a href="diffusion-24.html#random-walk-redux"><i class="fa fa-check"></i><b>24.1</b> Random walk redux</a></li>
<li class="chapter" data-level="24.2" data-path="diffusion-24.html"><a href="diffusion-24.html#simulating-brownian-motion"><i class="fa fa-check"></i><b>24.2</b> Simulating Brownian motion</a></li>
<li class="chapter" data-level="24.3" data-path="diffusion-24.html"><a href="diffusion-24.html#exercises-23"><i class="fa fa-check"></i><b>24.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>25</b> Simulating Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="25.1" data-path="sdes-25.html"><a href="sdes-25.html#the-stochastic-logistic-model"><i class="fa fa-check"></i><b>25.1</b> The stochastic logistic model</a></li>
<li class="chapter" data-level="25.2" data-path="sdes-25.html"><a href="sdes-25.html#the-euler-maruyama-method"><i class="fa fa-check"></i><b>25.2</b> The Euler-Maruyama method</a></li>
<li class="chapter" data-level="25.3" data-path="sdes-25.html"><a href="sdes-25.html#adding-stochasticity-to-parameters"><i class="fa fa-check"></i><b>25.3</b> Adding stochasticity to parameters</a></li>
<li class="chapter" data-level="25.4" data-path="sdes-25.html"><a href="sdes-25.html#systems-of-stochastic-differential-equations"><i class="fa fa-check"></i><b>25.4</b> Systems of stochastic differential equations</a></li>
<li class="chapter" data-level="25.5" data-path="sdes-25.html"><a href="sdes-25.html#concluding-thoughts-2"><i class="fa fa-check"></i><b>25.5</b> Concluding thoughts</a></li>
<li class="chapter" data-level="25.6" data-path="sdes-25.html"><a href="sdes-25.html#exercises-24"><i class="fa fa-check"></i><b>25.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html"><i class="fa fa-check"></i><b>26</b> Statistics of a Stochastic Differential Equation</a>
<ul>
<li class="chapter" data-level="26.1" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#expected-value-of-a-stochastic-process"><i class="fa fa-check"></i><b>26.1</b> Expected value of a stochastic process</a></li>
<li class="chapter" data-level="26.2" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#birth-death-processes"><i class="fa fa-check"></i><b>26.2</b> Birth-death processes</a></li>
<li class="chapter" data-level="26.3" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#wrapping-up"><i class="fa fa-check"></i><b>26.3</b> Wrapping up</a></li>
<li class="chapter" data-level="26.4" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#exercises-25"><i class="fa fa-check"></i><b>26.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>27</b> Solutions to Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="27.1" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#meet-the-fokker-planck-equation"><i class="fa fa-check"></i><b>27.1</b> Meet the Fokker-Planck equation</a></li>
<li class="chapter" data-level="27.2" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#deterministically-the-end"><i class="fa fa-check"></i><b>27.2</b> Deterministically the end</a></li>
<li class="chapter" data-level="27.3" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#exercises-26"><i class="fa fa-check"></i><b>27.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Modeling with Data and Differential Equations Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="diffusion-24" class="section level1 hasAnchor" number="24">
<h1><span class="header-section-number">Chapter 24</span> Diffusion and Brownian Motion<a href="diffusion-24.html#diffusion-24" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Studying random walks in Chapter <a href="random-walks-23.html#random-walks-23">23</a> led to some surprising results, namely that for an unbiased random walk the mean displacement was zero but the variance increased proportional to the step number. In this chapter we will revisit the random walk problem from another perspective that further strengthens its connection to understanding diffusion. Let’s get started!</p>
<div id="random-walk-redux" class="section level2 hasAnchor" number="24.1">
<h2><span class="header-section-number">24.1</span> Random walk redux<a href="diffusion-24.html#random-walk-redux" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The random walk derivation in Chapter <a href="random-walks-23.html#random-walks-23">23</a> focused on the <em>position</em> of a particle on the random walk, based upon prescribed rules of moving to the left and the right. To revisit this random walk we consider the <em>probability</em> (between 0 and 1) that a particle is at position <span class="math inline">\(x\)</span> in time <span class="math inline">\(t\)</span>, denoted as <span class="math inline">\(p(x,t)\)</span>. In other words, rather than focusing on where the particle <em>is</em>, we focus on the <em>chance</em> that the particle will be at a given spot.</p>
<p>A way to conceptualize a random walk is that any given position <span class="math inline">\(x\)</span>, a particle can arrive to that position from either the left or the right (Figure <a href="diffusion-24.html#fig:random-walk-24">24.1</a>):</p>
<div class="figure"><span style="display:block;" id="fig:random-walk-24"></span>
<img src="explore-model-zobitz-220419_files/figure-html/random-walk-24-1.png" alt="Schematic diagram for the one-dimensional random walk." width="672" />
<p class="caption">
FIGURE 24.1: Schematic diagram for the one-dimensional random walk.
</p>
</div>
<p>We can generalize Figure <a href="diffusion-24.html#fig:random-walk-24">24.1</a> further where the particle moves in increments <span class="math inline">\(\Delta x\)</span>, as defined in Equation <a href="diffusion-24.html#eq:master-diff">(24.1)</a>:</p>
<p><span class="math display" id="eq:master-diff">\[\begin{equation}
p(x,t+\Delta t) = \frac{1}{2} p(x-\Delta x,t) + \frac{1}{2} p(x+\Delta x,t) \tag{24.1}
\end{equation}\]</span></p>
<p>To analyze Equation <a href="diffusion-24.html#eq:master-diff">(24.1)</a> we apply Taylor approximations on each side of Equation <a href="diffusion-24.html#eq:master-diff">(24.1)</a>. First let’s do a locally linear approximation for <span class="math inline">\(p(x,t+\Delta t)\)</span>:</p>
<p><span class="math display">\[\begin{equation}
p(x,t+\Delta t)  \approx p(x,t) + \Delta t \cdot p_{t},
\end{equation}\]</span></p>
<p>where we have dropped the shorthand <span class="math inline">\(p_{t}(x,t)\)</span> as <span class="math inline">\(p_{t}\)</span>. On the right hand side of Equation <a href="diffusion-24.html#eq:master-diff">(24.1)</a> we will compute the 2nd degree (quadratic) Taylor polynomial:</p>
<p><span class="math display">\[\begin{align*}
\frac{1}{2} p(x-\Delta x,t)  &amp; \approx \frac{1}{2} p(x,t) -   \frac{1}{2} \Delta x \cdot p_{x} + \frac{1}{4} (\Delta x)^{2}\cdot  p_{xx} \\
\frac{1}{2} p(x+\Delta x,t)  &amp; \approx \frac{1}{2} p(x,t) +   \frac{1}{2} \Delta x \cdot p_{x} + \frac{1}{4} (\Delta x)^{2} \cdot p_{xx}
\end{align*}\]</span></p>
<p>With these approximations we can re-write Equation <a href="diffusion-24.html#eq:master-diff">(24.1)</a> as Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a>:</p>
<p><span class="math display" id="eq:new-master-diff">\[\begin{equation}
\Delta t \cdot p_{t} = \frac{1}{2} (\Delta x)^{2} p_{xx} \rightarrow  p_{t} = \frac{1}{2} \frac{(\Delta x)^{2}}{\Delta t} \cdot p_{xx} \tag{24.2}
\end{equation}\]</span></p>
<p>Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a> is called a partial differential equation - what this means is that it is a differential equation with derivatives that depend on two variables (<span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span> (two derivatives). As studied in Chapter <a href="random-walks-23.html#random-walks-23">23</a>, Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a> is called the <strong>diffusion equation</strong>. In Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a> we can also define <span class="math inline">\(\displaystyle D = \frac{1}{2} \frac{(\Delta x)^{2}}{\Delta t}\)</span> so <span class="math inline">\(p_{t}=D \cdot p_{xx}\)</span>.</p>
<p>The solution to Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a> is given by Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a>.<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a></p>
<p><span class="math display" id="eq:diff-eq-soln">\[\begin{equation}
p(x,t) = \frac{1}{\sqrt{4 \pi Dt} } e^{-x^{2}/(4 D t)} \tag{24.3}
\end{equation}\]</span></p>
<p>What Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> represents is the probability that the particle is at the position <span class="math inline">\(x\)</span> at time <span class="math inline">\(t\)</span>. Figure <a href="diffusion-24.html#fig:diffusion-profile">24.2</a> shows <em>profiles</em> for <span class="math inline">\(p(x,t)\)</span> when <span class="math inline">\(D=0.5\)</span> at different values of <span class="math inline">\(t\)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:diffusion-profile"></span>
<img src="explore-model-zobitz-220419_files/figure-html/diffusion-profile-1.png" alt="Profiles of $p(x,t)$ (Equation \@ref(eq:diff-eq-soln)) for different values of $t$ with $D = 0.5$." width="672" />
<p class="caption">
FIGURE 24.2: Profiles of <span class="math inline">\(p(x,t)\)</span> (Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a>) for different values of <span class="math inline">\(t\)</span> with <span class="math inline">\(D = 0.5\)</span>.
</p>
</div>
<p>As you can see, as time increases the graph of <span class="math inline">\(p(x,t)\)</span> gets flatter - or more uniform. What this tells you is that the longer <span class="math inline">\(t\)</span> increases it is less likely to find the particle at the origin.</p>
<div id="verifying-the-solution-to-the-diffusion-equation" class="section level3 hasAnchor" number="24.1.1">
<h3><span class="header-section-number">24.1.1</span> Verifying the solution to the diffusion equation<a href="diffusion-24.html#verifying-the-solution-to-the-diffusion-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Verifying that Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> is the solution to Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a> is a good review of your multivariable calculus skills! As a first step to verifying this solution, let’s take the partial derivative with respect to <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span>.</p>
<p>First we will compute the partial derivative of <span class="math inline">\(p\)</span> with respect to the variable <span class="math inline">\(x\)</span> (represented as <span class="math inline">\(p_{x}\)</span>):</p>
<p><span class="math display">\[\begin{align*}
p_{x} &amp;= \frac{\partial }{\partial x} \left( \frac{1}{\sqrt{4 \pi Dt} } e^{-x^{2}/(4 D t)} \right) \\
&amp;= \frac{1}{\sqrt{4 \pi Dt} } e^{-x^{2}/(4 D t)} \cdot \frac{-2x}{4Dt}
\end{align*}\]</span></p>
<p>Notice something interesting here: <span class="math inline">\(\displaystyle p_{x} = p(x,t) \cdot \left( \frac{-x}{2Dt} \right)\)</span>.</p>
<p>To compute the second derivative, we have the following expressions by applying the product rule:</p>
<p><span class="math display">\[\begin{align*}
p_{xx} &amp;= p_{x} \cdot \left( \frac{-x}{2Dt} \right) - p(x,t) \cdot \left( \frac{1}{2Dt} \right) \\
&amp;= p(x,t) \cdot \left( \frac{-x}{2Dt} \right) \cdot \left( \frac{-x}{2Dt} \right)- p(x,t) \cdot \left( \frac{1}{2Dt} \right) \\
&amp;= p(x,t) \left( \left( \frac{-x}{2Dt} \right)^{2} - \left( \frac{1}{2Dt} \right) \right) \\
&amp;= p(x,t) \left( \frac{x^{2}-2Dt}{(2Dt)^{2}}\right).
\end{align*}\]</span></p>
<p>So far so good. Now computing <span class="math inline">\(p_{t}\)</span> gets a little tricky because this derivative involves both the product rule with the chain rule in two places (the variable <span class="math inline">\(t\)</span> appears twice in the formula for <span class="math inline">\(p(x,t)\)</span>). To aid in computing the derivative we identify two functions <span class="math inline">\(\displaystyle f(t) = (4 \pi D t)^{-1/2}\)</span> and <span class="math inline">\(\displaystyle g(t) = -x^{2} \cdot (4Dt)^{-1}\)</span>. This changes <span class="math inline">\(p(x,t)\)</span> into <span class="math inline">\(p(x,t) = f(t) \cdot e^{g(t)}\)</span>. In this way <span class="math inline">\(p_{t} = f&#39;(t) \cdot e^{g(t)} + f(t) \cdot e^{g(t)} \cdot g&#39;(t)\)</span>. Now we can focus on computing the individual derivatives <span class="math inline">\(f&#39;(t)\)</span> and <span class="math inline">\(g&#39;(t)\)</span> (after simplification - be sure to verify these on your own!):</p>
<p><span class="math display">\[\begin{align*}
f&#39;(t) &amp;= -\frac{1}{2} (4 \pi D t)^{-3/2} \cdot 4 \pi D = -2\pi D \; (4 \pi D t)^{-3/2}  \\
g&#39;(t) &amp;= x^{2}\; (4Dt)^{-2} 4D = \frac{x^{2}}{4Dt^{2}}
\end{align*}\]</span></p>
<p>Assembling these results together, we have the following:</p>
<p><span class="math display">\[\begin{align*}
p_{t} &amp;= f&#39;(t) \cdot e^{g(t)} + f(t) \cdot e^{g(t)} \cdot g&#39;(t) \\
&amp;= -2\pi D \; (4 \pi D t)^{-3/2} \cdot e^{-x^{2}/(4 D t)}  + \frac{1}{\sqrt{4 \pi Dt} } \cdot e^{-x^{2}/(4 D t)} \cdot \frac{x^{2}}{4Dt^{2}} \\
&amp;= \frac{1}{\sqrt{4 \pi Dt} } \cdot e^{-x^{2}/(4 D t)} \left( -2 \pi D \; (4 \pi D t)^{-1} +  \frac{x^{2}}{4Dt^{2}} \right) \\
&amp;= \frac{1}{\sqrt{4 \pi Dt} } \cdot e^{-x^{2}/(4 D t)} \left( -\frac{1}{2t} +  \frac{x^{2}}{4Dt^{2}} \right) \\
&amp;= p(x,t)  \left( -\frac{1}{2t} +  \frac{x^{2}}{4Dt^{2}} \right)
\end{align*}\]</span></p>
<p>Wow. Verifying that Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> is a solution to the diffusion equation is getting complicated, but also notice that through algebraic simplification, <span class="math inline">\(\displaystyle p_{t} = p(x,t) \left(\frac{x^{2}-2Dt}{4Dt^{2}} \right)\)</span>. When we compare <span class="math inline">\(p_{t}\)</span> to <span class="math inline">\(D p_{xx}\)</span>, they are equal!</p>
<p>The connections between diffusion and probability are so strong. Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> is related to the formula for a normal probability density function (Equation <a href="likelihood-09.html#eq:normal-09">(9.1)</a> from Chapter <a href="likelihood-09.html#likelihood-09">9</a>)! In this case, the standard deviation in Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> equals <span class="math inline">\(\sqrt{2Dt}\)</span> and is time dependent (see Exercise <a href="diffusion-24.html#exr:normal-compare">24.2</a>). Even though we approached the random walk differently here compared to Chapter <a href="random-walks-23.html#random-walks-23">23</a>, we also saw that the variance grew proportional to the time spent, so there is some consistency.</p>
</div>
</div>
<div id="simulating-brownian-motion" class="section level2 hasAnchor" number="24.2">
<h2><span class="header-section-number">24.2</span> Simulating Brownian motion<a href="diffusion-24.html#simulating-brownian-motion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another name for the process of a particle undergoing small random movements is <em>Brownian Motion</em>. We can simulate Brownian motion similar to the random walk as discussed in Chapter <a href="random-walks-23.html#random-walks-23">23</a>. Brownian motion is connected to the diffusion equation (Equation <a href="diffusion-24.html#eq:new-master-diff">(24.2)</a>) and its solution (Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a>). These connections are helpful when simulating stochastic differential equations. To simulate Brownian motion we will also apply the workflow from Chapter <a href="stoch-sim-22.html#stoch-sim-22">22</a> (Do once <span class="math inline">\(\rightarrow\)</span> Do several times <span class="math inline">\(\rightarrow\)</span> Summarize <span class="math inline">\(\rightarrow\)</span> Visualize).</p>
<div id="do-once-1" class="section level3 hasAnchor" number="24.2.1">
<h3><span class="header-section-number">24.2.1</span> Do once<a href="diffusion-24.html#do-once-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First we define a function called <code>brownian_motion</code> that will compute a sample path given the:</p>
<ul>
<li>number of steps to run the stochastic process;</li>
<li>diffusion coefficient <span class="math inline">\(D\)</span>;</li>
<li>timestep <span class="math inline">\(\Delta t\)</span>;</li>
</ul>
<p>a sample path will be computed (see Figure <a href="diffusion-24.html#fig:sample-brownian">24.3</a>).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="diffusion-24.html#cb100-1" tabindex="-1"></a>brownian_motion <span class="ot">&lt;-</span> <span class="cf">function</span>(number_steps, D, deltaT) {</span>
<span id="cb100-2"><a href="diffusion-24.html#cb100-2" tabindex="-1"></a>  <span class="co"># D: diffusion coefficient</span></span>
<span id="cb100-3"><a href="diffusion-24.html#cb100-3" tabindex="-1"></a>  <span class="co"># deltaT: timestep length</span></span>
<span id="cb100-4"><a href="diffusion-24.html#cb100-4" tabindex="-1"></a>  <span class="do">### Set up vector of results</span></span>
<span id="cb100-5"><a href="diffusion-24.html#cb100-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> number_steps)</span>
<span id="cb100-6"><a href="diffusion-24.html#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="diffusion-24.html#cb100-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>number_steps) {</span>
<span id="cb100-8"><a href="diffusion-24.html#cb100-8" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> D <span class="sc">*</span> deltaT) <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb100-9"><a href="diffusion-24.html#cb100-9" tabindex="-1"></a>  }</span>
<span id="cb100-10"><a href="diffusion-24.html#cb100-10" tabindex="-1"></a></span>
<span id="cb100-11"><a href="diffusion-24.html#cb100-11" tabindex="-1"></a>  out_x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">t =</span> <span class="dv">0</span><span class="sc">:</span>(number_steps <span class="sc">-</span> <span class="dv">1</span>), x)</span>
<span id="cb100-12"><a href="diffusion-24.html#cb100-12" tabindex="-1"></a>  <span class="fu">return</span>(out_x)</span>
<span id="cb100-13"><a href="diffusion-24.html#cb100-13" tabindex="-1"></a>}</span>
<span id="cb100-14"><a href="diffusion-24.html#cb100-14" tabindex="-1"></a></span>
<span id="cb100-15"><a href="diffusion-24.html#cb100-15" tabindex="-1"></a><span class="co"># Run a sample trajectory and plot</span></span>
<span id="cb100-16"><a href="diffusion-24.html#cb100-16" tabindex="-1"></a>try1 <span class="ot">&lt;-</span> <span class="fu">brownian_motion</span>(<span class="dv">100</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb100-17"><a href="diffusion-24.html#cb100-17" tabindex="-1"></a></span>
<span id="cb100-18"><a href="diffusion-24.html#cb100-18" tabindex="-1"></a><span class="fu">plot</span>(try1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sample-brownian"></span>
<img src="explore-model-zobitz-220419_files/figure-html/sample-brownian-1.png" alt="Sample trajectory for a realization of Brownian motion. The horizontal axis represents a step of the random walk." width="672" />
<p class="caption">
FIGURE 24.3: Sample trajectory for a realization of Brownian motion. The horizontal axis represents a step of the random walk.
</p>
</div>
</div>
<div id="do-several-times-1" class="section level3 hasAnchor" number="24.2.2">
<h3><span class="header-section-number">24.2.2</span> Do several times<a href="diffusion-24.html#do-several-times-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we have the function for Brownian motion defined we can then run this process several times and plot the spaghetti plot (try the following code out on your own):</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="diffusion-24.html#cb101-1" tabindex="-1"></a>number_steps <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co"># Then number of steps in random walk</span></span>
<span id="cb101-2"><a href="diffusion-24.html#cb101-2" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># The value of the diffusion coefficient</span></span>
<span id="cb101-3"><a href="diffusion-24.html#cb101-3" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># The timestep length</span></span>
<span id="cb101-4"><a href="diffusion-24.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="diffusion-24.html#cb101-5" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># The number of simulations</span></span>
<span id="cb101-6"><a href="diffusion-24.html#cb101-6" tabindex="-1"></a></span>
<span id="cb101-7"><a href="diffusion-24.html#cb101-7" tabindex="-1"></a><span class="co"># Compute solutions</span></span>
<span id="cb101-8"><a href="diffusion-24.html#cb101-8" tabindex="-1"></a>brownian_motion_sim <span class="ot">&lt;-</span> <span class="fu">rerun</span>(n_sims) <span class="sc">%&gt;%</span></span>
<span id="cb101-9"><a href="diffusion-24.html#cb101-9" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">paste0</span>(<span class="st">&quot;sim&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_sims)) <span class="sc">%&gt;%</span></span>
<span id="cb101-10"><a href="diffusion-24.html#cb101-10" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">brownian_motion</span>(number_steps, D, dt)) <span class="sc">%&gt;%</span></span>
<span id="cb101-11"><a href="diffusion-24.html#cb101-11" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span>.x, <span class="at">.id =</span> <span class="st">&quot;simulation&quot;</span>)</span>
<span id="cb101-12"><a href="diffusion-24.html#cb101-12" tabindex="-1"></a></span>
<span id="cb101-13"><a href="diffusion-24.html#cb101-13" tabindex="-1"></a><span class="co"># Plot these all together</span></span>
<span id="cb101-14"><a href="diffusion-24.html#cb101-14" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> brownian_motion_sim, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb101-15"><a href="diffusion-24.html#cb101-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> simulation)) <span class="sc">+</span></span>
<span id="cb101-16"><a href="diffusion-24.html#cb101-16" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Random Walk&quot;</span>) <span class="sc">+</span></span>
<span id="cb101-17"><a href="diffusion-24.html#cb101-17" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</div>
<div id="summarize-and-visualize" class="section level3 hasAnchor" number="24.2.3">
<h3><span class="header-section-number">24.2.3</span> Summarize and visualize<a href="diffusion-24.html#summarize-and-visualize" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, the 95% confidence interval is computed and plotted in Figure <a href="diffusion-24.html#fig:ensemble-ave-24">24.4</a>, using similar code from Chapter <a href="stoch-sim-22.html#stoch-sim-22">22</a> to compute the ensemble average. Note that the horizontal axis is time so each step is scaled by <code>dt</code>.</p>
<div class="figure"><span style="display:block;" id="fig:ensemble-ave-24"></span>
<img src="explore-model-zobitz-220419_files/figure-html/ensemble-ave-24-1.png" alt="Ensemble average of 500 simulations for the random walk. Each step on the horizontal axis is scaled by `dt`." width="672" />
<p class="caption">
FIGURE 24.4: Ensemble average of 500 simulations for the random walk. Each step on the horizontal axis is scaled by <code>dt</code>.
</p>
</div>
<p>I sure hope the results are very similar to ones generated in Chapter <a href="random-walks-23.html#random-walks-23">23</a> (especially Figure <a href="random-walks-23.html#fig:ensemble-ave-23">23.3</a>) - this is no coincidence! With the ideas of a random walk developed here and in Chapter <a href="random-walks-23.html#random-walks-23">23</a>, we will now be able to understand and simulate how small changes in a variable or parameter affect the solutions to a differential equation. Looking ahead to Chapters <a href="sdes-25.html#sdes-25">25</a> and <a href="simul-stoch-26.html#simul-stoch-26">26</a>, we will simulate stochastic processes using numerical methods (Euler’s method in Chapter <a href="euler-04.html#euler-04">4</a>) with Brownian motion. Onward!</p>
</div>
</div>
<div id="exercises-23" class="section level2 hasAnchor" number="24.3">
<h2><span class="header-section-number">24.3</span> Exercises<a href="diffusion-24.html#exercises-23" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unnamed-chunk-288" class="exercise"><strong>Exercise 24.1  </strong></span>Through direct computation, verify the following calculations:</p>
<ol style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\displaystyle f(t)=\frac{1}{\sqrt{4 \pi Dt} }\)</span>, then <span class="math inline">\(\displaystyle f&#39;(t)=-2\pi D (4 \pi D t)^{-3/2}\)</span></li>
<li>When <span class="math inline">\(\displaystyle g(t)=\frac{-x^{2}}{4Dt}\)</span>, then <span class="math inline">\(\displaystyle g&#39;(t)=\frac{x^{2}}{4Dt^{2}}\)</span></li>
<li>Verify that <span class="math inline">\(\displaystyle \left( -\frac{1}{2t} + \frac{x^{2}}{4Dt^{2}} \right)= \left( \frac{x^{2}-2Dt}{(2Dt)^{2}}\right)\)</span></li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:normal-compare" class="exercise"><strong>Exercise 24.2  </strong></span>The equation for the normal distribution is <span class="math inline">\(\displaystyle f(x)=\frac{1}{\sqrt{2 \pi} \sigma } e^{-(x-\mu)^{2}/(2 \sigma^{2})}\)</span>, with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^{2}\)</span>. Examine the formula for the diffusion equation (Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a>) and compare it to the formula for the normal distribution. If Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> represents a normal distribution, what do <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^{2}\)</span> equal?</p>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-289" class="exercise"><strong>Exercise 24.3  </strong></span>For this problem you will investigate <span class="math inline">\(p(x,t)\)</span> (Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a>) with <span class="math inline">\(\displaystyle D=\frac{1}{2}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Evaluate <span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,10) \; dx\)</span>. Write a one sentence description of what this quantity represents.</li>
<li>Using desmos or some other numerical integrator, complete the following table:</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center"><strong>Equation</strong></th>
<th align="center"><strong>Result</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,10) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,5) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,2.5) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,1) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,0.1) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,0.01) \; dx=\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\displaystyle \int_{-1}^{1} p(x,0.001) \; dx=\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: lower-alpha">
<li>Based on the evidence from your table, what would you say is the value of <span class="math inline">\(\displaystyle \lim_{t \rightarrow 0^{+}} \int_{-1}^{1} p(x,t) \; dx\)</span>?</li>
<li>Now make graphs of <span class="math inline">\(p(x,t)\)</span> at each of the values of <span class="math inline">\(t\)</span> in your table. What would you say is occuring in the graph as <span class="math inline">\(\displaystyle \lim_{t \rightarrow 0^{+}} p(x,t)\)</span>? Does anything surprise you? (The results you computed here lead to the foundation of what is called the Dirac delta function.)</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-290" class="exercise"><strong>Exercise 24.4  </strong></span>Consider the function <span class="math inline">\(\displaystyle p(x,t) = \frac{1}{\sqrt{4 \pi D t}} e^{-x^{2}/(4 D t)}\)</span>. Let <span class="math inline">\(x=1\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Explain in your own words what the graph <span class="math inline">\(p(1,t)\)</span> represents as a function of <span class="math inline">\(t\)</span>.</li>
<li>Graph several profiles of <span class="math inline">\(p(1,t)\)</span> when <span class="math inline">\(D = 1\)</span>, <span class="math inline">\(2\)</span>, and <span class="math inline">\(0.1\)</span>. How does the value of <span class="math inline">\(D\)</span> affect the profile?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-291" class="exercise"><strong>Exercise 24.5  </strong></span>In statistics an approximation for the 95% confidence interval is twice the standard deviation. Confirm this by adding the curve <span class="math inline">\(y=2\sqrt{2Dt}\)</span> to the ensemble average plot in Figure 24.4. Recall that <span class="math inline">\(D\)</span> was equal to <span class="math inline">\(0.5\)</span> and <span class="math inline">\(\Delta t = 0.1\)</span>, so the horizontal axis will need to be scaled appropriately.</p>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-292" class="exercise"><strong>Exercise 24.6  </strong></span>Consider the function <span class="math inline">\(\displaystyle p(x,t) = \frac{1}{\sqrt{\pi t}} e^{-x^{2}/t}\)</span>:</p>
<ol style="list-style-type: lower-alpha">
<li>Using your differentiation skills compute the partial derivatives <span class="math inline">\(p_{t}\)</span>, <span class="math inline">\(p_{x}\)</span>, and <span class="math inline">\(p_{xx}\)</span>.</li>
<li>Verify <span class="math inline">\(p(x,t)\)</span> is consistent with the diffusion equation <span class="math inline">\(\displaystyle p_{t}=\frac{1}{4} p_{xx}\)</span>.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-293" class="exercise"><strong>Exercise 24.7  </strong></span>Modify the code used to generate Figure <a href="diffusion-24.html#fig:ensemble-ave-24">24.4</a> with <span class="math inline">\(D=10, \; 1, \; 0.1, \; 0.01\)</span>. Generally speaking, what happens to the resulting ensemble average when <span class="math inline">\(D\)</span> is small or large? In which scenarios are stochastic effects more prevalent?</p>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-294" class="exercise"><strong>Exercise 24.8  </strong></span>For the one-dimensional random walk we discussed where there was an equal chance of moving to the left or the right. Here is a variation on this problem.</p>
<p>Let’s assume there is a chance <span class="math inline">\(v\)</span> that it moves to the left (position <span class="math inline">\(x - \Delta x\)</span>), and therefore a chance is <span class="math inline">\(1-v\)</span> that the particle remains at position <span class="math inline">\(x\)</span>. The basic equation that describes the particle’s position at position <span class="math inline">\(x\)</span> and time <span class="math inline">\(t + \Delta t\)</span> is:</p>
<p><span class="math display">\[\begin{equation}
p(x,t + \Delta t) = (1-v) \cdot p(x,t) + v \cdot p(x- \Delta x,t)
\end{equation}\]</span></p>
<p>Apply the techniques of local linearization in <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span> to show that this random walk is used to derive the following partial differential equation, called the <em>advection equation</em>:</p>
<p><span class="math display">\[\begin{equation}
p_{t} = - \left( v \cdot \frac{ \Delta x}{\Delta t} \right) \cdot p_{x}
\end{equation}\]</span></p>
<p><em>Note: you only need to expand this equation to first order</em></p>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-295" class="exercise"><strong>Exercise 24.9  </strong></span>Complete Exercise <a href="random-walks-23.html#exr:random-2d-23">23.9</a> if you haven’t already. If Equation <a href="diffusion-24.html#eq:diff-eq-soln">(24.3)</a> (a normal distribution) is the solution to the one-dimensional diffusion equation, what do you think the solution would be in the bivariate case?</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-keener_biology_2021" class="csl-entry">
Keener, James P. 2021. <em>Biology in <span>Time</span> and <span>Space</span>: <span>A Partial Differential Equation Modeling Approach</span></em>. <span>Providence, Rhode Island</span>: <span>American Mathematical Society</span>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="49">
<li id="fn49"><p>Determining an exact solution to the diffusion equation requires more study in techniques of partial differential equations (see <span class="citation">J. P. Keener (<a href="#ref-keener_biology_2021">2021</a>)</span>).<a href="diffusion-24.html#fnref49" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random-walks-23.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sdes-25.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/24-diffusion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/24-diffusion.Rmd",
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
