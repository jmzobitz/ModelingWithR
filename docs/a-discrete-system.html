<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 A discrete system | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 A discrete system | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 A discrete system | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-08-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stoch-sys-21.html"/>
<link rel="next" href="environmental-stochasticity.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="computational-code.html"><a href="computational-code.html"><i class="fa fa-check"></i><b>1.1</b> Computational code</a></li>
<li class="chapter" data-level="1.2" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i><b>1.2</b> Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Stochastic Differential Equations</b></span></li>
<li class="chapter" data-level="2" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html"><i class="fa fa-check"></i><b>2</b> Stochastic Biological Systems</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-discrete-system.html"><a href="a-discrete-system.html"><i class="fa fa-check"></i><b>2.1</b> A discrete system</a></li>
<li class="chapter" data-level="2.2" data-path="environmental-stochasticity.html"><a href="environmental-stochasticity.html"><i class="fa fa-check"></i><b>2.2</b> Environmental Stochasticity</a></li>
<li class="chapter" data-level="2.3" data-path="discrete-systems-of-equations.html"><a href="discrete-systems-of-equations.html"><i class="fa fa-check"></i><b>2.3</b> Discrete systems of equations</a></li>
<li class="chapter" data-level="2.4" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-discrete-system" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> A discrete system</h2>
<p>Let’s focus on an example that involves discrete populations. Moose are large animals (part of the deer family) weighing 1000 pounds that can be found in Northern Minnesota <a href="https://www.dnr.state.mn.us/mammals/moose.html">link</a>. Here is a picture of a moose: <a href="https://images.dnr.state.mn.us/natural_resources/snapshots/mammals/1moose.jpg">link</a>. While in the early 2000’s the population of the moose was 8000, recent estimates have the numbers at 3000, although that seems to have stabilized <a href="https://files.dnr.state.mn.us/wildlife/moose/moosesurvey.pdf">link</a></p>
<p>A starting model that describes their population dynamics is the discrete dynamical system:</p>
<p><span class="math display" id="eq:moose">\[\begin{equation}
M_{t+1} = M_{t} + b \cdot M_{t} - d \cdot M_{t}, \tag{2.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(M_{t}\)</span> is the population of the moose in year <span class="math inline">\(t\)</span>, and <span class="math inline">\(b\)</span> the birth rate and <span class="math inline">\(d\)</span> the death rate. This equation can be reduced down to <span class="math inline">\(M_{t+1}=r M_{t}\)</span> where <span class="math inline">\(r=1+b-d\)</span> is the net birth/death rate. This model states that the population of moose in the next year equals the current population, added to any fraction of births and taking away any deaths.</p>
<p>This discrete dynamical system is a little bit different from a continuous dynamical system, but can be simulated pretty easily by defining a function.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="a-discrete-system.html#cb1-1" aria-hidden="true" tabindex="-1"></a>M0 <span class="ot">&lt;-</span> <span class="dv">3000</span>  <span class="co"># Initial population of moose</span></span>
<span id="cb1-2"><a href="a-discrete-system.html#cb1-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># Number of years we simulate</span></span>
<span id="cb1-3"><a href="a-discrete-system.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="a-discrete-system.html#cb1-4" aria-hidden="true" tabindex="-1"></a>moose <span class="ot">&lt;-</span> <span class="cf">function</span>(r) {</span>
<span id="cb1-5"><a href="a-discrete-system.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  out_moose <span class="ot">&lt;-</span> <span class="fu">array</span>(M0,<span class="at">dim=</span>N)</span>
<span id="cb1-6"><a href="a-discrete-system.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-1</span>)) {</span>
<span id="cb1-7"><a href="a-discrete-system.html#cb1-7" aria-hidden="true" tabindex="-1"></a>    out_moose[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> r<span class="sc">*</span>out_moose[i]</span>
<span id="cb1-8"><a href="a-discrete-system.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-9"><a href="a-discrete-system.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_moose)</span>
<span id="cb1-10"><a href="a-discrete-system.html#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice how the function <code>moose</code> returns the current population of moose after <span class="math inline">\(N\)</span> years with the net birth rate <span class="math inline">\(r\)</span>. Let’s take a look at the results for different values of <span class="math inline">\(r\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="a-discrete-system.html#cb2-1" aria-hidden="true" tabindex="-1"></a>moose_rates <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">years =</span> <span class="dv">1</span><span class="sc">:</span>N,</span>
<span id="cb2-2"><a href="a-discrete-system.html#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0.4 =</span> <span class="fu">moose</span>(<span class="fl">0.4</span>),</span>
<span id="cb2-3"><a href="a-discrete-system.html#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0.8 =</span> <span class="fu">moose</span>(<span class="fl">0.8</span>),</span>
<span id="cb2-4"><a href="a-discrete-system.html#cb2-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r1.1 =</span> <span class="fu">moose</span>(<span class="fl">1.1</span>))</span>
<span id="cb2-5"><a href="a-discrete-system.html#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="a-discrete-system.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="a-discrete-system.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> moose_rates) <span class="sc">+</span></span>
<span id="cb2-8"><a href="a-discrete-system.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>years,<span class="at">y=</span>r0<span class="fl">.4</span>),<span class="at">color=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="a-discrete-system.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>years,<span class="at">y=</span>r0<span class="fl">.8</span>),<span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="a-discrete-system.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>years,<span class="at">y=</span>r1<span class="fl">.1</span>),<span class="at">color=</span><span class="st">&#39;green&#39;</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="a-discrete-system.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Years&#39;</span>,</span>
<span id="cb2-12"><a href="a-discrete-system.html#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&#39;Moose&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="series_files/figure-html/unnamed-chunk-4-1.png" alt="Simulation of the moose population with different birth rates." width="384" />
<p class="caption">
Figure 2.1: Simulation of the moose population with different birth rates.
</p>
</div>
<p>Let’s remind ourselves of what is going on in the code.</p>
<ul>
<li><code>out_moose &lt;- tibble...</code> creates a data frame that we can use for plotting. We call several different instances of the <code>moose</code> code for different net birth rates. I’ve decided to label each of those instances with the value of the birth rate <em>r</em> for reference.</li>
<li>The command <code>geom_line</code> makes a line plot. Remember that we need to specify both the x (horizontal) and y (vertical) axes. I specified the different colors to distinguish the different birth rates.</li>
</ul>
<p>Notice how for some values of <span class="math inline">\(r\)</span> the population starts to decline, stay the same, or increase. Let’s analyze this system a little more. Just like with a continuous differential equation we want to look for solutions that are in steady state, or ones were the population is staying the same. In other words this means that <span class="math inline">\(M_{t+1}=M_{t}\)</span>, or <span class="math inline">\(M_{t}=rM_{t}\)</span>. If we simplify this expression this means that <span class="math inline">\(M_{t}-r M_{t}=0\)</span>, or <span class="math inline">\((r-1)M_{t}=0\)</span>. Assuming that <span class="math inline">\(M_{t}\)</span> is not equal to zero, then this equation is consistent only when <span class="math inline">\(r=1\)</span>. This makes sense: we know <span class="math inline">\(r=1-b-d\)</span>, so the only way this can be one is if <span class="math inline">\(b=d\)</span>, or the births balance out the deaths.</p>
<p>Ok, so we found our equilibrium solution. What is the general form of this solution? Just like when we were solving continuous systems and we assumed an exponential solution we will do the same here, but this time we represent the solution as <span class="math inline">\(M_{t}=A\cdot v^{t}\)</span>, which is an exponential equation. Since we have <span class="math inline">\(M_{0}=3000\)</span>, then <span class="math inline">\(A=3000\)</span>. Plugging this expression into our equation we have:</p>
<p><span class="math display">\[\begin{equation}
100 \cdot v^{t+1} = r 3000 \cdot v^{t}
\end{equation}\]</span></p>
<p>Our goal is to figure out a value for <span class="math inline">\(v\)</span> that is consistent with this expression. Just like we did with the equilibrium solution we can arrange to the following equation, using the fact that <span class="math inline">\(v^{t+1}=v^{t}\cdot v\)</span>:</p>
<p><span class="math display">\[\begin{equation}
3000 v^{t} (v-r) = 0
\end{equation}\]</span></p>
<p>Since we assume <span class="math inline">\(v\neq 0\)</span>, the only possibility is if <span class="math inline">\(v=r\)</span>. Aha! Our general solution then is</p>
<p><span class="math display">\[\begin{equation}
M_{t}=3000 r^{t}
\end{equation}\]</span></p>
<p>We know that if <span class="math inline">\(r&gt;1\)</span> we have exponential growth and <span class="math inline">\(r&lt;1\)</span> exponential decay, consistent with our results above.</p>
<p>There is some comfort here: just like in continuous systems we find the eigenvalues that determine the stability of the equilibrium solution. For discrete systems the stability is based on the value relative to one (not zero) - so it is good to be aware of what type of system you are looking at!</p>
<p>Now that we have an understanding of how this system works we can begin to look at stochasticity.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stoch-sys-21.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="environmental-stochasticity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/21-stochasticSystems.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/21-stochasticSystems.Rmd",
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
