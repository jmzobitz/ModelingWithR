<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Defining an Algorithm | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Defining an Algorithm | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Defining an Algorithm | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="euler-04.html"/>
<link rel="next" href="building-an-iterative-method.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="part"><span><b>I Models with Differential Equations</b></span></li>
<li class="chapter" data-level="2" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>2</b> Models of rates with data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rates-of-change-in-the-world-a-model-is-born.html"><a href="rates-of-change-in-the-world-a-model-is-born.html"><i class="fa fa-check"></i><b>2.1</b> Rates of change in the world: a model is born</a></li>
<li class="chapter" data-level="2.2" data-path="modeling-in-context-the-spread-of-a-disease.html"><a href="modeling-in-context-the-spread-of-a-disease.html"><i class="fa fa-check"></i><b>2.2</b> Modeling in context: the spread of a disease</a></li>
<li class="chapter" data-level="2.3" data-path="model-solutions.html"><a href="model-solutions.html"><i class="fa fa-check"></i><b>2.3</b> Model solutions</a></li>
<li class="chapter" data-level="2.4" data-path="which-model-is-best.html"><a href="which-model-is-best.html"><i class="fa fa-check"></i><b>2.4</b> Which model is best?</a></li>
<li class="chapter" data-level="2.5" data-path="start-here.html"><a href="start-here.html"><i class="fa fa-check"></i><b>2.5</b> Start here</a></li>
<li class="chapter" data-level="2.6" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>3.1</b> R and RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="first-steps-getting-acquainted-with-r.html"><a href="first-steps-getting-acquainted-with-r.html"><i class="fa fa-check"></i><b>3.2</b> First steps: getting acquainted with R</a></li>
<li class="chapter" data-level="3.3" data-path="increasing-functionality-with-packages.html"><a href="increasing-functionality-with-packages.html"><i class="fa fa-check"></i><b>3.3</b> Increasing functionality with packages</a></li>
<li class="chapter" data-level="3.4" data-path="working-with-r-variables-data-frames-and-datasets.html"><a href="working-with-r-variables-data-frames-and-datasets.html"><i class="fa fa-check"></i><b>3.4</b> Working with R: variables, data frames, and datasets</a></li>
<li class="chapter" data-level="3.5" data-path="visualization-with-r.html"><a href="visualization-with-r.html"><i class="fa fa-check"></i><b>3.5</b> Visualization with R</a></li>
<li class="chapter" data-level="3.6" data-path="defining-functions.html"><a href="defining-functions.html"><i class="fa fa-check"></i><b>3.6</b> Defining functions</a></li>
<li class="chapter" data-level="3.7" data-path="concluding-thoughts.html"><a href="concluding-thoughts.html"><i class="fa fa-check"></i><b>3.7</b> Concluding thoughts</a></li>
<li class="chapter" data-level="3.8" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>4</b> Modeling with rates of change</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lynx-and-hares.html"><a href="lynx-and-hares.html"><i class="fa fa-check"></i><b>4.1</b> Lynx and Hares</a></li>
<li class="chapter" data-level="4.2" data-path="the-law-of-mass-action.html"><a href="the-law-of-mass-action.html"><i class="fa fa-check"></i><b>4.2</b> The Law of Mass Action</a></li>
<li class="chapter" data-level="4.3" data-path="establishing-species.html"><a href="establishing-species.html"><i class="fa fa-check"></i><b>4.3</b> Establishing species</a></li>
<li class="chapter" data-level="4.4" data-path="other-types-of-functional-responses.html"><a href="other-types-of-functional-responses.html"><i class="fa fa-check"></i><b>4.4</b> Other types of functional responses</a></li>
<li class="chapter" data-level="4.5" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>5</b> Euler’s method</a>
<ul>
<li class="chapter" data-level="5.1" data-path="defining-an-algorithm.html"><a href="defining-an-algorithm.html"><i class="fa fa-check"></i><b>5.1</b> Defining an Algorithm</a></li>
<li class="chapter" data-level="5.2" data-path="building-an-iterative-method.html"><a href="building-an-iterative-method.html"><i class="fa fa-check"></i><b>5.2</b> Building an iterative method</a></li>
<li class="chapter" data-level="5.3" data-path="eulers-method-applied-to-systems.html"><a href="eulers-method-applied-to-systems.html"><i class="fa fa-check"></i><b>5.3</b> Euler’s method applied to systems</a></li>
<li class="chapter" data-level="5.4" data-path="more-refined-numerical-solvers.html"><a href="more-refined-numerical-solvers.html"><i class="fa fa-check"></i><b>5.4</b> More refined numerical solvers</a></li>
<li class="chapter" data-level="5.5" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>6</b> Phase lines and equilibrium solutions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="equilibrium-solutions.html"><a href="equilibrium-solutions.html"><i class="fa fa-check"></i><b>6.1</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="6.2" data-path="phase-lines-for-differentail-equations.html"><a href="phase-lines-for-differentail-equations.html"><i class="fa fa-check"></i><b>6.2</b> Phase lines for differentail equations</a></li>
<li class="chapter" data-level="6.3" data-path="a-stability-test-for-equilibrium-solutions.html"><a href="a-stability-test-for-equilibrium-solutions.html"><i class="fa fa-check"></i><b>6.3</b> A stability test for equilibrium solutions</a></li>
<li class="chapter" data-level="6.4" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>7</b> Coupled systems of equations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-redux-flu-with-quarantine.html"><a href="model-redux-flu-with-quarantine.html"><i class="fa fa-check"></i><b>7.1</b> Model redux: flu with quarantine</a></li>
<li class="chapter" data-level="7.2" data-path="determining-stability.html"><a href="determining-stability.html"><i class="fa fa-check"></i><b>7.2</b> Determining stability</a></li>
<li class="chapter" data-level="7.3" data-path="generating-a-phase-plane-in-r.html"><a href="generating-a-phase-plane-in-r.html"><i class="fa fa-check"></i><b>7.3</b> Generating a phase plane in <code>R</code></a></li>
<li class="chapter" data-level="7.4" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>7.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>8</b> Exact Solutions to Differential Equations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="separable-differential-equations.html"><a href="separable-differential-equations.html"><i class="fa fa-check"></i><b>8.1</b> Separable Differential Equations</a></li>
<li class="chapter" data-level="8.2" data-path="integrating-factors.html"><a href="integrating-factors.html"><i class="fa fa-check"></i><b>8.2</b> Integrating factors</a></li>
<li class="chapter" data-level="8.3" data-path="guess-and-check.html"><a href="guess-and-check.html"><i class="fa fa-check"></i><b>8.3</b> Guess and Check</a></li>
<li class="chapter" data-level="8.4" data-path="superposition-of-solutions.html"><a href="superposition-of-solutions.html"><i class="fa fa-check"></i><b>8.4</b> Superposition of solutions</a></li>
<li class="chapter" data-level="8.5" data-path="applying-guess-and-check-more-broadly.html"><a href="applying-guess-and-check-more-broadly.html"><i class="fa fa-check"></i><b>8.5</b> Applying guess and check more broadly</a></li>
<li class="chapter" data-level="8.6" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="defining-an-algorithm" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Defining an Algorithm</h2>
<p>Here would be an algorithm that would describe our process to determine a solution to a differential equation:</p>
<ul>
<li>Determine the locally linear approximation at a given point.</li>
<li>Forecast out to another time value.</li>
<li>Repeat the locally linear approximation.</li>
</ul>
<p>If we continue on in this way, let’s take a look at how our approximation would do after several days:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th>Approximate Solution</th>
<th>Actual Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>90</td>
<td>118.4</td>
<td>117</td>
</tr>
<tr class="even">
<td>95</td>
<td>119.9</td>
<td>118.6</td>
</tr>
</tbody>
</table>
<p>Now it seems that our approximation isn’t so accurate as time goes on. What if we updated the infection rate every half day? I know this means that we would be doing additional work (more iterations), but taking smaller timesteps goes hand in hand with more accurate solutions. Let’s start out smaller with the first few timesteps:</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th><span class="math inline">\(I\)</span></th>
<th><span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span></th>
<th><span class="math inline">\(\displaystyle \frac{dI}{dt} \cdot \Delta t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>10</td>
<td>3</td>
<td>1.5</td>
</tr>
<tr class="even">
<td>0.5</td>
<td>= 10 + 1.5 = 11.5</td>
<td>2.96</td>
<td>1.48</td>
</tr>
<tr class="odd">
<td>1</td>
<td>= 11.5 + 1.48 = 12.98</td>
<td>2.92</td>
<td>1.46</td>
</tr>
<tr class="even">
<td>1.5</td>
<td>= 12.92 + 1.46 = 14.38</td>
<td>2.88</td>
<td>1.44</td>
</tr>
<tr class="odd">
<td>2</td>
<td>= 14.38 + 1.44 = 15.82</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Notice how we have started to build up a way to organize how to compute the solution. Each column is a ``step’’ of the method, computing the solution at a new timestep based on our step size <span class="math inline">\(\Delta t\)</span>. The third column just computes the value of the derivative for a particular time and <span class="math inline">\(I\)</span>, and then the fourth column is the <em>increment</em> size, or the amount we are forecasting the solution will grow by to the next timestep. (There are other ways to think about this, but if you have a <em>rate of change </em> multiplied by a time increment this will give you an approximation to the net change in a function.)</p>
<p>This idea of <em>approximate, forecast, repeat</em> is the heart of many <a href="https://en.wikipedia.org/wiki/Numerical_methods_for_ordinary_differential_equations">numerical methods</a> that approximate solutions to differential equations. The particular method that we have developed here is called <em>Euler’s Method</em>. We display the results from additional steps in Figure <a href="defining-an-algorithm.html#fig:eulers-ver2">5.1</a>.</p>
<div class="figure"><span id="fig:eulers-ver2"></span>
<img src="series_files/figure-html/eulers-ver2-1.png" alt="Approximation of a solution using local linearity" width="384" />
<p class="caption">
Figure 5.1: Approximation of a solution using local linearity
</p>
</div>
<p>You may notice that the approximation in Figure @ref(fig:eulers_ver2) compares very favorably to the actual solution function. At the end, we have the following comparisons:</p>
<table>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th>Euler’s Method (<span class="math inline">\(\Delta t = 1\)</span>)</th>
<th>Euler’s Method (<span class="math inline">\(\Delta t = 0.5\)</span>)</th>
<th>Actual Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>190</td>
<td>130.5</td>
<td>129.7</td>
<td>129</td>
</tr>
<tr class="even">
<td>195</td>
<td>130.6</td>
<td>129.8</td>
<td>129.1</td>
</tr>
<tr class="odd">
<td>200</td>
<td>130.7</td>
<td>129.9</td>
<td>129.2</td>
</tr>
</tbody>
</table>
<p>There is a tradeoff here - the smaller stepsizes you have the more work it will take to compute you solution. You may have seen a similar tradeoff in Calculus when you explored numerical integration and Riemann sums.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="euler-04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-an-iterative-method.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/04-eulersmethod.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/04-eulersmethod.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
