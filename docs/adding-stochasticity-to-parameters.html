<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Adding stochasticity to parameters | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Adding stochasticity to parameters | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Adding stochasticity to parameters | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-07-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-euler-maruyama-method.html"/>
<link rel="next" href="concluding-thoughts.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>2</b> Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-stochastic-logistic-model.html"><a href="the-stochastic-logistic-model.html"><i class="fa fa-check"></i><b>2.1</b> The stochastic logistic model</a></li>
<li class="chapter" data-level="2.2" data-path="the-euler-maruyama-method.html"><a href="the-euler-maruyama-method.html"><i class="fa fa-check"></i><b>2.2</b> The Euler-Maruyama Method</a></li>
<li class="chapter" data-level="2.3" data-path="adding-stochasticity-to-parameters.html"><a href="adding-stochasticity-to-parameters.html"><i class="fa fa-check"></i><b>2.3</b> Adding stochasticity to parameters</a></li>
<li class="chapter" data-level="2.4" data-path="concluding-thoughts.html"><a href="concluding-thoughts.html"><i class="fa fa-check"></i><b>2.4</b> Concluding thoughts</a></li>
<li class="chapter" data-level="2.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adding-stochasticity-to-parameters" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Adding stochasticity to parameters</h2>
<p>Now that we have seen an example in adding stochasticity to the logistic equation, we can also parameters of the differential equation to be stochastic. For example, let’s say that the growth rate <span class="math inline">\(r\)</span> in the logistic equation is subject to stochastic effects. How we would implement this by replacing <span class="math inline">\(r\)</span> with <span class="math inline">\(r + \mbox{ Noise }\)</span>:</p>
<p><span class="math display">\[\begin{equation}
dx = (r + \mbox{ Noise } )x \left(1 - \frac{x}{K} \right) \; dt,
\end{equation}\]</span></p>
<p>Now what we do is separate out the terms that are multiplied by “Noise” - they will form the stochastic part of the differential equation. The terms that aren’t multipled by “Noise” form the deterministic part of the differential equation:</p>
<p><span class="math display">\[\begin{equation}
dx = r  x \left(1 - \frac{x}{K} \right) \; dt + x \left(1 - \frac{x}{K} \right) \mbox{ Noise } \; dt,
\end{equation}\]</span></p>
<p>So we have the following, writing <span class="math inline">\(\mbox{ Noise } \; dt = dW(t)\)</span>:
<span class="math display">\[\begin{align*}
\mbox{Deterministic part: } &amp; rx \left(1 - \frac{x}{K} \right) \; dt \\
\mbox{Stochastic part: } &amp; x \left(1 - \frac{x}{K} \right) dW(t)
\end{align*}\]</span></p>
<p>There are a few things to notice here. First, the deterministic part of the differential equation is what we would expect without noise added. Second, notice how the stochastic part of the differential equation changed. Let’s take a look at the simulations with the Euler-Maruyama method:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="adding-stochasticity-to-parameters.html#cb7-1" aria-hidden="true" tabindex="-1"></a>  deltaT <span class="ot">&lt;-</span> .<span class="dv">05</span>    <span class="co"># timestep length</span></span>
<span id="cb7-2"><a href="adding-stochasticity-to-parameters.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  timeSteps <span class="ot">&lt;-</span> <span class="dv">200</span>   <span class="co"># must be a number greater than 1</span></span>
<span id="cb7-3"><a href="adding-stochasticity-to-parameters.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r=</span><span class="fl">0.8</span>, <span class="at">K=</span><span class="dv">100</span>)   <span class="co"># parameters: a named vector</span></span>
<span id="cb7-4"><a href="adding-stochasticity-to-parameters.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  initialCondition <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">x=</span><span class="dv">3</span>)  <span class="co"># Be sure you have enough conditions as you do variables.</span></span>
<span id="cb7-5"><a href="adding-stochasticity-to-parameters.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  nSimulations <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb7-6"><a href="adding-stochasticity-to-parameters.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-7"><a href="adding-stochasticity-to-parameters.html#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="adding-stochasticity-to-parameters.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  deterministicDynamics <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parameters){</span>
<span id="cb7-9"><a href="adding-stochasticity-to-parameters.html#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parameters)), {  <span class="co"># Do not edit this line</span></span>
<span id="cb7-10"><a href="adding-stochasticity-to-parameters.html#cb7-10" aria-hidden="true" tabindex="-1"></a>      dx <span class="ot">=</span> r<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">/</span>K)  <span class="co"># &lt;-- You may edit this line</span></span>
<span id="cb7-11"><a href="adding-stochasticity-to-parameters.html#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dx)))  <span class="co"># &lt;-- If you have more equations you will need to list the dVariables</span></span>
<span id="cb7-12"><a href="adding-stochasticity-to-parameters.html#cb7-12" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb7-13"><a href="adding-stochasticity-to-parameters.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-14"><a href="adding-stochasticity-to-parameters.html#cb7-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-15"><a href="adding-stochasticity-to-parameters.html#cb7-15" aria-hidden="true" tabindex="-1"></a>  stochasticDynamics <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parameters){</span>
<span id="cb7-16"><a href="adding-stochasticity-to-parameters.html#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parameters)), {  <span class="co"># Do not edit this line</span></span>
<span id="cb7-17"><a href="adding-stochasticity-to-parameters.html#cb7-17" aria-hidden="true" tabindex="-1"></a>      dx <span class="ot">=</span> x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">/</span>K)  <span class="co"># &lt;-- You may edit this line</span></span>
<span id="cb7-18"><a href="adding-stochasticity-to-parameters.html#cb7-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dx)))  <span class="co"># &lt;-- If you have more equations you will need to list the dVariables</span></span>
<span id="cb7-19"><a href="adding-stochasticity-to-parameters.html#cb7-19" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb7-20"><a href="adding-stochasticity-to-parameters.html#cb7-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-21"><a href="adding-stochasticity-to-parameters.html#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="adding-stochasticity-to-parameters.html#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">eulerStochastic</span>(deltaT,timeSteps,initialCondition,deterministicDynamics,</span>
<span id="cb7-23"><a href="adding-stochasticity-to-parameters.html#cb7-23" aria-hidden="true" tabindex="-1"></a>                stochasticDynamics,parameters,nSimulations,sigma)</span></code></pre></div>
<div class="figure"><span id="fig:parameter-stoch-1"></span>
<img src="series_files/figure-html/parameter-stoch-1.png" alt="Simulation of adding in " width="384" />
<p class="caption">
Figure 2.4: Simulation of adding in
</p>
</div>
<div class="figure"><span id="fig:parameter-stoch-2"></span>
<img src="series_files/figure-html/parameter-stoch-2.png" alt="Simulation of adding in " width="384" />
<p class="caption">
Figure 2.5: Simulation of adding in
</p>
</div>
<p>Notice how the dynamics are different - there is a lot more variability in how quickly the solution rises to the steady state of <span class="math inline">\(K=100\)</span>.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-euler-maruyama-method.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="concluding-thoughts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/25-sdes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/25-sdes.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
