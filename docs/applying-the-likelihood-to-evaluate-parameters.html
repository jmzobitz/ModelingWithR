<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 Applying the likelihood to evaluate parameters | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 Applying the likelihood to evaluate parameters | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 Applying the likelihood to evaluate parameters | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimating-the-growth-of-a-dog.html"/>
<link rel="next" href="concluding-points.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="the-metropolis-hastings-algorithm.html"><a href="the-metropolis-hastings-algorithm.html"><i class="fa fa-check"></i><b>2</b> The Metropolis-Hastings Algorithm</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estimating-the-growth-of-a-dog.html"><a href="estimating-the-growth-of-a-dog.html"><i class="fa fa-check"></i><b>2.1</b> Estimating the growth of a dog</a></li>
<li class="chapter" data-level="2.2" data-path="applying-the-likelihood-to-evaluate-parameters.html"><a href="applying-the-likelihood-to-evaluate-parameters.html"><i class="fa fa-check"></i><b>2.2</b> Applying the likelihood to evaluate parameters</a></li>
<li class="chapter" data-level="2.3" data-path="concluding-points.html"><a href="concluding-points.html"><i class="fa fa-check"></i><b>2.3</b> Concluding points</a></li>
<li class="chapter" data-level="2.4" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-the-likelihood-to-evaluate-parameters" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Applying the likelihood to evaluate parameters</h2>
<p>So with <span class="math inline">\(p_{1}=65\)</span> the long-term trend looks lower and underestimates the long term growth. However is this value more plausible? We have nineteen measurements of the dogâ€™s weight over time. Assuming these measures are all independent and identically distributed, we have the following likelihood function:</p>
<p><span class="math display">\[\begin{equation}
L(p_{1}) = \prod_{i=1}^{19} \frac{1}{\sqrt{2 \pi} \sigma} e^{-\frac{(W_{i}-f(D_{i},p_{1}))^{2}}{2 \sigma^{2}}}
\end{equation}\]</span></p>
<p>We can easily compute the associated likelihood values with the function <code>compute_likelihood</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can we do this with compute likelihood?</span></span>
<span id="cb4-2"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-2" aria-hidden="true" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> mass <span class="sc">~</span>  p1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(p2<span class="sc">+</span>p3<span class="sc">*</span>days)))</span>
<span id="cb4-3"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This allows for all the possible combinations of parameters</span></span>
<span id="cb4-6"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-6" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p1 =</span> <span class="fu">c</span>(<span class="dv">78</span>,<span class="dv">65</span>), <span class="at">p2 =</span> <span class="sc">-</span><span class="fl">2.461935</span>, <span class="at">p3 =</span> <span class="fl">0.017032</span>)</span>
<span id="cb4-7"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the likelihood and return the likelihood from the list</span></span>
<span id="cb4-9"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-9" aria-hidden="true" tabindex="-1"></a>out_values <span class="ot">&lt;-</span> <span class="fu">compute_likelihood</span>(my_model,wilson,parameters)<span class="sc">$</span>likelihood</span>
<span id="cb4-10"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Return the likelihood from the list:</span></span>
<span id="cb4-12"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb4-12" aria-hidden="true" tabindex="-1"></a>out_values</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##      p1    p2     p3   l_hood log_lik
##   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;  
## 1    78 -2.46 0.0170 6.86e-29 FALSE  
## 2    65 -2.46 0.0170 1.20e-27 FALSE</code></pre>
<p>Hopefully this code seems familiar to you from Section <a href="#likelihood-09"><strong>??</strong></a>. We made some modifications to streamline things:</p>
<ul>
<li>We want to compare two values of <code>p1</code>, so when we defined <code>parameters</code> we included the two values of <span class="math inline">\(p_{1}\)</span> when defining <code>parameters</code>. The same values of <code>p2</code> and <code>p3</code> will apply to both. Donâ€™t believe me? Type <code>parameters</code> at the console line to see!</li>
<li>Recall that when we apply <code>compute_likelihood</code> a list is returned (<code>likelihood</code> and <code>opt_value</code> . For this case we just want the <code>likelihood</code> data frame, hence the <code>$likelihood</code> at the end of <code>compute_likelihood</code>.</li>
</ul>
<p>So we computed <span class="math inline">\(L(78)\)</span>=6.8560765^{-29} and <span class="math inline">\(L(65)\)</span>=1.2038829^{-27}. As you can see the value of <span class="math inline">\(L(65)\)</span> is a larger number compared to <span class="math inline">\(p_{1}=78\)</span>. One way we can get a sense for the magnitude of the scale is by examining the <em>ratio</em> of the likelihoods:</p>
<p><span class="math display">\[\begin{equation}
\mbox{ Likelihood ratio: } \frac{ L(p_{1}^{proposed}) }{ L(p_{1}^{current}) },
\end{equation}\]</span></p>
<p>So letâ€™s compute this ratio: <span class="math inline">\(\displaystyle \frac{ L(65) }{ L(78) }=\)</span><code>round(out_values$l_hood[[2]]/out_values$l_hood[[1]])</code>. So with this comparison we would say that <span class="math inline">\(p_{1}=65\)</span> is more likely compared to the value of <span class="math inline">\(p_{1}=78\)</span>.</p>
<p>Can we do better? What we can do is examine the likelihood ratio for another value. Since we might need to iterate through things letâ€™s define a function that we can reuse:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function that computes the likelihood ratio for Wilson&#39;s weight</span></span>
<span id="cb6-2"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-2" aria-hidden="true" tabindex="-1"></a>likelihood_ratio_wilson <span class="ot">&lt;-</span> <span class="cf">function</span>(proposed,current) {</span>
<span id="cb6-3"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Can we do this with compute likelihood?</span></span>
<span id="cb6-5"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-5" aria-hidden="true" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> mass <span class="sc">~</span>  p1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(p2<span class="sc">+</span>p3<span class="sc">*</span>days)))</span>
<span id="cb6-6"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This allows for all the possible combinations of parameters</span></span>
<span id="cb6-9"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-9" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p1 =</span> <span class="fu">c</span>(current,proposed), <span class="at">p2 =</span> <span class="sc">-</span><span class="fl">2.461935</span>, <span class="at">p3 =</span> <span class="fl">0.017032</span>)</span>
<span id="cb6-10"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the likelihood and return the likelihood from the list</span></span>
<span id="cb6-12"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-12" aria-hidden="true" tabindex="-1"></a>out_values <span class="ot">&lt;-</span> <span class="fu">compute_likelihood</span>(my_model,wilson,parameters)<span class="sc">$</span>likelihood</span>
<span id="cb6-13"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Return the likelihood from the list:</span></span>
<span id="cb6-15"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-15" aria-hidden="true" tabindex="-1"></a>ll_ratio <span class="ot">&lt;-</span> out_values<span class="sc">$</span>l_hood[[<span class="dv">2</span>]]<span class="sc">/</span>out_values<span class="sc">$</span>l_hood[[<span class="dv">1</span>]]</span>
<span id="cb6-16"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(ll_ratio)</span>
<span id="cb6-18"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-19"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-20"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function out:</span></span>
<span id="cb6-22"><a href="applying-the-likelihood-to-evaluate-parameters.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">likelihood_ratio_wilson</span>(<span class="dv">65</span>,<span class="dv">78</span>)</span></code></pre></div>
<pre><code>## [1] 17.55936</code></pre>
<p>You should notice that the reported likelihood ratio matches up with our computation - yes! So letâ€™s try to compute the likelihood ratio for <span class="math inline">\(p_{1}=70\)</span> compared to <span class="math inline">\(p_{1}=65\)</span>. Try computing <code>likelihood_ratio_wilson(70,65)</code> - you should see that it is about 7.5 million times more likely!</p>
<p>I think we are onto something - Figure <a href="applying-the-likelihood-to-evaluate-parameters.html#fig:all-three-wilson">2.4</a> compares the modeled values of Wilsonâ€™s weight for the different parameters:</p>
<div class="figure"><span id="fig:all-three-wilson"></span>
<img src="series_files/figure-html/all-three-wilson-1.png" alt="Comparison of our three estimates for Wilson's weight over time." width="480" />
<p class="caption">
Figure 2.4: Comparison of our three estimates for Wilsonâ€™s weight over time.
</p>
</div>
<p>So now, letâ€™s try <span class="math inline">\(p_{1}=74\)</span> and compare the likelihoods: <span class="math inline">\(\displaystyle \frac{ L(74) }{ L(70) }\)</span>=4.5897793^{-9}. This seems to be <em>less</em> likely because the ratio was significantly less than one. If we are doing a hunt for the <em>best</em> optimum value, then we would reject <span class="math inline">\(p_{1}=74\)</span> and keep moving on, perhaps selecting another value closer to 70.</p>
<p>However, the reality is a little different. For non-linear problems we want to be extra careful that we do not accept a parameter value that leads us to a <em>local</em> (not global) optimum. A way to avoid this is compare the likelihood ratio to a uniform random number <span class="math inline">\(r\)</span> between 0 and 1. We can do this very easily in <code>R</code> - remember the discussion of probability models in Section <a href="#likelihood-09"><strong>??</strong></a>? At the <code>R</code> console type <code>runif(1)</code> - this creates one random number from the uniform distribution (remember the default range of the uniform distribution is <span class="math inline">\(0 \leq p_{1} \leq 1\)</span>). The <code>r</code> in <code>runif(1)</code> stands for <em>random</em>. When I tried <code>runif(1)</code> I received a value of 0.126. Since the likelihood ratio is smaller than the random number we generated, we will <em>reject</em> the value of <span class="math inline">\(p_{1}\)</span> and try again, keeping 70 as our value.</p>
<p>The process keep the proposed value based on some decision metric is called a <em>decision step</em>.</p>
<div id="an-iterative-method-to-estimate-parameters" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> An iterative method to estimate parameters</h3>
<p>The neat part of the previous discussion is that we can automate this process, such as in Table .</p>
<p>This table is the essence of what is called the <a href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm">Metropolis-Hastings algorithm</a>. Here are the following components:</p>
<ol style="list-style-type: decimal">
<li>A defined likelihood function.</li>
<li>A starting value for your parameter.</li>
<li>A proposal value for your parameter.</li>
<li>Comparison of the likelihood ratios for the proposed to the current value (<span class="math inline">\(\displaystyle \mbox{ Likelihood ratio: } \frac{ L(p_{1}^{proposed}) }{ L(p_{1}^{current}) }\)</span>). The goal of this algorithm method is to determine the parameter set that optimizes the likelihood function, or makes the likelihood ratio greater than unity. We will prefer values of <span class="math inline">\(p_{1}\)</span> that increase the likelihood.</li>
<li>A decision to accept the proposed parameter value. If the likelihood ratio is greater than 1, then we accept this value. However if the likelihood ratio is less than 1, we generate a random number <span class="math inline">\(r\)</span> (using <code>runif(1)</code>) and use this following process:</li>
</ol>
<ul>
<li>If <span class="math inline">\(r\)</span> is less than the likelihood ratio we <strong>accept</strong> (keep) the proposed parameter value.</li>
<li>If <span class="math inline">\(r\)</span> is greater than the likelihood ratio we <strong>reject</strong> the proposed parameter value.</li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimating-the-growth-of-a-dog.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="concluding-points.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/12-metropolis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/12-metropolis.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
