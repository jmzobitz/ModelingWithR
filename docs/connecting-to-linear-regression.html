<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Connecting to linear regression | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Connecting to linear regression | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Connecting to linear regression | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-06-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probability.html"/>
<link rel="next" href="plotting-likelihood-surfaces.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="probability-and-likelihood-functions-09-likelihood.html"><a href="probability-and-likelihood-functions-09-likelihood.html"><i class="fa fa-check"></i><b>2</b> Probability and Likelihood Functions {#09-likelihood}</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linear-regression-part-2.html"><a href="linear-regression-part-2.html"><i class="fa fa-check"></i><b>2.1</b> Linear regression, part 2</a></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2.2</b> Probability</a></li>
<li class="chapter" data-level="2.3" data-path="connecting-to-linear-regression.html"><a href="connecting-to-linear-regression.html"><i class="fa fa-check"></i><b>2.3</b> Connecting to linear regression</a></li>
<li class="chapter" data-level="2.4" data-path="plotting-likelihood-surfaces.html"><a href="plotting-likelihood-surfaces.html"><i class="fa fa-check"></i><b>2.4</b> Plotting likelihood surfaces</a></li>
<li class="chapter" data-level="2.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="connecting-to-linear-regression" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Connecting to linear regression</h2>
<p>Now that we have made that small excursion into probablity, let’s start to return back to the linear regression problem. Another way to phrase this the linear regression problem studied in the last chapter is to examine the probability distribution of the model-data residual <span class="math inline">\(\epsilon\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\epsilon_{i} = y_{i} - f(x_{i},\vec{\alpha} ).
\end{equation}\]</span></p>
<p>The approach with likelihood functions assumes a particular probability distribution on each residual. One common assumption is that the residual <em>distribution</em> is normal with mean <span class="math inline">\(\mu=0\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> (which could be specified as measurement error, etc).</p>
<p><span class="math display">\[\begin{equation}
L(\epsilon_{i}) = \frac{1}{\sqrt{2 \pi} \sigma} e^{−\epsilon_{i}^{2} / 2 \sigma^{2} },
\end{equation}\]</span></p>
<p>To extend this further across all measurement, we use the idea of <em>independent, identically distributed</em> measurements so the joint likelihood of <strong>all</strong> the residuals is the product of the likelihoods</p>
<p><span class="math display">\[\begin{equation}
L(\vec{\epsilon}) = \prod_{i=1}^{N} \frac{1}{\sqrt{2 \pi} \sigma} e^{−\epsilon_{i}^{2} / 2 \sigma^{2} },
\end{equation}\]</span></p>
<p>We are making progress here, but in order to fully characterize the solution we need to specify the parameters <span class="math inline">\(\vec{\alpha}\)</span>. A simple redefining of the likelihood function where we specify the measurements (<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) and parameters (<span class="math inline">\(\vec{\alpha}\)</span>) is all we need:</p>
<p><span class="math display">\[\begin{equation}
L(\vec{\alpha} | \vec{x},\vec{y} )= \prod_{i=1}^{N}  \frac{1}{\sqrt{2 \pi} \sigma} \exp(−(y_{i} − f(x_{i},\vec{\alpha} ))^{2} / 2 \sigma^{2} )  
\end{equation}\]</span></p>
<p>Now we have a function where the best parameter estimate is the one that optimizes the likelihood.</p>
<p>To get back to our original linear regression problem. As a reminder we wanted to fit the function <span class="math inline">\(y=bx\)</span> to the following set of points:</p>
<table>
<thead>
<tr class="header">
<th align="center"><em>x</em></th>
<th align="center"><em>y</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p>The likelihood <span class="math inline">\(L(\epsilon_{i}) ~ N(0,\sigma)\)</span> characterizing these data are the following:</p>
<p><span class="math display" id="eq:small-data-likely">\[\begin{equation}
L(b) = \left( \frac{1}{\sqrt{2 \pi} \sigma}\right)^{4} e^{-\frac{(3-b)^{2}}{2\sigma}} \cdot e^{-\frac{(5-2b)^{2}}{2\sigma}}  \cdot e^{-\frac{(4-4b)^{2}}{2\sigma}}  \cdot e^{-\frac{(10-6b)^{2}}{2\sigma}} \tag{2.1}
\end{equation}\]</span></p>
<p>For the purposes of our argument here, we will assume <span class="math inline">\(\sigma=1\)</span>. Let’s also make a plot of this likelihood function:</p>
<div class="figure"><span id="fig:small-likelihood-plot"></span>
<img src="series_files/figure-html/small-likelihood-plot-1.png" alt="The likelihood function for the small dataset" width="384" />
<p class="caption">
Figure 2.9: The likelihood function for the small dataset
</p>
</div>
<p>Note that although the <span class="math inline">\(y\)</span> values of the likelihood function are really small, the likelihood function is maximized at <span class="math inline">\(b=1.561\)</span>.</p>
<p>Notice how in the plot of our likelihood function we had really small values of <span class="math inline">\(L(b)\)</span>. It is also common to use the log likelihood:</p>
<p><span class="math display">\[\begin{equation}
\ln(L(\vec{\alpha} | \vec{x},\vec{y} )) = − \frac{N}{\sqrt{2 \pi} \sigma} − \sum_{i=1}^{N} \frac{ −(y_{i} - f(x_{i},\vec{\alpha} )^{2}}{ 2 \sigma^{2}}
\end{equation}\]</span></p>
<p>In the homework you will be working on how to transform the likelihood function <span class="math inline">\(L(b)\)</span> to the log-likelihood <span class="math inline">\(\ln(L(b))\)</span>.</p>
<p>For our purposes here we are going to assume independent, identical, normally distributed errors with a mean 0 for the likelihood functions. This is a commonly used assumption for this approach, but you should always think about the errors in more advanced applications.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-likelihood-surfaces.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/09-likelihood.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/09-likelihood.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
