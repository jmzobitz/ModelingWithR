<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Building an iterative method | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Building an iterative method | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Building an iterative method | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="defining-an-algorithm.html"/>
<link rel="next" href="eulers-method-applied-to-systems.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="computational-code.html"><a href="computational-code.html"><i class="fa fa-check"></i>Computational code</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="copyright.html"><a href="copyright.html"><i class="fa fa-check"></i>Copyright</a></li>
</ul></li>
<li class="part"><span><b>I Models with Differential Equations</b></span></li>
<li class="chapter" data-level="1" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>1</b> Models of rates with data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rates-of-change-in-the-world-a-model-is-born.html"><a href="rates-of-change-in-the-world-a-model-is-born.html"><i class="fa fa-check"></i><b>1.1</b> Rates of change in the world: a model is born</a></li>
<li class="chapter" data-level="1.2" data-path="modeling-in-context-the-spread-of-a-disease.html"><a href="modeling-in-context-the-spread-of-a-disease.html"><i class="fa fa-check"></i><b>1.2</b> Modeling in context: the spread of a disease</a></li>
<li class="chapter" data-level="1.3" data-path="model-solutions.html"><a href="model-solutions.html"><i class="fa fa-check"></i><b>1.3</b> Model solutions</a></li>
<li class="chapter" data-level="1.4" data-path="which-model-is-best.html"><a href="which-model-is-best.html"><i class="fa fa-check"></i><b>1.4</b> Which model is best?</a></li>
<li class="chapter" data-level="1.5" data-path="start-here.html"><a href="start-here.html"><i class="fa fa-check"></i><b>1.5</b> Start here</a></li>
<li class="chapter" data-level="1.6" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-getting-acquainted-with-r.html"><a href="first-steps-getting-acquainted-with-r.html"><i class="fa fa-check"></i><b>2.2</b> First steps: getting acquainted with R</a></li>
<li class="chapter" data-level="2.3" data-path="increasing-functionality-with-packages.html"><a href="increasing-functionality-with-packages.html"><i class="fa fa-check"></i><b>2.3</b> Increasing functionality with packages</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-r-variables-data-frames-and-datasets.html"><a href="working-with-r-variables-data-frames-and-datasets.html"><i class="fa fa-check"></i><b>2.4</b> Working with R: variables, data frames, and datasets</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-with-r.html"><a href="visualization-with-r.html"><i class="fa fa-check"></i><b>2.5</b> Visualization with R</a></li>
<li class="chapter" data-level="2.6" data-path="defining-functions.html"><a href="defining-functions.html"><i class="fa fa-check"></i><b>2.6</b> Defining functions</a></li>
<li class="chapter" data-level="2.7" data-path="concluding-thoughts.html"><a href="concluding-thoughts.html"><i class="fa fa-check"></i><b>2.7</b> Concluding thoughts</a></li>
<li class="chapter" data-level="2.8" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>3</b> Modeling with rates of change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lynx-and-hares.html"><a href="lynx-and-hares.html"><i class="fa fa-check"></i><b>3.1</b> Lynx and Hares</a></li>
<li class="chapter" data-level="3.2" data-path="the-law-of-mass-action.html"><a href="the-law-of-mass-action.html"><i class="fa fa-check"></i><b>3.2</b> The Law of Mass Action</a></li>
<li class="chapter" data-level="3.3" data-path="establishing-species.html"><a href="establishing-species.html"><i class="fa fa-check"></i><b>3.3</b> Establishing species</a></li>
<li class="chapter" data-level="3.4" data-path="other-types-of-functional-responses.html"><a href="other-types-of-functional-responses.html"><i class="fa fa-check"></i><b>3.4</b> Other types of functional responses</a></li>
<li class="chapter" data-level="3.5" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>4</b> Euler’s method</a>
<ul>
<li class="chapter" data-level="4.1" data-path="defining-an-algorithm.html"><a href="defining-an-algorithm.html"><i class="fa fa-check"></i><b>4.1</b> Defining an Algorithm</a></li>
<li class="chapter" data-level="4.2" data-path="building-an-iterative-method.html"><a href="building-an-iterative-method.html"><i class="fa fa-check"></i><b>4.2</b> Building an iterative method</a></li>
<li class="chapter" data-level="4.3" data-path="eulers-method-applied-to-systems.html"><a href="eulers-method-applied-to-systems.html"><i class="fa fa-check"></i><b>4.3</b> Euler’s method applied to systems</a></li>
<li class="chapter" data-level="4.4" data-path="more-refined-numerical-solvers.html"><a href="more-refined-numerical-solvers.html"><i class="fa fa-check"></i><b>4.4</b> More refined numerical solvers</a></li>
<li class="chapter" data-level="4.5" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>5</b> Phase lines and equilibrium solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="equilibrium-solutions.html"><a href="equilibrium-solutions.html"><i class="fa fa-check"></i><b>5.1</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="5.2" data-path="phase-lines-for-differentail-equations.html"><a href="phase-lines-for-differentail-equations.html"><i class="fa fa-check"></i><b>5.2</b> Phase lines for differentail equations</a></li>
<li class="chapter" data-level="5.3" data-path="a-stability-test-for-equilibrium-solutions.html"><a href="a-stability-test-for-equilibrium-solutions.html"><i class="fa fa-check"></i><b>5.3</b> A stability test for equilibrium solutions</a></li>
<li class="chapter" data-level="5.4" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>6</b> Coupled systems of equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-redux-flu-with-quarantine.html"><a href="model-redux-flu-with-quarantine.html"><i class="fa fa-check"></i><b>6.1</b> Model redux: flu with quarantine</a></li>
<li class="chapter" data-level="6.2" data-path="determining-stability.html"><a href="determining-stability.html"><i class="fa fa-check"></i><b>6.2</b> Determining stability</a></li>
<li class="chapter" data-level="6.3" data-path="generating-a-phase-plane-in-r.html"><a href="generating-a-phase-plane-in-r.html"><i class="fa fa-check"></i><b>6.3</b> Generating a phase plane in <code>R</code></a></li>
<li class="chapter" data-level="6.4" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>7</b> Exact Solutions to Differential Equations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="separable-differential-equations.html"><a href="separable-differential-equations.html"><i class="fa fa-check"></i><b>7.1</b> Separable Differential Equations</a></li>
<li class="chapter" data-level="7.2" data-path="integrating-factors.html"><a href="integrating-factors.html"><i class="fa fa-check"></i><b>7.2</b> Integrating factors</a></li>
<li class="chapter" data-level="7.3" data-path="guess-and-check.html"><a href="guess-and-check.html"><i class="fa fa-check"></i><b>7.3</b> Guess and Check</a></li>
<li class="chapter" data-level="7.4" data-path="superposition-of-solutions.html"><a href="superposition-of-solutions.html"><i class="fa fa-check"></i><b>7.4</b> Superposition of solutions</a></li>
<li class="chapter" data-level="7.5" data-path="applying-guess-and-check-more-broadly.html"><a href="applying-guess-and-check-more-broadly.html"><i class="fa fa-check"></i><b>7.5</b> Applying guess and check more broadly</a></li>
<li class="chapter" data-level="7.6" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>7.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Parameterizing Models with Data</b></span></li>
<li class="chapter" data-level="8" data-path="linear-regression-08.html"><a href="linear-regression-08.html"><i class="fa fa-check"></i><b>8</b> Linear Regression &amp; Curve Fitting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="what-is-parameter-estimation.html"><a href="what-is-parameter-estimation.html"><i class="fa fa-check"></i><b>8.1</b> What is parameter estimation?</a></li>
<li class="chapter" data-level="8.2" data-path="fitting-temperature-data.html"><a href="fitting-temperature-data.html"><i class="fa fa-check"></i><b>8.2</b> Fitting temperature data</a></li>
<li class="chapter" data-level="8.3" data-path="moving-beyond-linear-models.html"><a href="moving-beyond-linear-models.html"><i class="fa fa-check"></i><b>8.3</b> Moving beyond linear models</a></li>
<li class="chapter" data-level="8.4" data-path="can-you-linearize-your-model.html"><a href="can-you-linearize-your-model.html"><i class="fa fa-check"></i><b>8.4</b> Can you linearize your model?</a></li>
<li class="chapter" data-level="8.5" data-path="nonlinear-models.html"><a href="nonlinear-models.html"><i class="fa fa-check"></i><b>8.5</b> Nonlinear models</a></li>
<li class="chapter" data-level="8.6" data-path="exercises-7.html"><a href="exercises-7.html"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="likelihood-09.html"><a href="likelihood-09.html"><i class="fa fa-check"></i><b>9</b> Probability and Likelihood Functions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-regression-part-2.html"><a href="linear-regression-part-2.html"><i class="fa fa-check"></i><b>9.1</b> Linear regression, part 2</a></li>
<li class="chapter" data-level="9.2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>9.2</b> Probability</a></li>
<li class="chapter" data-level="9.3" data-path="connecting-to-linear-regression.html"><a href="connecting-to-linear-regression.html"><i class="fa fa-check"></i><b>9.3</b> Connecting to linear regression</a></li>
<li class="chapter" data-level="9.4" data-path="plotting-likelihood-surfaces.html"><a href="plotting-likelihood-surfaces.html"><i class="fa fa-check"></i><b>9.4</b> Plotting likelihood surfaces</a></li>
<li class="chapter" data-level="9.5" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>10</b> Cost Functions &amp; Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cost-functions-likelihood-functions-in-disguise.html"><a href="cost-functions-likelihood-functions-in-disguise.html"><i class="fa fa-check"></i><b>10.1</b> Cost functions: likelihood functions in disguise</a></li>
<li class="chapter" data-level="10.2" data-path="connection-to-likelihood-functions.html"><a href="connection-to-likelihood-functions.html"><i class="fa fa-check"></i><b>10.2</b> Connection to likelihood functions</a></li>
<li class="chapter" data-level="10.3" data-path="extending-the-cost-function.html"><a href="extending-the-cost-function.html"><i class="fa fa-check"></i><b>10.3</b> Extending the cost function</a></li>
<li class="chapter" data-level="10.4" data-path="conditional-probabilities-and-bayes-rule.html"><a href="conditional-probabilities-and-bayes-rule.html"><i class="fa fa-check"></i><b>10.4</b> Conditional Probabilities and Bayes’ Rule</a></li>
<li class="chapter" data-level="10.5" data-path="bayes-rule-and-linear-regression.html"><a href="bayes-rule-and-linear-regression.html"><i class="fa fa-check"></i><b>10.5</b> Bayes’ Rule and Linear Regression</a></li>
<li class="chapter" data-level="10.6" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bootstrap-11.html"><a href="bootstrap-11.html"><i class="fa fa-check"></i><b>11</b> The bootstrap method</a>
<ul>
<li class="chapter" data-level="11.1" data-path="plotting-histograms-in-r.html"><a href="plotting-histograms-in-r.html"><i class="fa fa-check"></i><b>11.1</b> Plotting histograms in R</a></li>
<li class="chapter" data-level="11.2" data-path="statistical-theory-sampling-distributions.html"><a href="statistical-theory-sampling-distributions.html"><i class="fa fa-check"></i><b>11.2</b> Statistical theory: Sampling distributions</a></li>
<li class="chapter" data-level="11.3" data-path="sampling-the-empirical-distirbution.html"><a href="sampling-the-empirical-distirbution.html"><i class="fa fa-check"></i><b>11.3</b> Sampling the empirical distirbution</a></li>
<li class="chapter" data-level="11.4" data-path="bootstapping-with-linear-regression.html"><a href="bootstapping-with-linear-regression.html"><i class="fa fa-check"></i><b>11.4</b> Bootstapping with linear regression</a></li>
<li class="chapter" data-level="11.5" data-path="exercises-10.html"><a href="exercises-10.html"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-metropolis-hastings-algorithm.html"><a href="the-metropolis-hastings-algorithm.html"><i class="fa fa-check"></i><b>12</b> The Metropolis-Hastings Algorithm</a>
<ul>
<li class="chapter" data-level="12.1" data-path="estimating-the-growth-of-a-dog.html"><a href="estimating-the-growth-of-a-dog.html"><i class="fa fa-check"></i><b>12.1</b> Estimating the growth of a dog</a></li>
<li class="chapter" data-level="12.2" data-path="applying-the-likelihood-to-evaluate-parameters.html"><a href="applying-the-likelihood-to-evaluate-parameters.html"><i class="fa fa-check"></i><b>12.2</b> Applying the likelihood to evaluate parameters</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>13</b> Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-stochastic-logistic-model.html"><a href="the-stochastic-logistic-model.html"><i class="fa fa-check"></i><b>13.1</b> The stochastic logistic model</a></li>
<li class="chapter" data-level="13.2" data-path="the-euler-maruyama-method.html"><a href="the-euler-maruyama-method.html"><i class="fa fa-check"></i><b>13.2</b> The Euler-Maruyama Method</a></li>
<li class="chapter" data-level="13.3" data-path="adding-stochasticity-to-parameters.html"><a href="adding-stochasticity-to-parameters.html"><i class="fa fa-check"></i><b>13.3</b> Adding stochasticity to parameters</a></li>
<li class="chapter" data-level="13.4" data-path="concluding-thoughts-1.html"><a href="concluding-thoughts-1.html"><i class="fa fa-check"></i><b>13.4</b> Concluding thoughts</a></li>
<li class="chapter" data-level="13.5" data-path="exercises-11.html"><a href="exercises-11.html"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html"><i class="fa fa-check"></i><b>14</b> Simulating Stochastic Dynamics</a>
<ul>
<li class="chapter" data-level="14.1" data-path="the-stochastic-logistic-model-redux.html"><a href="the-stochastic-logistic-model-redux.html"><i class="fa fa-check"></i><b>14.1</b> The stochastic logistic model redux</a></li>
<li class="chapter" data-level="14.2" data-path="a-stochastic-system-of-equations.html"><a href="a-stochastic-system-of-equations.html"><i class="fa fa-check"></i><b>14.2</b> A stochastic system of equations</a></li>
<li class="chapter" data-level="14.3" data-path="generalizing-the-approach-.html"><a href="generalizing-the-approach-.html"><i class="fa fa-check"></i><b>14.3</b> Generalizing the approach.</a></li>
<li class="chapter" data-level="14.4" data-path="exercises-12.html"><a href="exercises-12.html"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>15</b> Solving Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="meet-the-fokker-planck-equation.html"><a href="meet-the-fokker-planck-equation.html"><i class="fa fa-check"></i><b>15.1</b> Meet the Fokker-Planck Equation</a></li>
<li class="chapter" data-level="15.2" data-path="exercises-13.html"><a href="exercises-13.html"><i class="fa fa-check"></i><b>15.2</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="building-an-iterative-method" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Building an iterative method</h2>
<p>Now that we have worked on an example, let’s carefully formulate Euler’s method with another example. Consider the following differential equation:</p>
<p>Consider the following equation that describes the rate of change of the spread of a disease (such as Ebola, as we covered in the first section):</p>
<p><span class="math display">\[ \frac{dI}{dt} = 0.003 I \cdot (4000-I)  \]</span></p>
<p>Let’s call the function <span class="math inline">\(f(I) = 0.03 I\cdot (4000-I)\)</span>. In order to numerically approximate the solution, we will need to recall some concepts from calculus. One way that we can approximate the derivative is through a difference function:</p>
<p><span class="math display">\[ \frac{dI}{dt} = \lim_{\Delta t \rightarrow 0} \frac{I(t+\Delta t) - I(t)}{\Delta t} \]</span></p>
<p>As long as we consider the quantity <span class="math inline">\(\Delta t\)</span> to be small (say for this problem 0.1 days if you would like to have units attached to this), we can approximate the derivative with difference function on the right hand side. With this information, we have a reasonable way to organize the problem:</p>
<p><span class="math display">\[\begin{align*}
\frac{I(t+\Delta t) - I(t)}{\Delta t}  &amp;= 0.003 I \cdot (4000-I) \\
I(t+\Delta t) - I(t)  &amp;= 0.003 I \cdot (4000-I)  \cdot \Delta t \\
I(t+\Delta t) &amp;= I(t) + 0.003 I \cdot (4000-I)  \cdot \Delta t
\end{align*}\]</span></p>
<p>The last equation <span class="math inline">\(I(t+\Delta t) = I(t) + 0.03 I \cdot (4000-I) \cdot \Delta t = f(I) \cdot \Delta t\)</span> is a reasonable way to define an iterative system, especially if we have a spreadsheet program. Here is some code in <code>R</code> that can define a for loop to do this in an iterative way and then plot the solution with <code>plotData</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="building-an-iterative-method.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define your timestep and time vector</span></span>
<span id="cb23-2"><a href="building-an-iterative-method.html#cb23-2" aria-hidden="true" tabindex="-1"></a>deltaT <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb23-3"><a href="building-an-iterative-method.html#cb23-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="at">by=</span>deltaT)</span>
<span id="cb23-4"><a href="building-an-iterative-method.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="building-an-iterative-method.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of steps we take.  This is equal to 10 / dt (why?)</span></span>
<span id="cb23-6"><a href="building-an-iterative-method.html#cb23-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(t)</span>
<span id="cb23-7"><a href="building-an-iterative-method.html#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="building-an-iterative-method.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the initial condition</span></span>
<span id="cb23-9"><a href="building-an-iterative-method.html#cb23-9" aria-hidden="true" tabindex="-1"></a>i_approx <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb23-10"><a href="building-an-iterative-method.html#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="building-an-iterative-method.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a vector for your solution:the derivative equation</span></span>
<span id="cb23-12"><a href="building-an-iterative-method.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {  <span class="co"># We start this at 2 because the first value is 10</span></span>
<span id="cb23-13"><a href="building-an-iterative-method.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  didt <span class="ot">&lt;-</span> .<span class="dv">003</span> <span class="sc">*</span> i_approx[i<span class="dv">-1</span>] <span class="sc">*</span> (<span class="dv">4000</span><span class="sc">-</span>i_approx[i<span class="dv">-1</span>])</span>
<span id="cb23-14"><a href="building-an-iterative-method.html#cb23-14" aria-hidden="true" tabindex="-1"></a>  i_approx[i] <span class="ot">&lt;-</span> i_approx[i<span class="dv">-1</span>] <span class="sc">+</span> didt<span class="sc">*</span>deltaT</span>
<span id="cb23-15"><a href="building-an-iterative-method.html#cb23-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-16"><a href="building-an-iterative-method.html#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="building-an-iterative-method.html#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="building-an-iterative-method.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Define your data for the solution into a tibble:</span></span>
<span id="cb23-19"><a href="building-an-iterative-method.html#cb23-19" aria-hidden="true" tabindex="-1"></a>solution_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span>t,</span>
<span id="cb23-20"><a href="building-an-iterative-method.html#cb23-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">infected =</span> i_approx)</span>
<span id="cb23-21"><a href="building-an-iterative-method.html#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="building-an-iterative-method.html#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot your solution:</span></span>
<span id="cb23-23"><a href="building-an-iterative-method.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> solution_data) <span class="sc">+</span></span>
<span id="cb23-24"><a href="building-an-iterative-method.html#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">y=</span>infected)) </span></code></pre></div>
<div class="figure"><span id="fig:my-iterative-method"></span>
<img src="series_files/figure-html/my-iterative-method-1.png" alt="An iterative method" width="384" />
<p class="caption">
Figure 4.2: An iterative method
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="building-an-iterative-method.html#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Time&#39;</span>,</span>
<span id="cb24-2"><a href="building-an-iterative-method.html#cb24-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&#39;Infected&#39;</span>)</span></code></pre></div>
<pre><code>## $x
## [1] &quot;Time&quot;
## 
## $y
## [1] &quot;Infected&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;labels&quot;</code></pre>
<p>Ok, let’s discuss the different aspects of this code:</p>
<ul>
<li><code>deltaT &lt;- 0.1</code> and <code>t &lt;- seq(0,2,by=deltaT)</code> define the timesteps (<span class="math inline">\(\Delta t\)</span>) and the output time vector <code>t</code>. We also define <code>N &lt;- length(t)</code> so we know how many steps we take.</li>
<li><code>i_approx &lt;- 10</code> defines the initial condition to the system, in other words <span class="math inline">\(I(0)=10\)</span>.</li>
<li>The for loop goes through this system - first computing the value of <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> and then forecasing out the next timestep <span class="math inline">\(I(t+\Delta t) = f(I) \cdot \Delta t\)</span></li>
<li>The remaining code plots the dataframe, like we learned in Section <a href="r-intro-02.html#r-intro-02">2</a>.</li>
</ul>
<p>Let’s recap what we’ve learned to summarize Euler’s method. The most general form of a differential equation is:</p>
<p><span class="math display">\[ \displaystyle \frac{d\vec{y}}{dt} = f(\vec{y},\vec{\alpha},t), \]</span>
where <span class="math inline">\(\vec{y}\)</span> is the vector of state variables you want to solve for, and <span class="math inline">\(\vec{\alpha}\)</span> is your vector of parameters.</p>
<p>At a given initial condition, Euler’s method applies locally linear approximations to forecast the solution forward <span class="math inline">\(\Delta t\)</span> time units:</p>
<p><span class="math display">\[ \vec{y}_{n+1} = y_{n} + f(\vec{y}_{n},\vec{\alpha},t_{n}) \cdot \Delta t \]</span></p>
<p>To generate Figure <a href="building-an-iterative-method.html#fig:my-iterative-method">4.2</a> we created the solution directly in R - but you don’t want to copy and paste the code. I’ve created a function called <code>euler</code> that does the same process to generate the output solution:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="building-an-iterative-method.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the rate equation:</span></span>
<span id="cb26-2"><a href="building-an-iterative-method.html#cb26-2" aria-hidden="true" tabindex="-1"></a>system_eq <span class="ot">&lt;-</span> <span class="fu">c</span>(didt <span class="sc">~</span> .<span class="dv">003</span> <span class="sc">*</span> i <span class="sc">*</span> (<span class="dv">4000</span><span class="sc">-</span>i))</span>
<span id="cb26-3"><a href="building-an-iterative-method.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="building-an-iterative-method.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the initial condition (as a named vector)</span></span>
<span id="cb26-5"><a href="building-an-iterative-method.html#cb26-5" aria-hidden="true" tabindex="-1"></a>init_cond <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">i=</span><span class="dv">10</span>)</span>
<span id="cb26-6"><a href="building-an-iterative-method.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="building-an-iterative-method.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define deltaT and the time steps:</span></span>
<span id="cb26-8"><a href="building-an-iterative-method.html#cb26-8" aria-hidden="true" tabindex="-1"></a>deltaT <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb26-9"><a href="building-an-iterative-method.html#cb26-9" aria-hidden="true" tabindex="-1"></a>n_steps <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb26-10"><a href="building-an-iterative-method.html#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="building-an-iterative-method.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the solution via Euler&#39;s method:</span></span>
<span id="cb26-12"><a href="building-an-iterative-method.html#cb26-12" aria-hidden="true" tabindex="-1"></a>out_solution <span class="ot">&lt;-</span> <span class="fu">euler</span>(system_eq,<span class="at">initial_condition=</span>init_cond,<span class="at">deltaT=</span>deltaT,<span class="at">n_steps =</span> n_steps)</span>
<span id="cb26-13"><a href="building-an-iterative-method.html#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="building-an-iterative-method.html#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="building-an-iterative-method.html#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot your solution:</span></span>
<span id="cb26-16"><a href="building-an-iterative-method.html#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> out_solution) <span class="sc">+</span></span>
<span id="cb26-17"><a href="building-an-iterative-method.html#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>i)) </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-63"></span>
<img src="series_files/figure-html/unnamed-chunk-63-1.png" alt="Euler\'s method solution" width="384" />
<p class="caption">
Figure 4.3: Euler's method solution
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="building-an-iterative-method.html#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Time&#39;</span>,</span>
<span id="cb27-2"><a href="building-an-iterative-method.html#cb27-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&#39;Infected&#39;</span>)</span></code></pre></div>
<pre><code>## $x
## [1] &quot;Time&quot;
## 
## $y
## [1] &quot;Infected&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;labels&quot;</code></pre>
<p>Let’s talk through the steps of this code as well:</p>
<ul>
<li>The line <code>system_eq &lt;- c(didt ~ .003 * i * (4000-i))</code> represents the differential equation, written in formula notation. So <span class="math inline">\(\displaystyle \frac{dI}{dt} \rightarrow\)</span> <code>didt</code> and <span class="math inline">\(f(I) \rightarrow\)</span> <code>.003 * i * (4000-i))</code>, with the variable <code>i</code>.</li>
<li>The initial condition <span class="math inline">\(I(0)=10\)</span> is written as a <strong>named vector:</strong> <code>init_cond &lt;- c(i=10)</code>. Make sure the name of the variable is consistent with your differential equation.</li>
<li>As before we need to identify <span class="math inline">\(\Delta t\)</span> and the number of steps <span class="math inline">\(N\)</span>.</li>
</ul>
<p>The command <code>euler</code> then computes the solution applying Euler’s method, returning a data frame so we can plot the results. Note the columns of the data frame are the variables <span class="math inline">\(t\)</span> and <span class="math inline">\(i\)</span> that have been named in our equations.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="defining-an-algorithm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="eulers-method-applied-to-systems.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/04-eulersmethod.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/04-eulersmethod.Rmd",
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
