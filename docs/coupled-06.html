<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Coupled Systems of Equations | Exploring Modeling with Data and Differential Equations Using R</title>
  <meta name="description" content="A textbook used for combining differential equation models with data using R." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Coupled Systems of Equations | Exploring Modeling with Data and Differential Equations Using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A textbook used for combining differential equation models with data using R." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Coupled Systems of Equations | Exploring Modeling with Data and Differential Equations Using R" />
  
  <meta name="twitter:description" content="A textbook used for combining differential equation models with data using R." />
  

<meta name="author" content="John M. Zobitz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="phase-05.html"/>
<link rel="next" href="exact-solns-07.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computational-code"><i class="fa fa-check"></i>Computational code</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#questions-comments-issues"><i class="fa fa-check"></i>Questions? Comments? Issues?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-cover"><i class="fa fa-check"></i>About the cover</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Models with Differential Equations</b></span></li>
<li class="chapter" data-level="1" data-path="intro-01.html"><a href="intro-01.html"><i class="fa fa-check"></i><b>1</b> Models of Rates with Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-01.html"><a href="intro-01.html#rates-of-change-in-the-world-a-model-is-born"><i class="fa fa-check"></i><b>1.1</b> Rates of change in the world: a model is born</a></li>
<li class="chapter" data-level="1.2" data-path="intro-01.html"><a href="intro-01.html#modeling-in-context-the-spread-of-a-disease"><i class="fa fa-check"></i><b>1.2</b> Modeling in context: the spread of a disease</a></li>
<li class="chapter" data-level="1.3" data-path="intro-01.html"><a href="intro-01.html#model-solutions"><i class="fa fa-check"></i><b>1.3</b> Model solutions</a></li>
<li class="chapter" data-level="1.4" data-path="intro-01.html"><a href="intro-01.html#which-model-is-best"><i class="fa fa-check"></i><b>1.4</b> Which model is best?</a></li>
<li class="chapter" data-level="1.5" data-path="intro-01.html"><a href="intro-01.html#start-here"><i class="fa fa-check"></i><b>1.5</b> Start here</a></li>
<li class="chapter" data-level="1.6" data-path="intro-01.html"><a href="intro-01.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-intro-02.html"><a href="r-intro-02.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-intro-02.html"><a href="r-intro-02.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> <code>R</code> and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-intro-02.html"><a href="r-intro-02.html#first-steps-getting-acquainted-with-r"><i class="fa fa-check"></i><b>2.2</b> First steps: getting acquainted with <code>R</code></a></li>
<li class="chapter" data-level="2.3" data-path="r-intro-02.html"><a href="r-intro-02.html#increasing-functionality-with-packages"><i class="fa fa-check"></i><b>2.3</b> Increasing functionality with packages</a></li>
<li class="chapter" data-level="2.4" data-path="r-intro-02.html"><a href="r-intro-02.html#working-with-r-variables-data-frames-and-datasets"><i class="fa fa-check"></i><b>2.4</b> Working with <code>R</code>: variables, data frames, and datasets</a></li>
<li class="chapter" data-level="2.5" data-path="r-intro-02.html"><a href="r-intro-02.html#visualization-with-r"><i class="fa fa-check"></i><b>2.5</b> Visualization with <code>R</code></a></li>
<li class="chapter" data-level="2.6" data-path="r-intro-02.html"><a href="r-intro-02.html#defining-functions"><i class="fa fa-check"></i><b>2.6</b> Defining functions</a></li>
<li class="chapter" data-level="2.7" data-path="r-intro-02.html"><a href="r-intro-02.html#concluding-thoughts"><i class="fa fa-check"></i><b>2.7</b> Concluding thoughts</a></li>
<li class="chapter" data-level="2.8" data-path="r-intro-02.html"><a href="r-intro-02.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html"><i class="fa fa-check"></i><b>3</b> Modeling with Rates of Change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#competing-plant-species-and-equilibrium-solutions"><i class="fa fa-check"></i><b>3.1</b> Competing plant species and equilibrium solutions</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#the-law-of-mass-action"><i class="fa fa-check"></i><b>3.2</b> The Law of Mass Action</a></li>
<li class="chapter" data-level="3.3" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#coupled-differential-equations-lynx-and-hares"><i class="fa fa-check"></i><b>3.3</b> Coupled differential equations: lynx and hares</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#functional-responses"><i class="fa fa-check"></i><b>3.4</b> Functional responses</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-rates-03.html"><a href="modeling-rates-03.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="euler-04.html"><a href="euler-04.html"><i class="fa fa-check"></i><b>4</b> Euler’s Method</a>
<ul>
<li class="chapter" data-level="4.1" data-path="euler-04.html"><a href="euler-04.html#the-flu-and-locally-linear-approximation"><i class="fa fa-check"></i><b>4.1</b> The flu and locally linear approximation</a></li>
<li class="chapter" data-level="4.2" data-path="euler-04.html"><a href="euler-04.html#a-workflow-for-approximation"><i class="fa fa-check"></i><b>4.2</b> A workflow for approximation</a></li>
<li class="chapter" data-level="4.3" data-path="euler-04.html"><a href="euler-04.html#building-an-iterative-method"><i class="fa fa-check"></i><b>4.3</b> Building an iterative method</a></li>
<li class="chapter" data-level="4.4" data-path="euler-04.html"><a href="euler-04.html#eulers-method-and-beyond"><i class="fa fa-check"></i><b>4.4</b> Euler’s method and beyond</a></li>
<li class="chapter" data-level="4.5" data-path="euler-04.html"><a href="euler-04.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="phase-05.html"><a href="phase-05.html"><i class="fa fa-check"></i><b>5</b> Phase Lines and Equilibrium Solutions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="phase-05.html"><a href="phase-05.html#equilibrium-solutions"><i class="fa fa-check"></i><b>5.1</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="5.2" data-path="phase-05.html"><a href="phase-05.html#phase-lines-for-differential-equations"><i class="fa fa-check"></i><b>5.2</b> Phase lines for differential equations</a></li>
<li class="chapter" data-level="5.3" data-path="phase-05.html"><a href="phase-05.html#a-stability-test-for-equilibrium-solutions"><i class="fa fa-check"></i><b>5.3</b> A stability test for equilibrium solutions</a></li>
<li class="chapter" data-level="5.4" data-path="phase-05.html"><a href="phase-05.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="coupled-06.html"><a href="coupled-06.html"><i class="fa fa-check"></i><b>6</b> Coupled Systems of Equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="coupled-06.html"><a href="coupled-06.html#flu-with-quarantine-and-equilibrium-solutions"><i class="fa fa-check"></i><b>6.1</b> Flu with quarantine and equilibrium solutions</a></li>
<li class="chapter" data-level="6.2" data-path="coupled-06.html"><a href="coupled-06.html#nullclines"><i class="fa fa-check"></i><b>6.2</b> Nullclines</a></li>
<li class="chapter" data-level="6.3" data-path="coupled-06.html"><a href="coupled-06.html#phase-planes"><i class="fa fa-check"></i><b>6.3</b> Phase planes</a></li>
<li class="chapter" data-level="6.4" data-path="coupled-06.html"><a href="coupled-06.html#generating-a-phase-plane-in-r"><i class="fa fa-check"></i><b>6.4</b> Generating a phase plane in <code>R</code></a></li>
<li class="chapter" data-level="6.5" data-path="coupled-06.html"><a href="coupled-06.html#slope-fields"><i class="fa fa-check"></i><b>6.5</b> Slope fields</a></li>
<li class="chapter" data-level="6.6" data-path="coupled-06.html"><a href="coupled-06.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exact-solns-07.html"><a href="exact-solns-07.html"><i class="fa fa-check"></i><b>7</b> Exact Solutions to Differential Equations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-a-solution"><i class="fa fa-check"></i><b>7.1</b> Verify a solution</a></li>
<li class="chapter" data-level="7.2" data-path="exact-solns-07.html"><a href="exact-solns-07.html#separable-differential-equations"><i class="fa fa-check"></i><b>7.2</b> Separable differential equations</a></li>
<li class="chapter" data-level="7.3" data-path="exact-solns-07.html"><a href="exact-solns-07.html#integrating-factors"><i class="fa fa-check"></i><b>7.3</b> Integrating factors</a></li>
<li class="chapter" data-level="7.4" data-path="exact-solns-07.html"><a href="exact-solns-07.html#verify-broad-07"><i class="fa fa-check"></i><b>7.4</b> Applying the verification method to coupled equations</a></li>
<li class="chapter" data-level="7.5" data-path="exact-solns-07.html"><a href="exact-solns-07.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Parameterizing Models with Data</b></span></li>
<li class="chapter" data-level="8" data-path="linear-regression-08.html"><a href="linear-regression-08.html"><i class="fa fa-check"></i><b>8</b> Linear Regression and Curve Fitting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression-08.html"><a href="linear-regression-08.html#what-is-parameter-estimation"><i class="fa fa-check"></i><b>8.1</b> What is parameter estimation?</a></li>
<li class="chapter" data-level="8.2" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-for-global-temperature-data"><i class="fa fa-check"></i><b>8.2</b> Parameter estimation for global temperature data</a></li>
<li class="chapter" data-level="8.3" data-path="linear-regression-08.html"><a href="linear-regression-08.html#beyond-linear-08"><i class="fa fa-check"></i><b>8.3</b> Moving beyond linear models for parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="linear-regression-08.html"><a href="linear-regression-08.html#parameter-estimation-with-nonlinear-models"><i class="fa fa-check"></i><b>8.4</b> Parameter estimation with nonlinear models</a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression-08.html"><a href="linear-regression-08.html#towards-model-data-fusion"><i class="fa fa-check"></i><b>8.5</b> Towards model-data fusion</a></li>
<li class="chapter" data-level="8.6" data-path="linear-regression-08.html"><a href="linear-regression-08.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="likelihood-09.html"><a href="likelihood-09.html"><i class="fa fa-check"></i><b>9</b> Probability and Likelihood Functions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="likelihood-09.html"><a href="likelihood-09.html#linear-regression-on-a-small-dataset"><i class="fa fa-check"></i><b>9.1</b> Linear regression on a small dataset</a></li>
<li class="chapter" data-level="9.2" data-path="likelihood-09.html"><a href="likelihood-09.html#continuous-probability-density-functions"><i class="fa fa-check"></i><b>9.2</b> Continuous probability density functions</a></li>
<li class="chapter" data-level="9.3" data-path="likelihood-09.html"><a href="likelihood-09.html#connecting-probabilities-to-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Connecting probabilities to linear regression</a></li>
<li class="chapter" data-level="9.4" data-path="likelihood-09.html"><a href="likelihood-09.html#visualizing-likelihood-surfaces"><i class="fa fa-check"></i><b>9.4</b> Visualizing likelihood surfaces</a></li>
<li class="chapter" data-level="9.5" data-path="likelihood-09.html"><a href="likelihood-09.html#looking-back-and-forward"><i class="fa fa-check"></i><b>9.5</b> Looking back and forward</a></li>
<li class="chapter" data-level="9.6" data-path="likelihood-09.html"><a href="likelihood-09.html#exercises-8"><i class="fa fa-check"></i><b>9.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cost-fns-10.html"><a href="cost-fns-10.html"><i class="fa fa-check"></i><b>10</b> Cost Functions and Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cost-fns-10.html"><a href="cost-fns-10.html#cost-functions-and-model-data-residuals"><i class="fa fa-check"></i><b>10.1</b> Cost functions and model-data residuals</a></li>
<li class="chapter" data-level="10.2" data-path="cost-fns-10.html"><a href="cost-fns-10.html#further-extensions-to-the-cost-function"><i class="fa fa-check"></i><b>10.2</b> Further extensions to the cost function</a></li>
<li class="chapter" data-level="10.3" data-path="cost-fns-10.html"><a href="cost-fns-10.html#conditional-probabilities-and-bayes-rule"><i class="fa fa-check"></i><b>10.3</b> Conditional probabilities and Bayes’ rule</a></li>
<li class="chapter" data-level="10.4" data-path="cost-fns-10.html"><a href="cost-fns-10.html#bayes-rule-in-action"><i class="fa fa-check"></i><b>10.4</b> Bayes’ rule in action</a></li>
<li class="chapter" data-level="10.5" data-path="cost-fns-10.html"><a href="cost-fns-10.html#next-steps"><i class="fa fa-check"></i><b>10.5</b> Next steps</a></li>
<li class="chapter" data-level="10.6" data-path="cost-fns-10.html"><a href="cost-fns-10.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bootstrap-11.html"><a href="bootstrap-11.html"><i class="fa fa-check"></i><b>11</b> Sampling Distributions and the Bootstrap Method</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bootstrap-11.html"><a href="bootstrap-11.html#histograms-and-their-visualization"><i class="fa fa-check"></i><b>11.1</b> Histograms and their visualization</a></li>
<li class="chapter" data-level="11.2" data-path="bootstrap-11.html"><a href="bootstrap-11.html#statistical-theory-sampling-distributions"><i class="fa fa-check"></i><b>11.2</b> Statistical theory: sampling distributions</a></li>
<li class="chapter" data-level="11.3" data-path="bootstrap-11.html"><a href="bootstrap-11.html#summary-and-next-steps"><i class="fa fa-check"></i><b>11.3</b> Summary and next steps</a></li>
<li class="chapter" data-level="11.4" data-path="bootstrap-11.html"><a href="bootstrap-11.html#exercises-10"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="metropolis-12.html"><a href="metropolis-12.html"><i class="fa fa-check"></i><b>12</b> The Metropolis-Hastings Algorithm</a>
<ul>
<li class="chapter" data-level="12.1" data-path="metropolis-12.html"><a href="metropolis-12.html#estimating-the-growth-of-a-dog"><i class="fa fa-check"></i><b>12.1</b> Estimating the growth of a dog</a></li>
<li class="chapter" data-level="12.2" data-path="metropolis-12.html"><a href="metropolis-12.html#lr-12"><i class="fa fa-check"></i><b>12.2</b> Likelihood ratios for parameter estimation</a></li>
<li class="chapter" data-level="12.3" data-path="metropolis-12.html"><a href="metropolis-12.html#the-metropolis-hastings-algorithm-for-parameter-estimation"><i class="fa fa-check"></i><b>12.3</b> The Metropolis-Hastings algorithm for parameter estimation</a></li>
<li class="chapter" data-level="12.4" data-path="metropolis-12.html"><a href="metropolis-12.html#exercises-11"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mcmc-13.html"><a href="mcmc-13.html"><i class="fa fa-check"></i><b>13</b> Markov Chain Monte Carlo Parameter Estimation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mcmc-13.html"><a href="mcmc-13.html#the-recipe-for-mcmc"><i class="fa fa-check"></i><b>13.1</b> The recipe for MCMC</a></li>
<li class="chapter" data-level="13.2" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-an-empirical-model"><i class="fa fa-check"></i><b>13.2</b> MCMC parameter estimation with an empirical model</a></li>
<li class="chapter" data-level="13.3" data-path="mcmc-13.html"><a href="mcmc-13.html#mcmc-parameter-estimation-with-a-differential-equation-model"><i class="fa fa-check"></i><b>13.3</b> MCMC parameter estimation with a differential equation model</a></li>
<li class="chapter" data-level="13.4" data-path="mcmc-13.html"><a href="mcmc-13.html#timing-your-code"><i class="fa fa-check"></i><b>13.4</b> Timing your code</a></li>
<li class="chapter" data-level="13.5" data-path="mcmc-13.html"><a href="mcmc-13.html#further-extensions-to-mcmc"><i class="fa fa-check"></i><b>13.5</b> Further extensions to MCMC</a></li>
<li class="chapter" data-level="13.6" data-path="mcmc-13.html"><a href="mcmc-13.html#exercises-12"><i class="fa fa-check"></i><b>13.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="information-criteria-14.html"><a href="information-criteria-14.html"><i class="fa fa-check"></i><b>14</b> Information Criteria</a>
<ul>
<li class="chapter" data-level="14.1" data-path="information-criteria-14.html"><a href="information-criteria-14.html#model-assessment-guidelines"><i class="fa fa-check"></i><b>14.1</b> Model assessment guidelines</a></li>
<li class="chapter" data-level="14.2" data-path="information-criteria-14.html"><a href="information-criteria-14.html#information-criteria-for-assessing-competing-models"><i class="fa fa-check"></i><b>14.2</b> Information criteria for assessing competing models</a></li>
<li class="chapter" data-level="14.3" data-path="information-criteria-14.html"><a href="information-criteria-14.html#a-few-cautionary-notes"><i class="fa fa-check"></i><b>14.3</b> A few cautionary notes</a></li>
<li class="chapter" data-level="14.4" data-path="information-criteria-14.html"><a href="information-criteria-14.html#exercises-13"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Stability Analysis for Differential Equations</b></span></li>
<li class="chapter" data-level="15" data-path="linearsystems-15.html"><a href="linearsystems-15.html"><i class="fa fa-check"></i><b>15</b> Systems of Linear Differential Equations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="linearsystems-15.html"><a href="linearsystems-15.html#linear-systems-of-differential-equations-and-matrix-notation"><i class="fa fa-check"></i><b>15.1</b> Linear systems of differential equations and matrix notation</a></li>
<li class="chapter" data-level="15.2" data-path="linearsystems-15.html"><a href="linearsystems-15.html#equilibrium-solutions-1"><i class="fa fa-check"></i><b>15.2</b> Equilibrium solutions</a></li>
<li class="chapter" data-level="15.3" data-path="linearsystems-15.html"><a href="linearsystems-15.html#the-phase-plane"><i class="fa fa-check"></i><b>15.3</b> The phase plane</a></li>
<li class="chapter" data-level="15.4" data-path="linearsystems-15.html"><a href="linearsystems-15.html#non-equilibrium-solutions-and-their-stability"><i class="fa fa-check"></i><b>15.4</b> Non-equilibrium solutions and their stability</a></li>
<li class="chapter" data-level="15.5" data-path="linearsystems-15.html"><a href="linearsystems-15.html#exercises-14"><i class="fa fa-check"></i><b>15.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="nonlinear-16.html"><a href="nonlinear-16.html"><i class="fa fa-check"></i><b>16</b> Systems of Nonlinear Differential Equations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nonlinear-16.html"><a href="nonlinear-16.html#introducing-nonlinear-systems-of-differential-equations"><i class="fa fa-check"></i><b>16.1</b> Introducing nonlinear systems of differential equations</a></li>
<li class="chapter" data-level="16.2" data-path="nonlinear-16.html"><a href="nonlinear-16.html#zooming-in-on-the-phase-plane"><i class="fa fa-check"></i><b>16.2</b> Zooming in on the phase plane</a></li>
<li class="chapter" data-level="16.3" data-path="nonlinear-16.html"><a href="nonlinear-16.html#determining-equilibrium-solutions-with-nullclines"><i class="fa fa-check"></i><b>16.3</b> Determining equilibrium solutions with nullclines</a></li>
<li class="chapter" data-level="16.4" data-path="nonlinear-16.html"><a href="nonlinear-16.html#stability-of-an-equilibrium-solution"><i class="fa fa-check"></i><b>16.4</b> Stability of an equilibrium solution</a></li>
<li class="chapter" data-level="16.5" data-path="nonlinear-16.html"><a href="nonlinear-16.html#graphing-nullclines-in-a-phase-plane"><i class="fa fa-check"></i><b>16.5</b> Graphing nullclines in a phase plane</a></li>
<li class="chapter" data-level="16.6" data-path="nonlinear-16.html"><a href="nonlinear-16.html#exercises-15"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="jacobian-17.html"><a href="jacobian-17.html"><i class="fa fa-check"></i><b>17</b> Local Linearization and the Jacobian</a>
<ul>
<li class="chapter" data-level="17.1" data-path="jacobian-17.html"><a href="jacobian-17.html#competing-populations"><i class="fa fa-check"></i><b>17.1</b> Competing populations</a></li>
<li class="chapter" data-level="17.2" data-path="jacobian-17.html"><a href="jacobian-17.html#tangent-plane-approximations"><i class="fa fa-check"></i><b>17.2</b> Tangent plane approximations</a></li>
<li class="chapter" data-level="17.3" data-path="jacobian-17.html"><a href="jacobian-17.html#the-jacobian-matrix"><i class="fa fa-check"></i><b>17.3</b> The Jacobian matrix</a></li>
<li class="chapter" data-level="17.4" data-path="jacobian-17.html"><a href="jacobian-17.html#exercises-16"><i class="fa fa-check"></i><b>17.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html"><i class="fa fa-check"></i><b>18</b> What are Eigenvalues?</a>
<ul>
<li class="chapter" data-level="18.1" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#introduction"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#straight-line-solutions"><i class="fa fa-check"></i><b>18.2</b> Straight line solutions</a></li>
<li class="chapter" data-level="18.3" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#computing-eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>18.3</b> Computing eigenvalues and eigenvectors</a></li>
<li class="chapter" data-level="18.4" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#what-do-eigenvalues-tell-us"><i class="fa fa-check"></i><b>18.4</b> What do eigenvalues tell us?</a></li>
<li class="chapter" data-level="18.5" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#concluding-thoughts-1"><i class="fa fa-check"></i><b>18.5</b> Concluding thoughts</a></li>
<li class="chapter" data-level="18.6" data-path="eigenvalues-18.html"><a href="eigenvalues-18.html#exercises-17"><i class="fa fa-check"></i><b>18.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="stability-19.html"><a href="stability-19.html"><i class="fa fa-check"></i><b>19</b> Qualitative Stability Analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="stability-19.html"><a href="stability-19.html#the-characteristic-polynomial-again"><i class="fa fa-check"></i><b>19.1</b> The characteristic polynomial (again)</a></li>
<li class="chapter" data-level="19.2" data-path="stability-19.html"><a href="stability-19.html#stability-with-the-trace-and-determinant"><i class="fa fa-check"></i><b>19.2</b> Stability with the trace and determinant</a></li>
<li class="chapter" data-level="19.3" data-path="stability-19.html"><a href="stability-19.html#a-workflow-for-stability-analysis"><i class="fa fa-check"></i><b>19.3</b> A workflow for stability analysis</a></li>
<li class="chapter" data-level="19.4" data-path="stability-19.html"><a href="stability-19.html#stability-for-higher-order-systems-of-differential-equations."><i class="fa fa-check"></i><b>19.4</b> Stability for higher-order systems of differential equations.</a></li>
<li class="chapter" data-level="19.5" data-path="stability-19.html"><a href="stability-19.html#exercises-18"><i class="fa fa-check"></i><b>19.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="bifurcation-20.html"><a href="bifurcation-20.html"><i class="fa fa-check"></i><b>20</b> Bifurcation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="bifurcation-20.html"><a href="bifurcation-20.html#a-series-of-equations"><i class="fa fa-check"></i><b>20.1</b> A series of equations</a></li>
<li class="chapter" data-level="20.2" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-with-systems-of-equations"><i class="fa fa-check"></i><b>20.2</b> Bifurcations with systems of equations</a></li>
<li class="chapter" data-level="20.3" data-path="bifurcation-20.html"><a href="bifurcation-20.html#functions-as-equilibrium-solutions-limit-cycles"><i class="fa fa-check"></i><b>20.3</b> Functions as equilibrium solutions: limit cycles</a></li>
<li class="chapter" data-level="20.4" data-path="bifurcation-20.html"><a href="bifurcation-20.html#bifurcations-as-analysis-tools"><i class="fa fa-check"></i><b>20.4</b> Bifurcations as analysis tools</a></li>
<li class="chapter" data-level="20.5" data-path="bifurcation-20.html"><a href="bifurcation-20.html#exercises-19"><i class="fa fa-check"></i><b>20.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>IV Stochastic Differential Equations</b></span></li>
<li class="chapter" data-level="21" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html"><i class="fa fa-check"></i><b>21</b> Stochastic Biological Systems</a>
<ul>
<li class="chapter" data-level="21.1" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#introducing-stochastic-effects"><i class="fa fa-check"></i><b>21.1</b> Introducing stochastic effects</a></li>
<li class="chapter" data-level="21.2" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#a-discrete-dynamical-system"><i class="fa fa-check"></i><b>21.2</b> A discrete dynamical system</a></li>
<li class="chapter" data-level="21.3" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#environmental-stochasticity"><i class="fa fa-check"></i><b>21.3</b> Environmental stochasticity</a></li>
<li class="chapter" data-level="21.4" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#discrete-systems-of-equations"><i class="fa fa-check"></i><b>21.4</b> Discrete systems of equations</a></li>
<li class="chapter" data-level="21.5" data-path="stoch-sys-21.html"><a href="stoch-sys-21.html#exercises-20"><i class="fa fa-check"></i><b>21.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html"><i class="fa fa-check"></i><b>22</b> Simulating and Visualizing Randomness</a>
<ul>
<li class="chapter" data-level="22.1" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#ensemble-averages"><i class="fa fa-check"></i><b>22.1</b> Ensemble averages</a></li>
<li class="chapter" data-level="22.2" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#repeated-iteration"><i class="fa fa-check"></i><b>22.2</b> Repeated iteration</a></li>
<li class="chapter" data-level="22.3" data-path="stoch-sim-22.html"><a href="stoch-sim-22.html#exercises-21"><i class="fa fa-check"></i><b>22.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="random-walks-23.html"><a href="random-walks-23.html"><i class="fa fa-check"></i><b>23</b> Random Walks</a>
<ul>
<li class="chapter" data-level="23.1" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-on-a-number-line"><i class="fa fa-check"></i><b>23.1</b> Random walk on a number line</a></li>
<li class="chapter" data-level="23.2" data-path="random-walks-23.html"><a href="random-walks-23.html#iteration-and-ensemble-averages"><i class="fa fa-check"></i><b>23.2</b> Iteration and ensemble averages</a></li>
<li class="chapter" data-level="23.3" data-path="random-walks-23.html"><a href="random-walks-23.html#random-walk-mathematics"><i class="fa fa-check"></i><b>23.3</b> Random walk mathematics</a></li>
<li class="chapter" data-level="23.4" data-path="random-walks-23.html"><a href="random-walks-23.html#continuous-random-walks-and-diffusion"><i class="fa fa-check"></i><b>23.4</b> Continuous random walks and diffusion</a></li>
<li class="chapter" data-level="23.5" data-path="random-walks-23.html"><a href="random-walks-23.html#exercises-22"><i class="fa fa-check"></i><b>23.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="diffusion-24.html"><a href="diffusion-24.html"><i class="fa fa-check"></i><b>24</b> Diffusion and Brownian Motion</a>
<ul>
<li class="chapter" data-level="24.1" data-path="diffusion-24.html"><a href="diffusion-24.html#random-walk-redux"><i class="fa fa-check"></i><b>24.1</b> Random walk redux</a></li>
<li class="chapter" data-level="24.2" data-path="diffusion-24.html"><a href="diffusion-24.html#simulating-brownian-motion"><i class="fa fa-check"></i><b>24.2</b> Simulating Brownian motion</a></li>
<li class="chapter" data-level="24.3" data-path="diffusion-24.html"><a href="diffusion-24.html#exercises-23"><i class="fa fa-check"></i><b>24.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sdes-25.html"><a href="sdes-25.html"><i class="fa fa-check"></i><b>25</b> Simulating Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="25.1" data-path="sdes-25.html"><a href="sdes-25.html#the-stochastic-logistic-model"><i class="fa fa-check"></i><b>25.1</b> The stochastic logistic model</a></li>
<li class="chapter" data-level="25.2" data-path="sdes-25.html"><a href="sdes-25.html#the-euler-maruyama-method"><i class="fa fa-check"></i><b>25.2</b> The Euler-Maruyama method</a></li>
<li class="chapter" data-level="25.3" data-path="sdes-25.html"><a href="sdes-25.html#adding-stochasticity-to-parameters"><i class="fa fa-check"></i><b>25.3</b> Adding stochasticity to parameters</a></li>
<li class="chapter" data-level="25.4" data-path="sdes-25.html"><a href="sdes-25.html#systems-of-stochastic-differential-equations"><i class="fa fa-check"></i><b>25.4</b> Systems of stochastic differential equations</a></li>
<li class="chapter" data-level="25.5" data-path="sdes-25.html"><a href="sdes-25.html#concluding-thoughts-2"><i class="fa fa-check"></i><b>25.5</b> Concluding thoughts</a></li>
<li class="chapter" data-level="25.6" data-path="sdes-25.html"><a href="sdes-25.html#exercises-24"><i class="fa fa-check"></i><b>25.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html"><i class="fa fa-check"></i><b>26</b> Statistics of a Stochastic Differential Equation</a>
<ul>
<li class="chapter" data-level="26.1" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#expected-value-of-a-stochastic-process"><i class="fa fa-check"></i><b>26.1</b> Expected value of a stochastic process</a></li>
<li class="chapter" data-level="26.2" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#birth-death-processes"><i class="fa fa-check"></i><b>26.2</b> Birth-death processes</a></li>
<li class="chapter" data-level="26.3" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#wrapping-up"><i class="fa fa-check"></i><b>26.3</b> Wrapping up</a></li>
<li class="chapter" data-level="26.4" data-path="simul-stoch-26.html"><a href="simul-stoch-26.html#exercises-25"><i class="fa fa-check"></i><b>26.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>27</b> Solutions to Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="27.1" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#meet-the-fokker-planck-equation"><i class="fa fa-check"></i><b>27.1</b> Meet the Fokker-Planck equation</a></li>
<li class="chapter" data-level="27.2" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#deterministically-the-end"><i class="fa fa-check"></i><b>27.2</b> Deterministically the end</a></li>
<li class="chapter" data-level="27.3" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html#exercises-26"><i class="fa fa-check"></i><b>27.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Modeling with Data and Differential Equations Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="coupled-06" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Coupled Systems of Equations<a href="coupled-06.html#coupled-06" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Chapter <a href="phase-05.html#phase-05">5</a> focused on qualitative analysis of a single differential equation using phase lines and slope fields. This chapter extends this idea further to systems of differential equations, where the natural extension of a phase line is a <em>phase plane</em>. Here is the good news: many of the techniques are similar to the ones introduced in Chapter <a href="phase-05.html#phase-05">5</a>, so let’s get started!</p>
<div id="flu-with-quarantine-and-equilibrium-solutions" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Flu with quarantine and equilibrium solutions<a href="coupled-06.html#flu-with-quarantine-and-equilibrium-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Exercise <a href="intro-01.html#exr:flu-quarantine-01">1.9</a> in Chapter <a href="intro-01.html#intro-01">1</a> we developed the following model for the flu as a coupled system of equations shown in Equation <a href="coupled-06.html#eq:flu-quarantine-06">(6.1)</a>:</p>
<p><span class="math display" id="eq:flu-quarantine-06">\[\begin{equation}
\begin{split}
\frac{dS}{dt} &amp;= -kSI \\
\frac{dI}{dt} &amp;= kSI-\beta I \\
\frac{dR}{dt} &amp;= \beta I,
\end{split} \tag{6.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(S\)</span> represents susceptible people, <span class="math inline">\(I\)</span> infected people, and <span class="math inline">\(R\)</span> recovered people. Another way to represent this context is with the schematic shown in Figure <a href="coupled-06.html#fig:quarantine">6.1</a>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:quarantine"></span>
<img src="explore-model-zobitz-220419_files/figure-html/quarantine-1.png" alt="Schematic of the flu model with quarantine." width="672" />
<p class="caption">
FIGURE 6.1: Schematic of the flu model with quarantine.
</p>
</div>
<p>While Equation <a href="coupled-06.html#eq:flu-quarantine-06">(6.1)</a> is a system of three differential equations, notice that the variable <span class="math inline">\(R\)</span> is not present on the right hand sides of each equation. As a result, the variable <span class="math inline">\(R\)</span> is decoupled from this system of equations, so we can just focus on the rates of change for <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> (Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a>):</p>
<p><span class="math display" id="eq:flu-quarantine-small-06">\[\begin{equation}
\begin{split}
\frac{dS}{dt} &amp;= -kSI \\
\frac{dI}{dt} &amp;= kSI-\beta I \\
\end{split} \tag{6.2}
\end{equation}\]</span></p>
<p>With Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> we will solve for equilibrium solutions (similar to what we did in Chapters <a href="modeling-rates-03.html#modeling-rates-03">3</a> and <a href="phase-05.html#phase-05">5</a>), which we focus on next.</p>
</div>
<div id="nullclines" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Nullclines<a href="coupled-06.html#nullclines" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The process to determine equilibrium solutions for a system of differential equations starts with computing the <em>nullclines</em> for each rate in the system of equations. The nullclines are solutions in the plane where one of the rates is zero, so for example either <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> or <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> is zero. For coupled systems of equations, the equilibrium solutions are where the rates <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> in Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> are <em>both</em> zero, found through algebraically solving the system of equations in Equation <a href="coupled-06.html#eq:flu-ss-06">(6.3)</a>:</p>
<p><span class="math display" id="eq:flu-ss-06">\[\begin{equation}
\begin{split}
0 &amp;= -kSI \\
0 &amp;= kSI - \beta I
\end{split} \tag{6.3}
\end{equation}\]</span></p>
<p>Let’s examine the first equation (<span class="math inline">\(0 = -kSI\)</span>). Since all the terms are expressed as a product, then nullclines for <span class="math inline">\(S\)</span> occur when either <span class="math inline">\(S=0\)</span> or <span class="math inline">\(I=0\)</span>.</p>
<p>In a similar manner, the nullclines for <span class="math inline">\(I\)</span> occur when <span class="math inline">\(0 = kSI - \beta I\)</span>. For this expression we can factor out an <span class="math inline">\(I\)</span>, yielding <span class="math inline">\(0 = I \cdot (kS - \beta)\)</span>. Because the last equation is factored as a product, nullclines for <span class="math inline">\(I\)</span> are either <span class="math inline">\(I=0\)</span> or by solving <span class="math inline">\(kS-\beta\)</span> for <span class="math inline">\(S\)</span> to yield <span class="math inline">\(\displaystyle S = \frac{\beta}{k}\)</span>.</p>
<p>Nullclines are not equilibrium solutions by themselves - it is the <em>intersection</em> of two different nullclines that determines equilibrium solutions. Figure <a href="coupled-06.html#fig:quarantine-nullclines">6.2</a> shows the nullclines in the <span class="math inline">\(S-I\)</span> plane (since we have two equations), with <span class="math inline">\(S\)</span> on the horizontal axis and <span class="math inline">\(I\)</span> on the vertical axis. In Figure <a href="coupled-06.html#fig:quarantine-nullclines">6.2</a> we have also assumed that <span class="math inline">\(\beta=1\)</span> and <span class="math inline">\(k=1\)</span>. The <span class="math inline">\(S-I\)</span> plane shown in Figure <a href="coupled-06.html#fig:quarantine-nullclines">6.2</a> is the beginning of the construction of the phase plane for Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> and also to determine the equilibrium solutions.</p>
<div class="figure"><span style="display:block;" id="fig:quarantine-nullclines"></span>
<img src="explore-model-zobitz-220419_files/figure-html/quarantine-nullclines-1.png" alt="Nullclines for Equation \@ref(eq:flu-quarantine-small-06). To generate the plot we assumed $\beta=1$ and $k=1$." width="672" />
<p class="caption">
FIGURE 6.2: Nullclines for Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a>. To generate the plot we assumed <span class="math inline">\(\beta=1\)</span> and <span class="math inline">\(k=1\)</span>.
</p>
</div>
<p>A key thing to note is that where two different nullclines cross is an <em>equilibrium solution</em> to the system of equations (<strong>both</strong> <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> are zero at this point). Examining Figure <a href="coupled-06.html#fig:quarantine-nullclines">6.2</a> three possibilities appear:</p>
<ol style="list-style-type: decimal">
<li>There is an equilibrium solution at <span class="math inline">\(S=0\)</span> and <span class="math inline">\(I=0\)</span> (otherwise known as the origin). This equilibrium solution makes biological sense: if there is nobody susceptible or infected there are no flu cases (everyone is perfectly healthy - yay!) .</li>
<li>The entire horizontal axis is an equilibrium solution because <span class="math inline">\(I=0\)</span>, which makes both <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> zero. There is a practical interpretation of this nullcline - whenever <span class="math inline">\(I=0\)</span>, meaning there are no infected people around, infection cannot occur.</li>
<li>There is also a third possibility where the vertical line at <span class="math inline">\(S=1\)</span> crosses the horizontal axis (<span class="math inline">\(S=1\)</span>, <span class="math inline">\(I=0\)</span>), but that also falls under the second equilibrium solution.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></li>
</ol>
<p>Now that we have identified our nullclines and equilibrium solutions, we will add additional context with the <em>flow</em> of the solution.</p>
</div>
<div id="phase-planes" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Phase planes<a href="coupled-06.html#phase-planes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next we can add more context to the Figure <a href="coupled-06.html#fig:quarantine-nullclines">6.2</a> by evaluating different values of <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> into our system of equations and plotting the <em>phase plane</em>. How we plot the phase plane is similar to the method in Chapter <a href="phase-05.html#phase-05">5</a>. We will test points around an equilibrium solution to determine if the solution is increasing or decreasing in <span class="math inline">\(S\)</span> or <span class="math inline">\(I\)</span> independently.</p>
<p>Table <a href="coupled-06.html#tab:slope-arrows-06">6.1</a> evaluates the derivatives <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> in <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> for different values of <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span>.</p>
<table>
<caption>
<span id="tab:slope-arrows-06">TABLE 6.1: </span>Values of <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> (as <code>dSdt</code>) and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> (as <code>dIdt</code>) for Equation <span class="math inline">\(\ref{eq:flu-quarantine-small-06}\)</span>.
</caption>
<tbody>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
dSdt
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
-4
</td>
</tr>
<tr>
<td style="text-align:left;">
dIdt
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>Notice in Table <a href="coupled-06.html#tab:slope-arrows-06">6.1</a> the different values of <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> in Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> at each of the given <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> values. We can plot each of the coordinate pairs of <span class="math inline">\(\displaystyle \left( \frac{dS}{dt}, \frac{dI}{dt} \right)\)</span> as a vector (arrows) in the <span class="math inline">\((S,I)\)</span> plane. To do so, associate <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> with left-right motion, so positive values of <span class="math inline">\(\displaystyle \frac{dS}{dt}\)</span> mean the vector points to the right. Likewise, we associate <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> with up-down motion, so positive values <span class="math inline">\(\displaystyle \frac{dI}{dt}\)</span> mean the vector points up.</p>
<p>Defining the directions of the vectors in this way is also consistent when Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a> is evaluated at the nullcline solutions. At the point <span class="math inline">\((S,I)=(1,1)\)</span>, we have an arrow that points directly to the west because <span class="math inline">\(\displaystyle \frac{dS}{dt} &lt; 0\)</span> and <span class="math inline">\(\displaystyle \frac{dI}{dt} =0\)</span>. Continuing on in this manner, by sequentially sampling points in the <span class="math inline">\((S,I)\)</span> plane we get a vector field plot (Figure <a href="coupled-06.html#fig:slope-field-06">6.3</a>), superimposed with the nullclines.</p>
<div class="figure"><span style="display:block;" id="fig:slope-field-06"></span>
<img src="explore-model-zobitz-220419_files/figure-html/slope-field-06-1.png" alt="Phase plane for Equation \@ref(eq:flu-quarantine-small-06), with $\beta=1$ and $k=1$." width="672" />
<p class="caption">
FIGURE 6.3: Phase plane for Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a>, with <span class="math inline">\(\beta=1\)</span> and <span class="math inline">\(k=1\)</span>.
</p>
</div>
<div id="motion-around-the-nullclines" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Motion around the nullclines<a href="coupled-06.html#motion-around-the-nullclines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also extend the motion around the nullclines to investigate the stability of an equilbrium solution. With a one-dimensional differential equation we used a number line to quantify values where the solution is increasing / decreasing. The problem with several differential equations is that the notion of “increasing” or “decreasing” becomes difficult to understand - there is an additional degree of freedom! Simply put, in a plane you can move left/right <em>or</em> up/down. The benefit for having nullclines is that they <strong>isolate</strong> the motion in one direction. When <span class="math inline">\(\displaystyle \frac{dS}{dt}=0\)</span> the only allowed motion is up and down; when <span class="math inline">\(\displaystyle \frac{dI}{dt}=0\)</span> the only allowed motion is left and right.</p>
<p>In general for a two-dimensional system:</p>
<ul>
<li>When a horizontal axis variable has a nullcline, the only allowed motion is up/down.</li>
<li>When a vertical axis variable has a nullcline, the only motion is up/down.</li>
</ul>
<p>Applying this knowledge to Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a>, if we choose points where <span class="math inline">\(I&#39;=0\)</span> then we know that the only motion is to the left and the right because <span class="math inline">\(S\)</span> can still change along that curve. If we choose points where <span class="math inline">\(S&#39;=0\)</span> then we know that the only motion is to the up/down because <span class="math inline">\(I\)</span> can still change along that curve.</p>
</div>
<div id="stability-of-an-equilbrium-solution" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Stability of an equilbrium solution<a href="coupled-06.html#stability-of-an-equilbrium-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figure <a href="coupled-06.html#fig:slope-field-06">6.3</a> qualitatively tells us about the stability of an equilibrium point. One of the equilibrium solutions is at the origin <span class="math inline">\((S,I)=(0,0)\)</span>. As before we want to investigate if the equilibrium solution is stable or unstable. As you can see the arrows appear to be pointing into and towards the equilibrium solution. So we would classify this equilbrium solution as <em>stable</em>.</p>
</div>
</div>
<div id="generating-a-phase-plane-in-r" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Generating a phase plane in <code>R</code><a href="coupled-06.html#generating-a-phase-plane-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s take what we learned from the case study of the flu model with quarantine to qualitatively analyze a system of differential equations:</p>
<ul>
<li>We determine nullclines by setting the derivatives equal to zero.</li>
<li>Equilibrium solutions occur where nullclines for the two different equations intersect.</li>
<li>The arrows in the phase plane help us characterize the stability of the equilibrium solution.</li>
</ul>
<p>The <code>demodelr</code> package has some basic functionality to generate a phase plane. Consider the following system of differential equations (Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a>):</p>
<p><span class="math display" id="eq:phase-example">\[\begin{equation}
\begin{split}
\frac{dx}{dt} &amp;= x-y \\
\frac{dy}{dt} &amp;= x+y
\end{split} \tag{6.4}
\end{equation}\]</span></p>
<p>In order to generate a phase plane diagram for Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a> we need to define functions for <span class="math inline">\(x&#39;\)</span> and <span class="math inline">\(y&#39;\)</span>, which I will annotate as <span class="math inline">\(dx\)</span> and <span class="math inline">\(dy\)</span> respectively. We are going to collect these equations in one vector called <code>system_eq</code>, using the tilde (~) as a replacement for the equals sign:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="coupled-06.html#cb25-1" tabindex="-1"></a>system_eq <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb25-2"><a href="coupled-06.html#cb25-2" tabindex="-1"></a>  dx <span class="sc">~</span> x <span class="sc">-</span> y,</span>
<span id="cb25-3"><a href="coupled-06.html#cb25-3" tabindex="-1"></a>  dy <span class="sc">~</span> x <span class="sc">+</span> y</span>
<span id="cb25-4"><a href="coupled-06.html#cb25-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Then what we do is apply the command <code>phaseplane</code>, which will generate a vector field over a domain:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="coupled-06.html#cb26-1" tabindex="-1"></a><span class="fu">phaseplane</span>(system_eq,</span>
<span id="cb26-2"><a href="coupled-06.html#cb26-2" tabindex="-1"></a>  <span class="at">x_var =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb26-3"><a href="coupled-06.html#cb26-3" tabindex="-1"></a>  <span class="at">y_var =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb26-4"><a href="coupled-06.html#cb26-4" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-77"></span>
<img src="explore-model-zobitz-220419_files/figure-html/unnamed-chunk-77-1.png" alt="Phase plane for Equation \@ref(eq:phase-example)." width="672" />
<p class="caption">
FIGURE 6.4: Phase plane for Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a>.
</p>
</div>
<p>Let’s discuss how the <code>phaseplane</code> function works, first with the required inputs:</p>
<ul>
<li>You will need a system of differential equations (which we defined as <code>system_eq</code>).</li>
<li>Next you need to define which variable belongs on the horizontal axis (<code>x_var = 'x'</code>) or the vertical axis (<code>y_var = 'y'</code>). In Exercise <a href="coupled-06.html#exr:wacky-phase">6.3</a> you will explore what happens if these get mixed up.</li>
</ul>
<p>There are some additional options for <code>phaseplane</code>:</p>
<ul>
<li>The option <code>eq_soln = TRUE</code> will determine if there are any equilibrium solutions to be found and report them to the console. This option does not provide a definitive answer, but at least it tells you where to look. You can always confirm if a point is an equilibrium solution by evaluating the differential equation.</li>
<li>You can adjust the windows that are plotted with the options <code>x_window</code> and <code>y_window</code>. Both of these need to be defined as a vector (e.g. <code>x_window = c(-0.1,0.1)</code>. The default window size is <span class="math inline">\([-4,4]\)</span> for both axes.</li>
<li>There is an option <code>parameters</code> that allows you to pass any parameters to the phase plane. Later chapters will introduce systems where you can modify the parameters - we won’t worry about that now.</li>
</ul>
</div>
<div id="slope-fields" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Slope fields<a href="coupled-06.html#slope-fields" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a one-dimensional differential equation, we call the phase plane a <em>slope field</em>. For a given differential equation <span class="math inline">\(y&#39;=f(t,y)\)</span>, at each point in the <span class="math inline">\(t-y\)</span> plane the differential equation is evaluated, showing the direction of the tangent line at that particular point. The <code>phaseplane</code> function can also plot slope fields. Let’s take a look at an example first and then discuss how that it works.</p>
<div class="example">
<p><span id="exm:unnamed-chunk-78" class="example"><strong>Example 6.1  </strong></span>A colony of bacteria growing in a nutrient-rich medium depletes the nutrient as they grow. As a result, the nutrient concentration <span class="math inline">\(x(t)\)</span> is steadily decreasing. Determine the slope field for the following differential equation:</p>
<p><span class="math display" id="eq:bacteria-colony-06">\[\begin{equation}
\frac{dx}{dt} = - 0.7 \cdot \frac{x \cdot (3- x)}{1 + x} \tag{6.5}
\end{equation}\]</span></p>
</div>
<p>The <code>R</code> code shown below will generate the slope field for Equation <a href="coupled-06.html#eq:bacteria-colony-06">(6.5)</a> (shown in Figure <a href="coupled-06.html#fig:phaseline-06">6.5</a>):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="coupled-06.html#cb27-1" tabindex="-1"></a><span class="co"># Define the windows where we make the plots</span></span>
<span id="cb27-2"><a href="coupled-06.html#cb27-2" tabindex="-1"></a>t_window <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb27-3"><a href="coupled-06.html#cb27-3" tabindex="-1"></a>x_window <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb27-4"><a href="coupled-06.html#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="coupled-06.html#cb27-5" tabindex="-1"></a><span class="co"># Define the differential equation</span></span>
<span id="cb27-6"><a href="coupled-06.html#cb27-6" tabindex="-1"></a>system_eq <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-7"><a href="coupled-06.html#cb27-7" tabindex="-1"></a>  dt <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-8"><a href="coupled-06.html#cb27-8" tabindex="-1"></a>  dx <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.7</span> <span class="sc">*</span> x <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">-</span> x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb27-9"><a href="coupled-06.html#cb27-9" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="coupled-06.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="coupled-06.html#cb27-11" tabindex="-1"></a><span class="fu">phaseplane</span>(system_eq,</span>
<span id="cb27-12"><a href="coupled-06.html#cb27-12" tabindex="-1"></a>  <span class="at">x_var =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb27-13"><a href="coupled-06.html#cb27-13" tabindex="-1"></a>  <span class="at">y_var =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb27-14"><a href="coupled-06.html#cb27-14" tabindex="-1"></a>  <span class="at">x_window =</span> t_window,</span>
<span id="cb27-15"><a href="coupled-06.html#cb27-15" tabindex="-1"></a>  <span class="at">y_window =</span> x_window</span>
<span id="cb27-16"><a href="coupled-06.html#cb27-16" tabindex="-1"></a>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:phaseline-06"></span>
<img src="explore-model-zobitz-220419_files/figure-html/phaseline-06-1.png" alt="Slope field for Equation \@ref(eq:bacteria-colony-06)." width="672" />
<p class="caption">
FIGURE 6.5: Slope field for Equation <a href="coupled-06.html#eq:bacteria-colony-06">(6.5)</a>.
</p>
</div>
<p>A few notes about the code that generated Figure <a href="coupled-06.html#fig:phaseline-06">6.5</a>:</p>
<ul>
<li>The variable on the horizontal axis (<code>x_var</code>) is <span class="math inline">\(t\)</span>, and on the vertical axis (<code>y_var</code>) is <span class="math inline">\(x\)</span>. Confusing, I know.</li>
<li>The viewing window for the axis is also defined accordingly.</li>
<li>Notice how the variable <code>system_eq</code> also contains the additional equation <code>dt = 1</code>. What we are doing is re-writing Equation <a href="coupled-06.html#eq:bacteria-colony-06">(6.5)</a> by introducing a new variable <span class="math inline">\(s\)</span> (Equation <a href="coupled-06.html#eq:single-phase">(6.6)</a>):</li>
</ul>
<p><span class="math display" id="eq:single-phase">\[\begin{equation}
\begin{split}
\frac{dt}{ds} &amp;= 1 \\
\frac{dx}{ds} &amp;= - 0.7 \cdot \frac{x \cdot (3- x)}{1 + x}
\end{split} \tag{6.6}
\end{equation}\]</span></p>
<p>The differential equation <span class="math inline">\(\displaystyle \frac{dt}{ds} = 1\)</span> has a solution <span class="math inline">\(s=t\)</span>, so really Equation <a href="coupled-06.html#eq:single-phase">(6.6)</a> is a (slightly more) complicated way to express Equation <a href="coupled-06.html#eq:bacteria-colony-06">(6.5)</a>. Hacky? Perhaps. However re-writing Equation <a href="coupled-06.html#eq:bacteria-colony-06">(6.5)</a> was a quick and handy workaround to re-use code.</p>
<p>This chapter introduced a lot of useful <code>R</code> code to aid in visualization. The good news is that we will explore additional analyses of systems of differential equations starting with Chapter <a href="linearsystems-15.html#linearsystems-15">15</a> - there is so much more to learn. Onward!</p>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Exercises<a href="coupled-06.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:phase-eq" class="exercise"><strong>Exercise 6.1  </strong></span>Determine equilibrium solutions for Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a>.</p>
</div>
<div class="exercise">
<p><span id="exr:phase-eq-num" class="exercise"><strong>Exercise 6.2  </strong></span>Generate a phase plane for Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a>, but set the option <code>eq_soln = TRUE</code>. Did <code>phaseplane</code> detect the equilibrium solution you found in Exercise <a href="coupled-06.html#exr:phase-eq">6.1</a>? If not, repeat the phase plane, but set <code>x_window = c(-0.1,0.1)</code> and <code>y_window = c(-0.1,0.1)</code> and repeat.</p>
</div>
<div class="exercise">
<p><span id="exr:wacky-phase" class="exercise"><strong>Exercise 6.3  </strong></span>Generate a phase plane for Equation <a href="coupled-06.html#eq:phase-example">(6.4)</a>, but this time set <code>x_var = y</code> and <code>y_var = x</code> (swap which variable is which). Notice that the incorrect phase plane is produced. What is the corresponding differential equation that is visualized by this phase plane?</p>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-80" class="exercise"><strong>Exercise 6.4  </strong></span>This problem considers the following system of differential equations:
<span class="math display">\[\begin{equation}
\begin{split}
\frac{dx}{dt} &amp;= y \\
\frac{dy}{dt} &amp;= -x
\end{split}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Determine the equations of the nullclines and equilibrium solution of this system of differential equations.</li>
<li>Modify the function <code>phaseplane</code> to generate a phase plane of this system.</li>
<li>For each point along a nullcline, determine the resulting motion (up-down or left-right).</li>
<li>Based on the work you generated, determine if the equilibrium solution is <em>stable</em>, <em>unstable</em>, or <em>inconclusive</em>.</li>
<li>Verify that the functions <span class="math inline">\(x(t) = \sin(t)\)</span> and <span class="math inline">\(y=\cos(t)\)</span> is one solution to this system of differential equations.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-81" class="exercise"><strong>Exercise 6.5  </strong></span>Consider the following system of differential equations:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dx}{dt} &amp;= y \\
\frac{dy}{dt} &amp;= 3x^{2}-1
\end{split}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Determine the equations of the nullclines and equilibrium solutions for this system of differential equations.</li>
<li>For each point along a nullcline, determine the resulting motion (up-down or left-right).</li>
<li>Modify the function <code>phaseplane</code> to generate a phase plane of this system. Adjust the windows for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> to be between -1 and 1.</li>
<li>Make a hypothesis to classify if the equilibrium point is <em>stable</em> or <em>unstable</em>.</li>
</ol>
</div>
<!-- %Thornley pg 80 -->
<div class="exercise">
<p><span id="exr:unnamed-chunk-82" class="exercise"><strong>Exercise 6.6  </strong></span>(Inspired by <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>) A plant grows proportional to its current length <span class="math inline">\(L\)</span>. Assume this proportionality constant is <span class="math inline">\(\mu\)</span>, whose rate also decreases proportional to its current value. The system of equations that models this plant growth is the following:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dL}{dt} &amp;= \mu L \\
\frac{d\mu}{dt}  &amp;= -0.1 \mu \\
\end{split}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Explain why <span class="math inline">\(L=0\)</span> and <span class="math inline">\(\mu=0\)</span> is an equilibrium solution to this differential equation.</li>
<li>Modify the function <code>phaseplane</code> to generate a phase plane of this system. Use the window <span class="math inline">\(-0.1 \leq L \leq 0.1\)</span> and <span class="math inline">\(-0.1 \leq \mu \leq 0.1\)</span>. (For this problem negative values of <span class="math inline">\(L\)</span> and <span class="math inline">\(\mu\)</span> are not sensible, but it aids in visualizing the equilibrium solution.)</li>
<li>Is the origin a stable equilibrium solution?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-83" class="exercise"><strong>Exercise 6.7  </strong></span>(Inspired by <span class="citation">Logan and Wolesensky (<a href="#ref-logan_mathematical_2009">2009</a>)</span>) Red blood cells are formed from stem cells in the bone marrow. The red blood cell density <span class="math inline">\(r\)</span> satisfies an equation of the form</p>
<p><span class="math display">\[\begin{equation}
\frac{dr}{dt} = \frac{0.2r}{1+r^{2}} -  0.1 r
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>What are the equilibrium solutions for this differential equation?</li>
<li>Modify the function <code>phaseplane</code> to generate a phase line for this differential equation for <span class="math inline">\(0 \leq t \leq 5\)</span> and <span class="math inline">\(0 \leq r \leq 5\)</span>.</li>
<li>Based on the phase line, are the equilibrium solutions stable or unstable?</li>
</ol>
</div>
<p><!-- Van den Berg page 19 -->
::: {.exercise #unnamed-chunk-84}
(Inspired by <span class="citation">Hugo van den Berg (<a href="#ref-berg_mathematical_2011">2011</a>)</span>) Organisms that live in a saline environment biochemically maintain the amount of salt in their blood stream. An equation that represents the level of <span class="math inline">\(S\)</span> in the blood is the following:</p>
<p><span class="math display">\[ \frac{dS}{dt} = 1 + 0.3 \cdot (3 - S) \]</span></p>
<ol style="list-style-type: lower-alpha">
<li>What are the equilibrium solutions for this differential equation?</li>
<li>Modify the function <code>phaseplane</code> to generate a phase line for this differential equation for <span class="math inline">\(0 \leq t \leq 10\)</span> and <span class="math inline">\(0 \leq S \leq 10\)</span>.</li>
<li>Based on the phase line, are the equilibrium solutions stable or unstable?</li>
</ol>
<p>:::</p>
<div class="exercise">
<p><span id="exr:reparam" class="exercise"><strong>Exercise 6.8  </strong></span>Consider the differential equation <span class="math inline">\(\displaystyle \frac{dx}{dt} = -3x\)</span>. Here you will examine creating a two-dimensional system of equations by re-parameterizing <span class="math inline">\(s=t\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Define the variable <span class="math inline">\(t = s\)</span>. For this case, what is <span class="math inline">\(\displaystyle \frac{dt}{ds}\)</span>?</li>
<li>When <span class="math inline">\(x = f (t (s))\)</span> (<span class="math inline">\(x\)</span> is a composition between <span class="math inline">\(t\)</span> and <span class="math inline">\(s\)</span>), one way to express the chain rule is <span class="math inline">\(\displaystyle \frac{dx}{ds} = \frac{dx}{dt} \cdot \frac{dt}{ds}\)</span>. Use this fact to explain why <span class="math inline">\(\displaystyle \frac{dx}{ds} = -3x\)</span>.</li>
<li>Finally use your previous work to determine the system of equations for <span class="math inline">\(\displaystyle \frac{dx}{ds}\)</span> and <span class="math inline">\(\displaystyle \frac{dt}{ds}\)</span>.</li>
</ol>
</div>
<!-- From van den Berg, pg 59, exercise 3.13 -->
<div class="exercise">
<p><span id="exr:unnamed-chunk-85" class="exercise"><strong>Exercise 6.9  </strong></span>(Inspired by <span class="citation">Hugo van den Berg (<a href="#ref-berg_mathematical_2011">2011</a>)</span>) The core body temperature (<span class="math inline">\(T\)</span>) of a mammal is coupled to the heat production (scaled by heat capacity <span class="math inline">\(Q\)</span>) with the following system of differential equations:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dT}{dt} &amp;= Q + 0.5 \cdot (20-T) \\
\frac{dQ}{dt} &amp;= 0.1 \cdot (38-T)
\end{split}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Determine the equations of the nullclines and equilibrium solution of this system of differential equations.</li>
<li>For each point along a nullcline, determine the resulting motion (up-down or left-right). You may assume that both <span class="math inline">\(T&gt;0\)</span> and <span class="math inline">\(Q&gt;0\)</span>.</li>
<li>Make a hypothesis to classify if the equilibrium solution is <em>stable</em> or <em>unstable</em>.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-86" class="exercise"><strong>Exercise 6.10  </strong></span>Consider the following system of differential equations for the lynx-hare model (Equation <a href="modeling-rates-03.html#eq:lynx-hare-combined">(3.7)</a> from Chapter <a href="modeling-rates-03.html#modeling-rates-03">3</a>):</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dH}{dt} &amp;= r H - b HL \\
\frac{dL}{dt} &amp;=ebHL -dL
\end{split}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Determine the equilibrium solutions for this system of differential equations.</li>
<li>Determine equations for the nullclines, expressed as <span class="math inline">\(L\)</span> as a function of <span class="math inline">\(H\)</span>. There should be two nullclines for each rate.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-87" class="exercise"><strong>Exercise 6.11  </strong></span>(Inspired by <span class="citation">Hugo van den Berg (<a href="#ref-berg_mathematical_2011">2011</a>)</span>) A chemostat is a tank used to study microbes and ecology, where microbes grow under controlled conditions. Think of this like a large tank with nutrient-rich water that is continuously cycled. For example, differential equations that describe the microbial biomass <span class="math inline">\(W\)</span> and the nutrient concentration <span class="math inline">\(C\)</span> (in the culture) are the following:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dW}{dt} &amp;= \mu W - F \frac{W}{V} \\
\frac{dC}{dt} &amp;= D \cdot (C_{R}-C) - S \mu \frac{W}{V},
\end{split}
\end{equation}\]</span></p>
<p>where we have the following parameters: <span class="math inline">\(\mu\)</span> is the per capita reproduction rate, <span class="math inline">\(F\)</span> is the flow rate, <span class="math inline">\(V\)</span> is the volume of the culture solution, <span class="math inline">\(D\)</span> is the dilution rate, <span class="math inline">\(C_{R}\)</span> is the concentration of nutrients entering the culture, and <span class="math inline">\(S\)</span> is a stoichiometric conversion of nutrients to biomass.</p>
<ol style="list-style-type: lower-alpha">
<li>Write the equations of the nullclines for this differential equation.</li>
<li>Determine the equilibrium solutions for this system of differential equations.</li>
<li>Generate a phase plane for this differential equation with the values <span class="math inline">\(\mu=1\)</span>, <span class="math inline">\(D=1\)</span>, <span class="math inline">\(C_{R}=2\)</span>, <span class="math inline">\(S=1\)</span>, and <span class="math inline">\(V=1\)</span>.</li>
<li>Classify the stability of the equilbrium solutions.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-88" class="exercise"><strong>Exercise 6.12  </strong></span>A classical paper <em>Experimental Studies on the Struggle for Existence: I. Mixed Population of Two Species of Yeast</em> by <span class="citation">Gause (<a href="#ref-gause_experimental_1932">1932</a>)</span> examined two different species of yeast growing in competition with each other. The differential equations given for two species in competition are:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\frac{dy_{1}}{dt} &amp;= -b_{1} y_{1} \frac{(K_{1}-(y_{1}+\alpha y_{2}) )}{K_{1}} \\
\frac{dy_{2}}{dt} &amp;= -b_{2} y_{2} \frac{(K_{2}-(y_{2}+\beta y_{1}) )}{K_{2}}, \\
\end{split}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(y_{1}\)</span> and <span class="math inline">\(y_{2}\)</span> are the two species of yeast with the parameters <span class="math inline">\(b_{1}, \; b_{2}, \; K_{1}, \; K_{2}, \; \alpha, \; \beta\)</span> describing the characteristics of the yeast species.</p>
<ol style="list-style-type: lower-alpha">
<li>Determine the equilibrium solutions for this differential equation. Express your answer in terms of the parameters <span class="math inline">\(b_{1}, \; b_{2}, \; K_{1}, \; K_{2}, \; \alpha, \; \beta\)</span>.</li>
<li><span class="citation">Gause (<a href="#ref-gause_experimental_1932">1932</a>)</span> computed the following values of the parameters: <span class="math inline">\(b_{1}=0.21827, \; b_{2}=0.06069, \; K_{1}=13.0, \; K_{2}=5.8, \; \alpha=3.15, \; \beta=0.439\)</span>. Using these values and your results from part a, what would be the predicted values for the equilibrium solutions? Is there anything odd about the values for these equilibrium solutions?</li>
<li>Use the function <code>rk4</code> to solve this system of differential equations numerically and plot your solutions. Use initial conditions of <span class="math inline">\(y_{1}(0)=.375\)</span> and <span class="math inline">\(y_{2}(0)=.291\)</span>, with <span class="math inline">\(\Delta t = 1\)</span> and <span class="math inline">\(N=600\)</span>.</li>
</ol>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-berg_mathematical_2011" class="csl-entry">
Berg, Hugo van den. 2011. <em>Mathematical <span>Models</span> of <span>Biological Systems</span></em>. <span>Oxford, New York</span>: <span>Oxford University Press</span>.
</div>
<div id="ref-gause_experimental_1932" class="csl-entry">
Gause, G. F. 1932. <span>“Experimental <span>Studies</span> on the <span>Struggle</span> for <span>Existence</span>: <span>I</span>. <span>Mixed Population</span> of <span>Two Species</span> of <span>Yeast</span>.”</span> <em>Journal of Experimental Biology</em> 9 (4): 389–402.
</div>
<div id="ref-logan_mathematical_2009" class="csl-entry">
Logan, J. David, and William Wolesensky. 2009. <em>Mathematical <span>Methods</span> in <span>Biology</span></em>. 1st ed. <span>Hoboken, N.J</span>: <span>W</span>iley.
</div>
<div id="ref-thornley_plant_1990" class="csl-entry">
Thornley, John H. M., and Ian R. Johnson. 1990. <em>Plant and <span>Crop Modelling</span>: <span>A Mathematical Approach</span> to <span>Plant</span> and <span>Crop Physiology</span></em>. Caldwell, New Jersey: <span>Blackburn Press</span>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="20">
<li id="fn20"><p>For the general system (Equation <a href="coupled-06.html#eq:flu-quarantine-small-06">(6.2)</a>), the equilibrium solution would that be <span class="math inline">\(\displaystyle S=\frac{\beta}{k}\)</span> and <span class="math inline">\(I=0\)</span>.<a href="coupled-06.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="phase-05.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exact-solns-07.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/06-coupledSystems.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/06-coupledSystems.Rmd",
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
