<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Meet the Fokker-Planck Equation | Exploring modeling with data and differential equations using R</title>
  <meta name="description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Meet the Fokker-Planck Equation | Exploring modeling with data and differential equations using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook used for MAT 369 at Augsburg University." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Meet the Fokker-Planck Equation | Exploring modeling with data and differential equations using R" />
  
  <meta name="twitter:description" content="A textbook used for MAT 369 at Augsburg University." />
  

<meta name="author" content="John M. Zobitz" />


<meta name="date" content="2021-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="solvingSDEs-27.html"/>
<link rel="next" href="exercises.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Modeling with Data and Differential Equations in R</strong><br>by John Zobitz</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome Creating this from Bookdown to Github</a></li>
<li class="chapter" data-level="2" data-path="solvingSDEs-27.html"><a href="solvingSDEs-27.html"><i class="fa fa-check"></i><b>2</b> Solving Stochastic Differential Equations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="meet-the-fokker-planck-equation.html"><a href="meet-the-fokker-planck-equation.html"><i class="fa fa-check"></i><b>2.1</b> Meet the Fokker-Planck Equation</a></li>
<li class="chapter" data-level="2.2" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.2</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open access book-in-progress</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring modeling with data and differential equations using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="meet-the-fokker-planck-equation" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Meet the Fokker-Planck Equation</h2>
<p>Let’s start with a general way to express a stochastic differential equation:</p>
<p><span class="math display">\[\begin{equation}
dx = a(x,t) \; dt + b(x,t) \; dW(t)
\end{equation}\]</span></p>
<p>The “solution” to this SDE will be a probability density function <span class="math inline">\(f(x,t)\)</span>.
Our goal is to have a function that describes the evolution of <span class="math inline">\(f(x,t)\)</span> in both time and space. Based on our work with birth-death processes, the probability density function <span class="math inline">\(f(x,t)\)</span> should have the following properties:</p>
<ul>
<li><span class="math inline">\(E[f(x,t)]\)</span> is the deterministic solution to <span class="math inline">\(\displaystyle \frac{dx}{dt} = a(x,t)\)</span>.</li>
<li>Var<span class="math inline">\([f(x,t)]\)</span> is proportional to <span class="math inline">\(b(x,t)\)</span>.</li>
</ul>
<p>We determine the probability density function through solution of the following differential equation, which is called the <strong>Fokker-Planck Equation</strong>:</p>
<p><span class="math display">\[\begin{equation}
\frac{\partial f}{\partial t} = - \frac{\partial}{\partial x} \left(f(x,t) \cdot a(x,t) \right) + \frac{1}{2}\frac{\partial^{2} }{\partial x^{2}} \left(\; f(x,t) \cdot (b(x,t))^{2}  \;\right)
\end{equation}\]</span></p>
<p>We can write this equation in shorthand, dropping the dependence of <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span> for <span class="math inline">\(f(x,t)\)</span>, <span class="math inline">\(a(x,t)\)</span> and <span class="math inline">\(b(x,t)\)</span>: <span class="math inline">\(\displaystyle f_{t} = - (f \cdot a)_{x} + \frac{1}{2} (f \cdot b^{2})_{xx}\)</span>.</p>

<div class="example">
<span id="exm:unnamed-chunk-3" class="example"><strong>Example 2.1  </strong></span>Consider the SDE <span class="math inline">\(dx = dW(t)\)</span> and apply the Fokker-Planck equation to characterize the solution <span class="math inline">\(f(x,t)\)</span>.
</div>

<div class="remark">
<p> <span class="remark"><em>Remark. </em></span> In this case <span class="math inline">\(a(x,t)=0\)</span> and <span class="math inline">\(b(x,t)=1\)</span>, so the Fokker-Planck Equation is:</p>
<p><span class="math display">\[\begin{equation*}
f_{t} = \frac{\sigma^{2}}{2} f_{xx}.
\end{equation*}\]</span></p>
<p>This equation should look familiar - it is the partial differential equation for diffusion!<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The solution to the Fokker-Planck equation is <span class="math inline">\(\displaystyle f(x,t) = \frac{1}{\sqrt{2 \pi \sigma^{2} t}} e^{-x^{2}/(2 \sigma^{2} t)}\)</span>.</p>
</div>
<p>I didn’t mention the initial condition to the SDE - in this case it is <span class="math inline">\(f(x,0)=\delta(x)\)</span>. The function <span class="math inline">\(\delta(x)\)</span> is called the <a href="https://en.wikipedia.org/wiki/Dirac_delta_function">Dirac delta Function</a>. This function is a special type of probability density function, which you may study in a courses such as Functional Analysis (or Analysis). We can plot the evolution of this solution in Figure <a href="meet-the-fokker-planck-equation.html#fig:dirac-delta">2.1</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:dirac-delta"></span>
<img src="series_files/figure-html/dirac-delta-1.png" alt="The solution to SDE $dx = dW(t)$." width="384" />
<p class="caption">
Figure 2.1: The solution to SDE <span class="math inline">\(dx = dW(t)\)</span>.
</p>
</div>
<p> </p>
<p>Now that we have a handle on the SDE <span class="math inline">\(dx = dW(t)\)</span>, let’s extend this next example a little more.</p>
<div id="another-fokker-planck-equation" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Another Fokker-Planck Equation</h3>
<p>Consider the SDE <span class="math inline">\(dx = r \; dt + \sigma \; dW(t)\)</span>, where r and <span class="math inline">\(\sigma\)</span> are constants. As a first step, let’s take a look at the deterministic equation: $ dx = r ; dt$. This is the differential equation <span class="math inline">\(\displaystyle \frac{dx}{dt} = r\)</span>, which has a linear function <span class="math inline">\(x(t) = rt + x_{0}\)</span> as its solution.</p>
<p>We will apply the Fokker-Planck equation to characterize the solution <span class="math inline">\(f(x,t)\)</span>. In this case, the Fokker-Planck equation is <span class="math inline">\(\displaystyle f_{t} = -r f_{x}+ \frac{\sigma^{2}}{2} f_{xx}\)</span>. The partial differential equation is an example of a <em>diffusion-advection equation</em>. Amazingly this equation can be reduced to a diffusion equation through a change of variables and application of the multivariable change of variables. Let’s get to work to figure this out.</p>
<p>First, let <span class="math inline">\(z=x-rt\)</span>. This change of variables may seem odd, but our goal here is to write <span class="math inline">\(f(x,t)=f(z)\)</span> and to develop expressions for <span class="math inline">\(f_{t}\)</span> <span class="math inline">\(f_{x}\)</span>, and <span class="math inline">\(f_{xx}\)</span> with this change of variables. But in order to do that, we will need to apply the <em>multivariate chain rule</em> (see Figure <a href="meet-the-fokker-planck-equation.html#fig:chain-rule">2.2</a>).</p>
<div class="figure"><span id="fig:chain-rule"></span>
<img src="series_files/figure-html/chain-rule-1.png" alt="Multivariable chain rule" width="672" />
<p class="caption">
Figure 2.2: Multivariable chain rule
</p>
</div>
<p>By the multivariable chain rule we can develop expressions for <span class="math inline">\(f_{t}\)</span> and <span class="math inline">\(f_{x}\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial f}{\partial t} &amp; = \frac{\partial f}{\partial \tau} \cdot \frac{ \partial \tau}{\partial t} + \frac{\partial f}{\partial z} \cdot \frac{ \partial z}{\partial t}  \\
\frac{\partial f}{\partial x} &amp; = \frac{\partial f}{\partial z} \cdot \frac{ \partial z}{\partial x}
\end{align*}\]</span></p>
<p>Now let’s consider the partial derivatives <span class="math inline">\(\displaystyle \frac{ \partial \tau}{\partial t}\)</span>, <span class="math inline">\(\displaystyle \frac{ \partial z}{\partial t}\)</span>, and <span class="math inline">\(\displaystyle \frac{ \partial z}{\partial x}\)</span> We will define <span class="math inline">\(z=x-r\tau\)</span>. By direct differentiation <span class="math inline">\(z_{\tau} = -r\)</span>, <span class="math inline">\(z_{x} = 1\)</span>. Also since <span class="math inline">\(\tau=t\)</span>, <span class="math inline">\(\tau_{t}=1\)</span>. These expressions help: since <span class="math inline">\(f_{z}=f_{x}\)</span>, then <span class="math inline">\(f_{zz} = f_{xx}\)</span>. With these substitutions, we can now re-write <span class="math inline">\(f_{t}\)</span> and <span class="math inline">\(f_{xx}\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial f}{\partial t} &amp; = \frac{\partial f}{\partial \tau} \cdot \frac{ \partial \tau}{\partial t} + \frac{\partial f}{\partial z} \cdot \frac{ \partial z}{\partial t}  = \frac{\partial f}{\partial \tau} -r \frac{\partial f}{\partial z} \\
\frac{\partial f}{\partial xx} &amp; = \frac{\partial^{2} f}{\partial z^{2}} 
\end{align*}\]</span></p>
<p>So if we re-write our original Fokker-Planck equation with the variables <span class="math inline">\(z\)</span> and <span class="math inline">\(\tau\)</span> we have:</p>
<p><span class="math display">\[\begin{align*}
f_{t} &amp;=-r f_{x}+ \frac{\sigma^{2}}{2} f_{xx} \\
f_{\tau} - r f_{z} &amp;= -r f_{z} + \frac{\sigma^{2}}{2} f_{zz} \\
f_{\tau} &amp;=  \frac{\sigma^{2}}{2} f_{zz}
\end{align*}\]</span></p>
<p>Ok: I’ll admit that doing change of variables may seem like it doesn’t help the situation. But guess what: with this change of variables our Fokker-Planck equation becomes a diffusion equation in the variables <span class="math inline">\(z\)</span> and <span class="math inline">\(\tau\)</span>! So if we can write down the solution with the variables <span class="math inline">\(z\)</span> and <span class="math inline">\(\tau\)</span>, we can write the solution <span class="math inline">\(f(x,t)\)</span>! Here how we do this: <span class="math inline">\(\displaystyle f(z, \tau) = \frac{1}{\sqrt{2 \pi \sigma^{2} \tau}} e^{-z^{2}/(2 \sigma^{2} \tau)}\)</span>, and then transform back into the original variables <span class="math inline">\(x\)</span> and <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[\begin{equation}
f(x, t) = \frac{1}{\sqrt{2 \pi \sigma^{2} t}} e^{-(x-rt)^{2}/(2 \sigma^{2} t)}
\end{equation}\]</span></p>
<p>Now that we have an equation, next let’s visualize the solution. Let’s take a look at some representative plots:</p>
<div class="figure" style="text-align: center"><span id="fig:diff-advec"></span>
<img src="series_files/figure-html/diff-advec-1.png" alt="Representative plots for the solution to the SDE $dx = r \; dt + \sigma \; dW(t)$." width="384" />
<p class="caption">
Figure 2.3: Representative plots for the solution to the SDE <span class="math inline">\(dx = r \; dt + \sigma \; dW(t)\)</span>.
</p>
</div>
<p>Based on what we know of this distribution is that it should look like a normal distribution with mean <span class="math inline">\(\mu = rt\)</span> and variance <span class="math inline">\(\sigma^{2} t\)</span>. What the mean and variance tells us that the mean is shifting and growing more diffuse as time increases. Remember that our solution to the deterministic equation was linear, and the mean of our distribution grows linearly as well!</p>
<p>Also notice in Figure <a href="meet-the-fokker-planck-equation.html#fig:diff-advec">2.3</a> as <span class="math inline">\(t\)</span> increases the solution shifts (‘’advects’’) to the right. The differential equation is an example of a <em>diffusion-advection</em> equation, or a solution that drifts as time increases.</p>
<p>The examples we study here are just a few examples of how to build a deeper understanding of stochastic processes and differential equations. There is a lot of power in understanding the theoretical distribution for some test cases. Stochastic differential equations is a fascinating field of study with a lot of interesting mathematics - I hope what you learned here will make you want to study it further!</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>To remind you, the solution to <span class="math inline">\(p_{t} = D p_{xx}\)</span> is <span class="math inline">\(\displaystyle p(x,t) = \frac{1}{\sqrt{4 \pi Dt} } e^{-x^{2}/(4 D t)}\)</span>. So in this case <span class="math inline">\(D = \sigma^{2}/2\)</span>.<a href="meet-the-fokker-planck-equation.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="solvingSDEs-27.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/27-solvingSDEs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://jmzobitz.github.io/ModelingWithR/27-solvingSDEs.Rmd",
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
